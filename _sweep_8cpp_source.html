<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>covid-sim: src/Sweep.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">covid-sim
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Sweep.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_sweep_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_calc_inf_susc_8h.html">CalcInfSusc.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_dist_8h.html">Dist.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_error_8h.html">Error.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_inf_stat_8h.html">InfStat.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_kernels_8h.html">Kernels.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rand_8h.html">Rand.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_model_8h.html">Model.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_model_macros_8h.html">ModelMacros.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_param_8h.html">Param.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sweep_8h.html">Sweep.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_update_8h.html">Update.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="_sweep_8h.html#aaa1aa4d11b32251ba9cd8bffdd71a333">   19</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_sweep_8cpp.html#a461f3a48ec546a649b02b46dfb63ce1e">TravelReturnSweep</a>(<span class="keywordtype">double</span> t)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">int</span> l, nr, ner;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// Convince static analysers that values are set correctly:</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac51894eda72b949bd3223e345d87f7dc">DoAirports</a> &amp;&amp; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a> &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>)) <a class="code" href="_error_8h.html#ad74df05c36c5f7e949c2c75b19712260">ERR_CRITICAL</a>(<span class="stringliteral">&quot;DoAirports || HotelPlaceType not set\n&quot;</span>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (floor(1 + t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">TimeStep</a>) != floor(1 + t))</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        nr = ner = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordtype">int</span> floorOfTime = (int)floor(t);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        l = 1 + floorOfTime % <a class="code" href="_constants_8h.html#afad8323327de65301885f6cf79fe8768">MAX_TRAVEL_TIME</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        FILE* stderr_shared = stderr;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#pragma omp parallel for reduction(+:nr, ner) schedule(static, 1) default(none) \</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">            shared(P, Places, Hosts, l, stderr_shared)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = tn; j &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#acd900e8640668798a3c99196f664f27d">Nplace</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>]; j += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                <span class="keywordtype">int</span> n = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][j].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = n - 1; k &gt;= 0; k--)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                    <span class="keywordtype">int</span> i = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][j].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[k];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i].Travelling == l)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                    {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                        n--;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                        <span class="comment">/*                      if((n&lt;0)||(Places[P.HotelPlaceType][j].members[n]&lt;0)||(Places[P.HotelPlaceType][j].members[n]&gt;=P.PopSize))</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">                                                    {fprintf(stderr,&quot;### %i %i %i %i\n&quot;,j,k,n,Places[P.HotelPlaceType][j].members[n]);ner++;}</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">                                                else if((k&lt;0)||(k&gt;n))</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">                                                    {fprintf(stderr,&quot;@ %i %i %i %i\n&quot;,j,k,n,Places[P.HotelPlaceType][j].members[n]);ner++;}</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">                                                else</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">                        */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                        <span class="keywordflow">if</span> (k != n)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                        {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][j].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[k] = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][j].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[n];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                        nr++;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i].PlaceLinks[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] != j)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                        {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                            ner++; fprintf(stderr_shared, <span class="stringliteral">&quot;(%i %i) &quot;</span>, j, <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i].PlaceLinks[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -1;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i].<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a> = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][j].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a> = n;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot; d=%i e=%i&gt;&quot;</span>, nr, ner);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="_sweep_8h.html#ab26d0cb0b3e190972167c56407a9a0a5">   71</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_sweep_8cpp.html#ae637ea5a64035961eaf05bf25e845fa8">TravelDepartSweep</a>(<span class="keywordtype">double</span> t)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span> d, mps, nld, nad, nsk, bm;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">double</span> nl;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Convince static analysers that values are set correctly:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac51894eda72b949bd3223e345d87f7dc">DoAirports</a> &amp;&amp; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a> &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>)) <a class="code" href="_error_8h.html#ad74df05c36c5f7e949c2c75b19712260">ERR_CRITICAL</a>(<span class="stringliteral">&quot;DoAirports || HotelPlaceType not set\n&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (floor(1 + t - <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">TimeStep</a>) != floor(1 + t))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        bm = ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac5bfacdf8312c5f59646b1cbfea2bac7">DoBlanketMoveRestr</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a>) &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7328b90f5f8e56ad824ced77b6d62303">MoveRestrDuration</a>));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        mps = 2 * ((int)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a63656dae85d858248d9c61e74db215ad">PlaceTypeMeanSize</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>]) - <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a> - 1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">int</span> floorOfTime = (int)floor(t);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        d = floorOfTime % <a class="code" href="_constants_8h.html#afad8323327de65301885f6cf79fe8768">MAX_TRAVEL_TIME</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        nad = nld = nsk = 0;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#pragma omp parallel for reduction(+:nad,nsk) schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">            shared(t, P, Airports, Mcells, Hosts, Places, bm, mps, d)</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = tn; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abcd949752816ce736253fe37cecd5190">Nairports</a>; i += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].total_traffic &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#a5ca6fd8bf55eafbd2e07c7abffe7c68d">num_mcell</a> &gt; 0))</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <span class="keywordtype">double</span> s = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#a8b6418011a9243e1302fa862cc235ef7">total_traffic</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">if</span> ((t &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abf9206e8d14c385e5ae11d93ce2a9902">AirportCloseTimeStart</a>) &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abf9206e8d14c385e5ae11d93ce2a9902">AirportCloseTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a57be5e7bbc4e64275831d33a29b6d383">AirportCloseTimeStartBase</a>))</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                        s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8b481f3bb34ae62a4c6540ebde7a1bdb">AirportCloseEffectiveness</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    <span class="keywordtype">int</span> n = (s &gt; 0) ? ((<span class="keywordtype">int</span>)<a class="code" href="_rand_8cpp.html#a50a53c3fed7a411386c5424c72eeb32a">ignpoi_mt</a>((<span class="keywordtype">double</span>)s, tn)) : 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="keywordtype">int</span> f3 = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <span class="keywordflow">while</span> (j &lt; n)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                        <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#a8e9e7e916faec5f0ef1911f86c58e3bf">Inv_DestMcells</a>[(int)floor(s * 1024)];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <span class="keywordflow">while</span> (<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].DestMcells[l].prob &lt; s) l++;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                        l = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#afed0dc22ba28b76b24cef5e26bb5dfed">DestMcells</a>[l].<a class="code" href="struct_index_list.html#af997963b72d978bebf097d856dbbc56a">id</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                        <span class="keywordtype">int</span> k = (int)(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) * ((double)<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[l].n));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <span class="keywordtype">int</span> i2 = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[l].<a class="code" href="struct_microcell.html#a1ba5ca77bb4bbb4b2dacd794e217b1d4">members</a>[k];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        <span class="keywordflow">if</span> ((abs(<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].inf) &lt; <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389af2db792c1a49637629bca88c8e14dae6">InfStat_InfectiousAsymptomaticNotCase</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].inf != <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389af18935e7be228c4f9223257c1408b6ec">InfStat_Case</a>))</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                        {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                            <span class="keywordtype">int</span> d2 = <a class="code" href="_model_macros_8h.html#aa5a6525c77db4abd9464ac6a40adaf52">HOST_AGE_GROUP</a>(i2);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afefa058b931e136b92b407bca7e31494">RelativeTravelRate</a>[d2] == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afefa058b931e136b92b407bca7e31494">RelativeTravelRate</a>[d2]))</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                            {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                <span class="keywordtype">int</span> f2 = 1;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].PlaceLinks[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] == -1)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                    {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -2;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                        f2 = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                <span class="keywordflow">if</span> (!f2)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                    s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                    l = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#aaa63e0e69a2a075fbd380ac1a3c19baf">Inv_prop_traffic</a>[(int)floor(s * 128)];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                    <span class="keywordflow">while</span> (<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].prop_traffic[l] &lt; s) l++;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                    k = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].<a class="code" href="struct_airport.html#ad4293e2695d54d18d345a17a50fe57b4">conn_airports</a>[l];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                    <span class="keywordflow">if</span> (bm)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                    {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].loc_x, <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[i].loc_y, <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[k].loc_x, <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[k].loc_y) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                        {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                            <span class="keywordflow">if</span> (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                            {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                f2 = 1;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                nsk++;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                j++;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                            }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                    <span class="keywordflow">if</span> (!f2)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                        <span class="keywordtype">int</span> f = 1;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                            s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                            <span class="keywordtype">int</span> m = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[k].<a class="code" href="struct_airport.html#ab370f3801948fc7e4f69598c5639761a">Inv_DestPlaces</a>[(int)floor(s * 1024)];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                            <span class="keywordflow">while</span> (<a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[k].DestPlaces[m].prob &lt; s) m++;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                            l = <a class="code" href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a>[k].<a class="code" href="struct_airport.html#a90a7181b70fc503ee85200940c407395">DestPlaces</a>[m].<a class="code" href="struct_index_list.html#af997963b72d978bebf097d856dbbc56a">id</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                            <span class="keywordtype">int</span> hp;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                            {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                <span class="keywordflow">if</span> ((hp = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][l].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>) &lt; mps)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                                    f = 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][l].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>++;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                            <span class="keywordflow">if</span> (!f)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                            {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                f3 = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][l].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[hp] = i2;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                                d2 = (d + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aacb32b0865c35da2adedfcdb0a34896f">InvJourneyDurationDistrib</a>[(int)(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) * 1024.0)]) % <a class="code" href="_constants_8h.html#afad8323327de65301885f6cf79fe8768">MAX_TRAVEL_TIME</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = l;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a> = 1 + d2;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                nad++;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                j++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                            }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                            f2++;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                        } <span class="keywordflow">while</span> ((f) &amp;&amp; (f2 &lt; 300));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                        <span class="keywordflow">if</span> (f)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -1;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                            <span class="keywordflow">if</span> (++f3 &gt; 100)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                            {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                                j++; nsk++;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                            }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                            j++;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;&lt;ar=%i as=%i&quot;</span>, nad, nsk);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        nl = ((double)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a63656dae85d858248d9c61e74db215ad">PlaceTypeMeanSize</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>]) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02d421d75cfdd99e74d5f63704c742de">HotelPropLocal</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8de0393ac46908ec0634ace1e7827d13">MeanLocalJourneyTime</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        nsk = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#pragma omp parallel for reduction(+:nld,nsk) schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">            shared(P, Places, Cells, CellLookup, Hosts, Households, nl, bm, mps, d)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = tn; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#acd900e8640668798a3c99196f664f27d">Nplace</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>]; i += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordtype">int</span> c = ((int)(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a7a78485a87e1516d6b86e0f4fae2131a">loc_x</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a24a95128a168e4265260353d5d636456">cwidth</a>)) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aaec2514a789cbc9b2cc9a38232b0a7dc">nch</a> + ((<span class="keywordtype">int</span>)(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a3a79f4426bdacf4a6aef74bca912ca02">loc_y</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a9a0d052e2d5762a33b1daf84095aa85d">cheight</a>));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordtype">int</span> n = (int)<a class="code" href="_rand_8cpp.html#a50a53c3fed7a411386c5424c72eeb32a">ignpoi_mt</a>(nl * <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a>[c].tot_prob, tn);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a> + n &gt; mps)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    nsk += (<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a> + n - mps);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    n = mps - <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordtype">int</span> f;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        f = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        <span class="keywordtype">double</span> s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a>[c].<a class="code" href="struct_cell.html#aee253e4260bedbfbd0a6005fde27d933">InvCDF</a>[(int)floor(s * 1024)];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <span class="keywordflow">while</span> (<a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a>[c].cum_trans[l] &lt; s) l++;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        <a class="code" href="struct_cell.html">Cell</a>* ct = <a class="code" href="_covid_sim_8cpp.html#acf339fc9cfee006b65c7bbac4edc9525">CellLookup</a>[l];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        <span class="keywordtype">int</span> m = (int)(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) * ((double)ct-&gt;<a class="code" href="struct_cell.html#aa24cfa33fce9c27d441610090a5d883c">S0</a>));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <span class="keywordflow">if</span> (m &lt; (ct-&gt;<a class="code" href="struct_cell.html#af684ed0e536a5f35315bbcd100f6e3f2">S</a> + ct-&gt;<a class="code" href="struct_cell.html#ac69ac8699ecb85184a229188fb65ee23">L</a>))</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                            <span class="keywordtype">int</span> i2 = ct-&gt;<a class="code" href="struct_cell.html#a7da9a586f1fbe511adac3224615a1c60">susceptible</a>[m];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                            <span class="keywordtype">int</span> d2 = <a class="code" href="_model_macros_8h.html#aa5a6525c77db4abd9464ac6a40adaf52">HOST_AGE_GROUP</a>(i2);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                            <span class="keywordtype">int</span> f3 = 0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].Travelling == 0) &amp;&amp; ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afefa058b931e136b92b407bca7e31494">RelativeTravelRate</a>[d2] == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afefa058b931e136b92b407bca7e31494">RelativeTravelRate</a>[d2])))</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                            {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                {<span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].PlaceLinks[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] == -1) { <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -2; f3 = 1; }}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                            }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <span class="keywordflow">if</span> (f3)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                            {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                <span class="keywordtype">double</span> s2 = <a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].hh].loc_x, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].hh].loc_y, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a7a78485a87e1516d6b86e0f4fae2131a">loc_x</a>, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a3a79f4426bdacf4a6aef74bca912ca02">loc_y</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                <span class="keywordtype">int</span> f2 = 1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                <span class="keywordflow">if</span> ((bm) &amp;&amp; (s2 &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>))</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                    {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                        nsk++;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                        f2 = 0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                <span class="keywordflow">if</span> (f2)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                    s = <a class="code" href="_kernels_8cpp.html#a4554988cce0ded4c9a7717faf9baa2f0">numKernel</a>(s2) / <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a>[c].<a class="code" href="struct_cell.html#aa5ec9c2b164786826128590d2ed949d6">max_trans</a>[l];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= s)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = -1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                        f = 1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                    {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                        d2 = (d + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac64b9cdf190d1cb94357cd20340aff0a">InvLocalJourneyDurationDistrib</a>[(int)(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) * 1024.0)]) % <a class="code" href="_constants_8h.html#afad8323327de65301885f6cf79fe8768">MAX_TRAVEL_TIME</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                        <span class="keywordtype">int</span> hp = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>++;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>][i].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[hp] = i2;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a> = 1 + d2;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                        nld++;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#pragma omp critical</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i2].<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>] = i;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                            }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                f = 1;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                            nsk++;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    } <span class="keywordflow">while</span> (f);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot; l=%i ls=%i &quot;</span>, nld, nsk);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="_sweep_8h.html#a2e0134520e81978b29a1d565fd44c34a">  271</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_sweep_8cpp.html#a3a714c62adfead7dcf6405954d8dd4da">InfectSweep</a>(<span class="keywordtype">double</span> t, <span class="keywordtype">int</span> run) <span class="comment">//added run number as argument in order to record it in event log</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span> n; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> f, f2, cq <span class="comment">/*cell queue*/</span>, bm, ci <span class="comment">/*person index*/</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">double</span> seasonality, sbeta, hbeta;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">double</span> s; <span class="comment">// household FOI on fellow household member, then place susceptibility, then random number for spatial infections allocation* / ;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">double</span> s2; <span class="comment">// spatial infectiousness, then distance in spatial infections allocation</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">double</span> s3, s3_scaled; <span class="comment">// household, then place infectiousness</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">double</span> s4, s4_scaled; <span class="comment">// place infectiousness (copy of s3 as some code commented out</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">double</span> s5; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">double</span> s6;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">double</span> fp; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> ts;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a915602640091b4b417a2b17edff6b654">DoSeasonality</a>)   seasonality = 1.0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">else</span>                    seasonality = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7f52553884bccc1272ac357fe2c02174">Seasonality</a>[((int)t) % <a class="code" href="_constants_8h.html#ac4180c3877e209bb6f803e32cefeafaf">DAYS_PER_YEAR</a>];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    ts = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * t);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    fp = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">TimeStep</a> / (1 - <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    sbeta = seasonality * fp * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7bf6a161106306e82dcf62ef8a54a33">LocalBeta</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    hbeta = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a3dfd381deb20db5aff1d77dc93b7cd77">DoHouseholds</a>) ? (seasonality * fp * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1fa4ff61a75ed6441f0e46e57feb25d0">HouseholdTrans</a>) : 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    bm = ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac5bfacdf8312c5f59646b1cbfea2bac7">DoBlanketMoveRestr</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a>) &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7328b90f5f8e56ad824ced77b6d62303">MoveRestrDuration</a>));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    FILE* stderr_shared = stderr;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#pragma omp parallel for private(n,f,f2,s,s2,s3,s4,s5,s6,cq,ci,s3_scaled,s4_scaled) schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">        shared(t, P, CellLookup, Hosts, AdUnits, Households, Places, SamplingQueue, Cells, Mcells, StateT, hbeta, sbeta, seasonality, ts, fp, bm, stderr_shared)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = tn; b &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a46a888930a1549e261168759c3651f4c">NCP</a>; b += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>) </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="struct_cell.html">Cell</a>* c = <a class="code" href="_covid_sim_8cpp.html#acf339fc9cfee006b65c7bbac4edc9525">CellLookup</a>[b];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            s5 = 0; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; c-&gt;<a class="code" href="struct_cell.html#a04465e2d15876175ee2204a3de978173">I</a>; j++) </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                ci = c-&gt;<a class="code" href="struct_cell.html#ab0a07dbeae2fe63c8d2ab90ed7ea6f2f">infected</a>[j];</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <a class="code" href="struct_person.html">Person</a>* si = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a> + ci;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="comment">//calculate flag for digital contact tracing here at the beginning for each individual</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordtype">int</span> fct = ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8864023fe5b3773ad0f1abbb73b08e11">DoDigitalContactTracing</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa836f6754e4687ee653f1b6c53346785">DigitalContactTracingPolicyDuration</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].digitalContactTracingUser == 1)); <span class="comment">// &amp;&amp; (ts &lt;= (Hosts[ci].detected_time + P.usCaseIsolationDelay)));</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">if</span> (hbeta &gt; 0)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#af81508b2a7848a3f6708c0d26cdcca3c">nh</a> &gt; 1) &amp;&amp; (!si-&gt;<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a>))</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#aee2f46f2407ae6d241b0e99814f25a57">FirstPerson</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="keywordtype">int</span> m = l + <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#af81508b2a7848a3f6708c0d26cdcca3c">nh</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        s3 = hbeta * <a class="code" href="_calc_inf_susc_8cpp.html#ae4d700a29a73d804c5cb8cb3721eaad8">CalcHouseInf</a>(ci, ts);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        f = 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i3 = l; (i3 &lt; m) &amp;&amp; (!f); i3++) </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                            f = <a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        <span class="keywordflow">if</span> (f) { s3 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afe76c35ecdf1140bd2d95b47de29b778">PlaceCloseHouseholdRelContact</a>; }<span class="comment">/* NumPCD++;}*/</span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i3 = l; i3 &lt; m; i3++) </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].inf == <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd">InfStat_Susceptible</a>) &amp;&amp; (!<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a>)) </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                s = s3 * <a class="code" href="_calc_inf_susc_8cpp.html#a18851ef497a36857e3e469fc819974e6">CalcHouseSusc</a>(i3, ts, ci, tn);     </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s) </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                    cq = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a2861b921f91d27644c211a8b49d79290">pcell</a> % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].n_queue[cq] &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab434bcdf1f0c57c9b412084b57644069">InfQueuePeakLength</a>)) <span class="comment">//(Hosts[i3].infector==-1)&amp;&amp;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                    {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a>))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {-1, i3, -1};</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                        {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a163b932f9bcb7abe3d15e0961ea22bbe">infector</a> = ci; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                            <span class="keywordtype">short</span> <span class="keywordtype">int</span> infect_type = 1 + <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a> * (1 + si-&gt;<a class="code" href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">infect_type</a> / <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {ci, i3, infect_type};</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                        }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                            }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">DoPlaces</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(ci))</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        <a class="code" href="struct_microcell.html">Microcell</a>* mi = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>; k++) </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                            <span class="keywordtype">int</span> l = si-&gt;<a class="code" href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">PlaceLinks</a>[k];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                            <span class="keywordflow">if</span> (l &gt;= 0)  </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                s3 = fp * seasonality * <a class="code" href="_calc_inf_susc_8cpp.html#ac3b39b1c139909a4c2da802e243a75d0">CalcPlaceInf</a>(ci, k, ts);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                <a class="code" href="struct_microcell.html">Microcell</a>* mp = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#aa4b9554d949b7b64e0f3c138ed01246d">mcell</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                <span class="keywordflow">if</span> (bm)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                    <span class="keywordflow">if</span> ((<a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#ae5b70863f9dee9092d36d8cab6903304">loc_x</a>, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#a5b984c04b3e1f1b19f101a097ace1b43">loc_y</a>,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#a7a78485a87e1516d6b86e0f4fae2131a">loc_x</a>, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#a3a79f4426bdacf4a6aef74bca912ca02">loc_y</a>) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>))</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                        s3 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((mi-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> != mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a>) &amp;&amp; ((mi-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2) || (mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2)))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                    s3 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                <span class="keywordflow">if</span> ((k != <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>) &amp;&amp; (!si-&gt;<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a>))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                    <span class="keywordtype">int</span> i2 = (si-&gt;<a class="code" href="struct_person.html#a8348a80bfb53fa5e6c1c9ce47dbfecba">PlaceGroupLinks</a>[k]);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                    <span class="keywordflow">if</span> (fct)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                        s4 = s3;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                        s4_scaled = s4 *<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4efe0e20456caea4e3640f435d117dc9">ScalingFactorPlaceDigitalContacts</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                        <span class="keywordflow">if</span> (s4 &gt; 1) s4 = 1;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                        <span class="keywordflow">if</span> (s4_scaled &gt; 1) s4_scaled = 1;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                        s4 = s3;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                        <span class="keywordflow">if</span> (s4 &gt; 1) s4 = 1;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                        s4_scaled = s4;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                    <span class="keywordflow">if</span> (s4_scaled &lt; 0)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                    {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                        fprintf(stderr_shared, <span class="stringliteral">&quot;@@@ %lg\n&quot;</span>, s4_scaled);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                        exit(1);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s4_scaled &gt;= 1)    </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                        n = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#ab51ce5972ce98ae2c88686144c0af9d2">group_size</a>[i2];</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                    <span class="keywordflow">else</span>                </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                        n = (int)<a class="code" href="_rand_8cpp.html#a5efb4220d658f7dd6056a98264616d4f">ignbin_mt</a>((<span class="keywordtype">long</span>)<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#ab51ce5972ce98ae2c88686144c0af9d2">group_size</a>[i2], s4_scaled, tn);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                    <span class="keywordflow">if</span> (n &gt; 0) <a class="code" href="_rand_8cpp.html#aa262f1a4a0bf83c91c3614c57fc46521">SampleWithoutReplacement</a>(tn, n, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].group_size[i2]); </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; n; m++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                    {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                        <span class="keywordtype">int</span> i3 = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#a90795f850fc6824ce4d6c7fee6d6d15d">group_start</a>[i2] + <a class="code" href="_rand_8cpp.html#a27488915fe3fa82c70d9166c321fd510">SamplingQueue</a>[tn][m]];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                        s = <a class="code" href="_calc_inf_susc_8cpp.html#abca4d2ea991811c0816ca4ff1884a6bb">CalcPlaceSusc</a>(i3, k, ts, ci, tn);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                        <span class="comment">//these are all place group contacts to be tracked for digital contact tracing - add to StateT queue for contact tracing</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                        <span class="comment">//if infectee is also a user, add them as a contact</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                        <span class="keywordflow">if</span> ((fct) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].digitalContactTracingUser) &amp;&amp; (ci != i3) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3)))</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                        {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                            s6 = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a757b6ff070f6f6e31ad8b9bc0dbb8c0c">ProportionDigitalContactsIsolate</a> * s;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].ncontacts &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a9ff82be8872693076c8ee8ba7f2ed6ac">MaxDigitalContactsToTrace</a>) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt;s6))</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                            {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">ncontacts</a>++; <span class="comment">//add to number of contacts made</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                <span class="keywordtype">int</span> ad = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].ndct_queue[ad] &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[ad].n))</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                    <span class="comment">//find adunit for contact and add both contact and infectious host to lists - storing both so I can set times later.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[ad][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[ad]++] = { i3,ci,ts };</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                                    fprintf(stderr_shared, <span class="stringliteral">&quot;No more space in queue! Thread: %i, AdUnit: %i\n&quot;</span>, tn, ad);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                                }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                            }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                        }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].inf == <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd">InfStat_Susceptible</a>) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3))) </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                        {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                            <a class="code" href="struct_microcell.html">Microcell</a>* mt = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                            <a class="code" href="struct_cell.html">Cell</a>* ct = <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a> + <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a2861b921f91d27644c211a8b49d79290">pcell</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                            <span class="comment">//downscale s if it has been scaled up do to digital contact tracing</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                            s *= <a class="code" href="_calc_inf_susc_8cpp.html#aa8eff74bc82cbd3ccae0701f1cc40cd6">CalcPersonSusc</a>(i3, ts, ci, tn)*s4/s4_scaled;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                            <span class="keywordflow">if</span> (bm)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                            {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].hh].loc_x, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].hh].loc_y,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].loc_x, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].loc_y) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>))</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                    s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                            }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> != mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a>) &amp;&amp; ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2) || (mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2)))</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                            <span class="keywordflow">if</span> ((s == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s))</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                            {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                cq = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a2861b921f91d27644c211a8b49d79290">pcell</a> % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].n_queue[cq] &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab434bcdf1f0c57c9b412084b57644069">InfQueuePeakLength</a>)) <span class="comment">//(Hosts[i3].infector==-1)&amp;&amp;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a>))</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {-1, i3, -1};</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                        <span class="keywordtype">short</span> <span class="keywordtype">int</span> infect_type = 2 + k + <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a> * (1 + si-&gt;<a class="code" href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">infect_type</a> / <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {ci, i3, infect_type};</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                                    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                            }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                        }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                <span class="keywordflow">if</span> ((k == <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>) || (!si-&gt;<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a>))</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                    s3 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#adf1220b1b043d4e6101fb4bde7715a29">PlaceTypePropBetweenGroupLinks</a>[k] * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#adb50ad25ca7a391511383a2cf412d165">PlaceTypeGroupSizeParam1</a>[k] / ((double)<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].n);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                    <span class="keywordflow">if</span> (s3 &gt; 1) s3 = 1;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                    s3_scaled = (fct) ? (s3 * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4efe0e20456caea4e3640f435d117dc9">ScalingFactorPlaceDigitalContacts</a>) : s3;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                    <span class="keywordflow">if</span> (s3_scaled &lt; 0)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                    {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                        <a class="code" href="_error_8h.html#a3f33eb02fe06645ffc38a943efc45df0">ERR_CRITICAL_FMT</a>(<span class="stringliteral">&quot;@@@ %lg\n&quot;</span>, s3);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s3_scaled &gt;= 1)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                        n = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                        n = (int)<a class="code" href="_rand_8cpp.html#a5efb4220d658f7dd6056a98264616d4f">ignbin_mt</a>((<span class="keywordtype">long</span>)<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>, s3_scaled, tn);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                    <span class="keywordflow">if</span> (n &gt; 0) <a class="code" href="_rand_8cpp.html#aa262f1a4a0bf83c91c3614c57fc46521">SampleWithoutReplacement</a>(tn, n, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].n);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; n; m++)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                        <span class="keywordtype">int</span> i3 = <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[<a class="code" href="_rand_8cpp.html#a27488915fe3fa82c70d9166c321fd510">SamplingQueue</a>[tn][m]];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                        s = <a class="code" href="_calc_inf_susc_8cpp.html#abca4d2ea991811c0816ca4ff1884a6bb">CalcPlaceSusc</a>(i3, k, ts, ci, tn);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                        <span class="comment">//these are all place group contacts to be tracked for digital contact tracing - add to StateT queue for contact tracing</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                        <span class="comment">//if infectee is also a user, add them as a contact</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                        <span class="keywordflow">if</span> ((fct) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].digitalContactTracingUser) &amp;&amp; (ci != i3) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3)))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                            s6 = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a757b6ff070f6f6e31ad8b9bc0dbb8c0c">ProportionDigitalContactsIsolate</a> * s;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].ncontacts &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a9ff82be8872693076c8ee8ba7f2ed6ac">MaxDigitalContactsToTrace</a>) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s6))</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                            {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">ncontacts</a>++; <span class="comment">//add to number of contacts made</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                <span class="keywordtype">int</span> ad = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].ndct_queue[ad] &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[ad].n))</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                    <span class="comment">//find adunit for contact and add both contact and infectious host to lists - storing both so I can set times later.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[ad][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[ad]++] = { i3,ci,ts };</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                    fprintf(stderr_shared, <span class="stringliteral">&quot;No more space in queue! Thread: %i, AdUnit: %i\n&quot;</span>, tn, ad);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                            }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].inf == <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd">InfStat_Susceptible</a>) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3)))</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                        {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                            <a class="code" href="struct_microcell.html">Microcell</a>* mt = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                            <a class="code" href="struct_cell.html">Cell</a>* ct = <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a> + <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a2861b921f91d27644c211a8b49d79290">pcell</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                            <span class="comment">//if doing digital contact tracing, scale down susceptibility here</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                            s*= <a class="code" href="_calc_inf_susc_8cpp.html#aa8eff74bc82cbd3ccae0701f1cc40cd6">CalcPersonSusc</a>(i3, ts, ci, tn)*s3/s3_scaled;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                            <span class="keywordflow">if</span> (bm)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                            {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].hh].loc_x, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].hh].loc_y,</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].loc_x, <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[k][l].loc_y) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                    s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                            }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> != mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a>) &amp;&amp; ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2) || (mp-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2)))</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                            <span class="keywordflow">if</span> ((s == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s))</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                            {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                                cq = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a2861b921f91d27644c211a8b49d79290">pcell</a> % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].n_queue[cq] &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab434bcdf1f0c57c9b412084b57644069">InfQueuePeakLength</a>))<span class="comment">//(Hosts[i3].infector==-1)&amp;&amp;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                                {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a>))</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {-1, i3, -1};</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                    {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                        <span class="keywordtype">short</span> <span class="keywordtype">int</span> infect_type = 2 + k + <a class="code" href="_country_8h.html#a5d3313b56154604f08b68fdc748047d0">NUM_PLACE_TYPES</a> + <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a> * (1 + si-&gt;<a class="code" href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">infect_type</a> / <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a>);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = {ci, i3, infect_type};</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                                    }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                            }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                        }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                            }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">if</span> (sbeta &gt; 0) </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">if</span> (si-&gt;<a class="code" href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Travelling</a>) </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        s2 = 0; f = 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        s2 = <a class="code" href="_calc_inf_susc_8cpp.html#a3f6cc1fbd5a979642f5538de205bb824">CalcSpatialInf</a>(ci, ts);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        <span class="comment">//if do digital contact tracing, scale up spatial infectiousness of infectives who are using the app and will be detected</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="keywordflow">if</span> (fct) s2 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad081e0f7470191292399781c2327e420">ScalingFactorSpatialDigitalContacts</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(ci)) </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        s2 *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a46e07ecf99a059e5e73be4cbb654c52f">PlaceCloseSpatialRelContact</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        <span class="comment">/* NumPCD++; */</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        s5 += s2;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">cell_inf</a>[j] = (float)-s5;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        s5 += s2;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">cell_inf</a>[j] = (float)s5;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">if</span> (s5 &gt; 0) </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                n = (int)<a class="code" href="_rand_8cpp.html#a50a53c3fed7a411386c5424c72eeb32a">ignpoi_mt</a>(s5 * sbeta * ((<span class="keywordtype">double</span>)c-&gt;<a class="code" href="struct_cell.html#a0dd64882e5517cf0d96193b6bf73e266">tot_prob</a>), tn); </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordtype">int</span> i2 = c-&gt;<a class="code" href="struct_cell.html#a04465e2d15876175ee2204a3de978173">I</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordflow">if</span> (n &gt; 0) </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i2 - 1; j++) <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].cell_inf[j] /= ((<span class="keywordtype">float</span>) s5);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">cell_inf</a>[i2 - 1] = (<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">cell_inf</a>[i2 - 1] &lt; 0) ? -1.0f : 1.0f;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; n; k++)  </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    <span class="keywordflow">if</span> (i2 == 1)    j = 0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    <span class="keywordflow">else</span>                </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                        <span class="keywordtype">int</span> m;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);    </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        j = m = i2 / 2;     </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        f = 1;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                            <span class="keywordflow">if</span> (m &gt; 1) m /= 2; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                            <span class="keywordflow">if</span> ((j &gt; 0) &amp;&amp; (fabs(<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].cell_inf[j - 1]) &gt;= s))</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                            {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                j -= m;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                <span class="keywordflow">if</span> (j == 0)         f = 0;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                            }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j &lt; i2 - 1) &amp;&amp; (fabs(<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].cell_inf[j]) &lt; s))</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                            {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                j += m;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                <span class="keywordflow">if</span> (j == i2 - 1)    f = 0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                            }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                            <span class="keywordflow">else</span>                    f = 0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        } <span class="keywordflow">while</span> (f);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    f = (<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">cell_inf</a>[j] &lt; 0); </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    ci = c-&gt;<a class="code" href="struct_cell.html#ab0a07dbeae2fe63c8d2ab90ed7ea6f2f">infected</a>[j];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    <a class="code" href="struct_person.html">Person</a>* si = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a> + ci;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <span class="comment">//calculate flag for digital contact tracing here at the beginning for each individual infector</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="keywordtype">int</span> fct = ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8864023fe5b3773ad0f1abbb73b08e11">DoDigitalContactTracing</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a>)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa836f6754e4687ee653f1b6c53346785">DigitalContactTracingPolicyDuration</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].digitalContactTracingUser == 1)); <span class="comment">// &amp;&amp; (ts &lt;= (Hosts[ci].detected_time + P.usCaseIsolationDelay)));</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        s = <a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        <span class="keywordtype">int</span> l = c-&gt;<a class="code" href="struct_cell.html#aee253e4260bedbfbd0a6005fde27d933">InvCDF</a>[(int)floor(s * 1024)];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        <span class="keywordflow">while</span> (c-&gt;<a class="code" href="struct_cell.html#a6f9f7d71211d8b16bb166158bd98ba42">cum_trans</a>[l] &lt; s) l++;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <a class="code" href="struct_cell.html">Cell</a>* ct = <a class="code" href="_covid_sim_8cpp.html#acf339fc9cfee006b65c7bbac4edc9525">CellLookup</a>[l];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <span class="keywordtype">int</span> m = (int)(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) * ((double)ct-&gt;<a class="code" href="struct_cell.html#aa24cfa33fce9c27d441610090a5d883c">S0</a>));</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        <span class="keywordtype">int</span> i3 = ct-&gt;<a class="code" href="struct_cell.html#a7da9a586f1fbe511adac3224615a1c60">susceptible</a>[m];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        s2 = <a class="code" href="_dist_8cpp.html#ac55af114ace27410d66a47b0e252c6a3">dist2</a>(<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a> + i3, <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a> + ci); </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        s = <a class="code" href="_kernels_8cpp.html#a4554988cce0ded4c9a7717faf9baa2f0">numKernel</a>(s2) / c-&gt;<a class="code" href="struct_cell.html#aa5ec9c2b164786826128590d2ed949d6">max_trans</a>[l]; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        f2 = 0;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= s) || (abs(<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].inf) == <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6c452d71d18dec957dca34bcfe2e3b08">InfStat_Dead</a>)) </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            f2 = 1;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                            <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].Travelling) &amp;&amp; ((c != ct) || (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].hh != si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>))) </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                            {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                <a class="code" href="struct_microcell.html">Microcell</a>* mi = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + si-&gt;<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                <a class="code" href="struct_microcell.html">Microcell</a>* mt = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                s = <a class="code" href="_calc_inf_susc_8cpp.html#aea7b679b747b46a33b3de7ef671ccd10">CalcSpatialSusc</a>(i3, ts, ci, tn);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                <span class="comment">//so this person is a contact - but might not be infected. if we are doing digital contact tracing, we want to add the person to the contacts list, if both are users</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                <span class="keywordflow">if</span> (fct)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                    <span class="comment">//if infectee is also a user, add them as a contact</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].digitalContactTracingUser &amp;&amp; (ci != i3))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                    {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].ncontacts&lt;<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a9ff82be8872693076c8ee8ba7f2ed6ac">MaxDigitalContactsToTrace</a>)&amp;&amp;(<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s*<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a757b6ff070f6f6e31ad8b9bc0dbb8c0c">ProportionDigitalContactsIsolate</a>))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                        {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">ncontacts</a>++; <span class="comment">//add to number of contacts made</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                            <span class="keywordtype">int</span> ad = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].ndct_queue[ad] &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[ad].n))</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                            {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                                <span class="comment">//find adunit for contact and add both contact and infectious host to lists - storing both so I can set times later.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[ad][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[ad]++] = { i3,ci,ts };</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                            }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                            {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                fprintf(stderr_shared, <span class="stringliteral">&quot;No more space in queue! Thread: %i, AdUnit: %i\n&quot;</span>, tn, ad);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                            }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                        }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                    <span class="comment">//scale down susceptibility so we don&#39;t over accept</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                    s /= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad081e0f7470191292399781c2327e420">ScalingFactorSpatialDigitalContacts</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                <span class="keywordflow">if</span> (m &lt; ct-&gt;S)  <span class="comment">// only bother trying to infect susceptible people</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                    s *= <a class="code" href="_calc_inf_susc_8cpp.html#aa8eff74bc82cbd3ccae0701f1cc40cd6">CalcPersonSusc</a>(i3, ts, ci, tn);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                    <span class="keywordflow">if</span> (bm)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                    {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a>(<a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#ae5b70863f9dee9092d36d8cab6903304">loc_x</a>, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[si-&gt;<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#a5b984c04b3e1f1b19f101a097ace1b43">loc_y</a>,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#ae5b70863f9dee9092d36d8cab6903304">loc_x</a>, <a class="code" href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].<a class="code" href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">hh</a>].<a class="code" href="struct_household.html#a5b984c04b3e1f1b19f101a097ace1b43">loc_y</a>) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                            s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> != mi-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a>) &amp;&amp; ((mt-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2) || (mi-&gt;<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 2)))</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                        s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">MoveRestrEffect</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                    <span class="keywordflow">if</span> (!f) </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a>(i3)) { s *= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a46e07ecf99a059e5e73be4cbb654c52f">PlaceCloseSpatialRelContact</a>; }<span class="comment">/* NumPCD++;} */</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                    <span class="keywordflow">if</span> ((s == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; s)) </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                    {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                        cq = ((int)(ct - <a class="code" href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a>)) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                        if ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[i3].inf == <a class="code" href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd">InfStat_Susceptible</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq] &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab434bcdf1f0c57c9b412084b57644069">InfQueuePeakLength</a>)) <span class="comment">//Hosts[i3].infector==-1</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                        {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">FalsePositiveRate</a>))</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = { -1, i3, -1 };</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                            {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                <span class="keywordtype">short</span> <span class="keywordtype">int</span> infect_type = 2 + 2 * <a class="code" href="_country_8h.html#a5d3313b56154604f08b68fdc748047d0">NUM_PLACE_TYPES</a> + <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a> * (1 + si-&gt;<a class="code" href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">infect_type</a> / <a class="code" href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[cq][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[cq]++] = { ci, i3, infect_type };</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                            }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                        }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                            }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    } <span class="keywordflow">while</span> (f2);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">        shared(t, run, P, StateT, Hosts, ts)</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; j++)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; k++)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[k].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[j]; i++)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="keywordtype">int</span> infector = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[k].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[j][i].<a class="code" href="struct_infection.html#a9282c3919ca496bf4198ffccf2c75c7e">infector</a>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordtype">int</span> infectee = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[k].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[j][i].<a class="code" href="struct_infection.html#a35fb8d6e90b844483aabea6108228ec2">infectee</a>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keywordtype">short</span> <span class="keywordtype">int</span> infect_type = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[k].<a class="code" href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">inf_queue</a>[j][i].<a class="code" href="struct_infection.html#a456a098a6fbc8de2f6572a7d596e936a">infect_type</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infectee].<a class="code" href="struct_person.html#a163b932f9bcb7abe3d15e0961ea22bbe">infector</a> = infector;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infectee].<a class="code" href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">infect_type</a> = infect_type;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">if</span> (infect_type == -1) </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <a class="code" href="_update_8cpp.html#ad856954ddc4f853a5689b47fb9c4d0ae">DoFalseCase</a>(infectee, t, ts, j);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <a class="code" href="_update_8cpp.html#a6b03f98bdaaa1b8e6cc4fd63e65d501c">DoInfect</a>(infectee, t, j, run);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[k].<a class="code" href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">n_queue</a>[j] = 0;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="_sweep_8h.html#a28ea9814dd487a5716b0183860f34938">  724</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_sweep_8cpp.html#a444b3eac8bea247f096788fc6fafbc4e">IncubRecoverySweep</a>(<span class="keywordtype">double</span> t, <span class="keywordtype">int</span> run)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordtype">double</span> ht;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> ts; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    ts = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * t);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">DoPlaces</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7206e6fc21efe4ed871863e212de77f8">NumHolidays</a>; i++)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            ht = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0772caf9f4f684a708f14c4e51cb223f">HolidayStartTime</a>[i] + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a629f6addd16f0c80a08be59b77e9a0c3">PreControlClusterIdHolOffset</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keywordflow">if</span> ((t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">TimeStep</a> &gt;= ht) &amp;&amp; (t &lt; ht))</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">//              fprintf(stderr, &quot;Holiday %i t=%lg\n&quot;, i, t);</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>; j++)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">        shared(P, Places, Hosts, i, j, ht)</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> tn=0;tn&lt;<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>;tn++)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = tn; k &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#acd900e8640668798a3c99196f664f27d">Nplace</a>[j]; k+=<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                        {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a26c7b2864436284e2fb0d29bad5aec77">HolidayEffect</a>[j] &lt; 1) &amp;&amp; ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a26c7b2864436284e2fb0d29bad5aec77">HolidayEffect</a>[j] == 0) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a26c7b2864436284e2fb0d29bad5aec77">HolidayEffect</a>[j])))</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                            {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                <span class="keywordtype">int</span> l = (int)(ht * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].close_start_time &gt; l)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].<a class="code" href="struct_place.html#a6fdc8ea6b878a05d80a23d862271f633">close_start_time</a> = (<span class="keywordtype">unsigned</span> short) l;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                                <span class="keywordtype">int</span> b = (int)((ht + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a59f96e149e0cccc67ae29575dff1ff3f">HolidayDuration</a>[i]) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].close_end_time &lt; b)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].<a class="code" href="struct_place.html#a082d7b50c83b6de43de4e223d725f210">close_end_time</a> = (<span class="keywordtype">unsigned</span> short) b;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ci = 0; ci &lt; <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>; ci++)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].members[ci]].absent_start_time &gt; l) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[ci]].<a class="code" href="struct_person.html#a8d3b6763f2b3c6697dbd874384dee1bd">absent_start_time</a> = (<span class="keywordtype">unsigned</span> short)l;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].members[ci]].absent_stop_time &lt; b) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][k].<a class="code" href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">members</a>[ci]].<a class="code" href="struct_person.html#ad18abe0f8aab8c1408d0909057dafcc7">absent_stop_time</a> = (<span class="keywordtype">unsigned</span> short)b;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                            }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                        }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="preprocessor">        shared(t, run, P, CellLookup, Hosts, AdUnits, Mcells, StateT, ts)</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)   </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = tn; b &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a46a888930a1549e261168759c3651f4c">NCP</a>; b += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)  </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <a class="code" href="struct_cell.html">Cell</a>* c = <a class="code" href="_covid_sim_8cpp.html#acf339fc9cfee006b65c7bbac4edc9525">CellLookup</a>[b]; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = ((<span class="keywordtype">int</span>)c-&gt;<a class="code" href="struct_cell.html#ac69ac8699ecb85184a229188fb65ee23">L</a> - 1); j &gt;= 0; j--) </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="keywordflow">if</span> (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[c-&gt;<a class="code" href="struct_cell.html#aeb5786c142fa8deb29588ccd7dfcfbd1">latent</a>[j]].<a class="code" href="struct_person.html#ae7380f03f7afebcf9bfb27ee89026d6f">latent_time</a>) </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    <a class="code" href="_update_8cpp.html#ad19985dbb0979eb71d6ccf74dd3e7c9c">DoIncub</a>(c-&gt;<a class="code" href="struct_cell.html#aeb5786c142fa8deb29588ccd7dfcfbd1">latent</a>[j], ts, tn, run); </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">//StateT[tn].n_queue[0] = StateT[tn].n_queue[1] = 0;</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = c-&gt;<a class="code" href="struct_cell.html#a04465e2d15876175ee2204a3de978173">I</a> - 1; j &gt;= 0; j--) </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keywordtype">int</span> ci = c-&gt;<a class="code" href="struct_cell.html#ab0a07dbeae2fe63c8d2ab90ed7ea6f2f">infected</a>[j];    </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="struct_person.html">Person</a>* si = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a> + ci;        </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tc; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="comment">/* Following line not 100% consistent with DoIncub. All severity time points (e.g. SARI time) are added to latent_time, not latent_time + ((int)(P.LatentToSymptDelay / P.TimeStep))*/</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                tc = si-&gt;<a class="code" href="struct_person.html#ae7380f03f7afebcf9bfb27ee89026d6f">latent_time</a> + ((int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aebeab7826d04b2868e535b721c9cc607">LatentToSymptDelay</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">TimeStep</a>)); </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2a19e4c1f3a3e56f624419911e7864f4">DoSymptoms</a>) &amp;&amp; (ts == tc)) </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <a class="code" href="_update_8cpp.html#a4555d52d0bbb474123aefba2e498fab3">DoCase</a>(ci, t, ts, tn);        </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad0bd2e59ad8302e20cfac1a1384933c2">DoSeverity</a>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    <span class="keywordflow">if</span> (ts &gt;= si-&gt;<a class="code" href="struct_person.html#af4c2ecb563b83f7978ae65d13625c1e7">SARI_time</a>)                    <a class="code" href="_update_8cpp.html#ae03c1bfe633a098b2e00e3e1db4e4827">DoSARI</a>(ci, tn); </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">if</span> (ts &gt;= si-&gt;<a class="code" href="struct_person.html#a2c8401e8d30a8132be645bad3c0b7b8a">Critical_time</a>)                <a class="code" href="_update_8cpp.html#af35e7b4931a854fecd1ac807d7b6d289">DoCritical</a>(ci, tn);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    <span class="keywordflow">if</span> (ts &gt;= si-&gt;<a class="code" href="struct_person.html#a7d9606d6c6d77aa8d1ab6af1cffc0773">RecoveringFromCritical_time</a>)  <a class="code" href="_update_8cpp.html#a3aa028c1b90c4900793024759dbc7bde">DoRecoveringFromCritical</a>(ci, tn);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    <span class="keywordflow">if</span> (ts &gt;= si-&gt;<a class="code" href="struct_person.html#aadb96c4bf6dca9b258f446474b6a68cd">recovery_or_death_time</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <span class="keywordflow">if</span> (si-&gt;<a class="code" href="struct_person.html#ade12e47418f02d7771af87ca18245013">to_die</a>)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                            <a class="code" href="_update_8cpp.html#ada87e9ed97b57f138111412bb5e9f094">DoDeath_FromCriticalorSARIorILI</a>(ci, tn);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                            <a class="code" href="_update_8cpp.html#ad4dc1d4a2ae4624f05d51bde13883b7e">DoRecover_FromSeverity</a>(ci, tn);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="comment">//Adding code to assign recovery or death when leaving the infectious class: ggilani - 22/10/14</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="keywordflow">if</span> (ts &gt;= si-&gt;<a class="code" href="struct_person.html#aadb96c4bf6dca9b258f446474b6a68cd">recovery_or_death_time</a>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="keywordflow">if</span> (!si-&gt;<a class="code" href="struct_person.html#ade12e47418f02d7771af87ca18245013">to_die</a>) </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <a class="code" href="_update_8cpp.html#a33acdf9847a2f4264bbfcb872837db31">DoRecover</a>(ci, tn, run);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        <span class="comment">//StateT[tn].inf_queue[0][StateT[tn].n_queue[0]++] = ci; //// add them to end of 0th thread of inf queue. Don&#39;t get why 0 here.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_model_macros_8h.html#ae66746e1f11d41f53bed6d04cddeac6f">HOST_TREATED</a>(ci) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a05a087ba170bfe490c8eaf7b996d527c">TreatDeathDrop</a>))</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                            <a class="code" href="_update_8cpp.html#a33acdf9847a2f4264bbfcb872837db31">DoRecover</a>(ci, tn, run);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                            <a class="code" href="_update_8cpp.html#add3545072579cad99527275129cb5cd1">DoDeath</a>(ci, tn, run);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <span class="comment">//once host recovers, will no longer make contacts for contact tracing - if we are doing contact tracing and case was infectious when contact tracing was active, increment state vector</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8864023fe5b3773ad0f1abbb73b08e11">DoDigitalContactTracing</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#ae7380f03f7afebcf9bfb27ee89026d6f">latent_time</a>&gt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aadb96c4bf6dca9b258f446474b6a68cd">recovery_or_death_time</a> &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">mcell</a>].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">DigitalContactTracingTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa836f6754e4687ee653f1b6c53346785">DigitalContactTracingPolicyDuration</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#a018397cefdfea7838f5ce62c70ff15eb">digitalContactTracingUser</a> == 1) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a9b1c8b9c8a0496a08db3ff27c9bc4fa7">OutputDigitalContactDist</a>))</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].ncontacts &gt; <a class="code" href="_constants_8h.html#a3c41b481bdf730b73815be288d5cd5a4">MAX_CONTACTS</a>) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">ncontacts</a> = <a class="code" href="_constants_8h.html#a3c41b481bdf730b73815be288d5cd5a4">MAX_CONTACTS</a>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                        <span class="comment">//increment bin in State corresponding to this number of contacts</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a174fed5c564ae9226a6aae057274ae3a">contact_dist</a>[<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[ci].<a class="code" href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">ncontacts</a>]++;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="_sweep_8h.html#a1f931baf497c800af860bebf6b1554cc">  827</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_sweep_8cpp.html#ab42e825233f629afd92c571f475809f3">DigitalContactTracingSweep</a>(<span class="keywordtype">double</span> t)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> ts;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">//find current time step</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    ts = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * t);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    FILE* stderr_shared = stderr;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">        shared(t, P, AdUnits, StateT, Hosts, ts, stderr_shared)</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = tn; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae5cb537aacce9565a8066f73cef6d69c">NumAdunits</a>; i += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">if</span> (t &gt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].DigitalContactTracingTimeStart)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; j++)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i];)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        <span class="comment">//start by finding theoretical start and end isolation times for each contact;</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        <span class="comment">//these are calculated here for each time step instead of InfectSweep when contact event is added as trigger times will be updated for asymptomatic cases detected by testing.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                        <span class="keywordtype">int</span> infector = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k].<a class="code" href="struct_contact_event.html#a8521433d4a8ecc23ea758a09746b5f04">index</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                        <span class="keywordtype">int</span> contact = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k].<a class="code" href="struct_contact_event.html#a9c1e28b94e6dbf1acfe1b38a256b1191">contact</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> contact_time = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k].<a class="code" href="struct_contact_event.html#aeb699ca100a975580da4e67e8c8660b7">contact_time</a>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> dct_start_time, dct_end_time;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                        <span class="comment">//this condition is only ever met when a symptomatic case is detected in DoDetectedCase and is not already an index case. If they have already</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <span class="comment">//been made an index case due to testing, then this won&#39;t occur again for them.</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <span class="keywordflow">if</span> (infector==-1)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                            <span class="comment">//i.e. this is an index case that has been detected by becoming symptomatic and added to the digital contact tracing queue</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                            dct_start_time = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a145e478a074f2af391591629e81d124d">dct_trigger_time</a>; <span class="comment">//trigger time for these cases is set in DoIncub and already accounts for delay between onset and isolation</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                            dct_end_time = dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa56f5859b115309dd02525b3ff404ede">LengthDigitalContactIsolation</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        <span class="keywordflow">else</span> <span class="comment">//We are looking at actual contact events between infectious hosts and their contacts.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                            <span class="comment">//trigger times are either set in DoDetectedCase or in the loop below (for asymptomatic and presymptomatic cases that are picked up via testing</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                            <span class="comment">//If the contact&#39;s index case has a trigger time that means that they have been detected, and we can calculate start and end isolation times for the contact.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].dct_trigger_time &lt; (USHRT_MAX - 1))</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                            {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                <span class="keywordflow">if</span> (contact_time &gt; <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].dct_trigger_time)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                    <span class="comment">//if the contact time was made after host detected, we should use the later time</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                    dct_start_time = contact_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a76571a6e8278b1ab58af438a9a534727">DigitalContactTracingDelay</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                    <span class="comment">//if the contact time was made before or at the same time as detection, use the trigger time instead</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                    dct_start_time = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].<a class="code" href="struct_person.html#a145e478a074f2af391591629e81d124d">dct_trigger_time</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a76571a6e8278b1ab58af438a9a534727">DigitalContactTracingDelay</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                dct_end_time = dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa56f5859b115309dd02525b3ff404ede">LengthDigitalContactIsolation</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                            {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                                dct_start_time = USHRT_MAX - 1; <span class="comment">//for contacts of asymptomatic or presymptomatic cases - they won&#39;t get added as their index case won&#39;t know that they are infected (unless explicitly tested)</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                <span class="comment">//but we keep them in the queue in case their index case is detected as the contact of someone else and gets their trigger time set</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                                <span class="comment">//set dct_end_time to recovery time of infector, in order to remove from queue if their infector isn&#39;t detected before they recover.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                dct_end_time = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].<a class="code" href="struct_person.html#aadb96c4bf6dca9b258f446474b6a68cd">recovery_or_death_time</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                            }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                        }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        <span class="comment">//if we&#39;ve reached the start time for isolation</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                        <span class="keywordflow">if</span> (dct_start_time == ts)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                        {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                            <span class="comment">//if the host has been detected due to being symptomatic, they are now an index case - set this variable now. For index cases detected by testing, this will be set on testing</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                            <span class="keywordflow">if</span> ((infector==-1) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 0)) <span class="comment">//don&#39;t really need the second condition as the first should only be true when the second isn&#39;t (due to how this contact is logged in DoDetectedCase)</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                            {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 1; <span class="comment">//assign them as an index case</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                            }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                            <span class="comment">//if contact is not being traced at all</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].digitalContactTraced == 0)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                            {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                <span class="comment">//move into the contact tracing list for that admin unit, set start and end times, update flag and remove from queue</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].ndct &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].n) <span class="comment">//AdUnits[i].n is length of queue</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aa14ef8eba97259db09b465f86193b2ae">dct_start_time</a> = dct_start_time;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = dct_end_time;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a44c74477efffa4b84a027e05229db846">digitalContactTraced</a> = 1;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                    <span class="comment">//At this point, we do testing on index cases who have been picked up on symptoms alone, in order to figure out whether and when</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                    <span class="comment">//to remove their contacts (if P.RemoveContactsOfNegativeIndexCase). It&#39;s much harder to do it in the next loop as we don&#39;t have all</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                    <span class="comment">//the information about the contact event there and would need to loop over all contacts again to look for their index case</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                    <span class="comment">//This would cause race conditions due to having a loop over adunits within threaded loop over admin units</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                    <span class="comment">//Only set test times if P.DoDCTTest. If P.DoDCTTest==0, but we are finding contacts of contacts, we check to see if contacts should become index cases every day they are in isolation.</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad6277e8ebe91728f87d68e5f44e61e8c">DoDCTTest</a>)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                    {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 1)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                        {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                            <span class="comment">//set testing time (which has a different delay to contact testing delay), but no need to set index_case link</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a> = dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6a00777e9ffeb03929081d7920431d31">DelayToTestIndexCase</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                            <span class="comment">//if host is infectious at test time</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time &gt;= <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].latent_time) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time &lt; <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].recovery_or_death_time))</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                            {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                                <span class="comment">//if false negative, remove from queue by setting the end time to the test time</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> == 0) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> &lt; 1) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a>)))</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                                {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                                    <span class="comment">//set index_dct_flag to 2 to indicate that contacts should be removed, if we are removing based on negative test result of index case</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 2;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                                }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                            }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                            <span class="comment">//if host is non-infectious)</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                            {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                                <span class="comment">//if true negative, remove from list</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> == 1) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a>)))</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                                {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                                    <span class="comment">//again mark them to be removed from list at test time rather than end_time, and change index_case_dct flag</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 2;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                                }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                            }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                        }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 0)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                        {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                            <span class="comment">//if their infector is set to be removed from the list at test time, and their contacts will also be removed at this stage</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].index_case_dct == 2) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>))</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                            {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                                <span class="comment">//set end time to match end time of infector</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                            }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                            {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                                <span class="comment">//set testing time</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a> = dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af34088a13b55690f86007099530d4528">DelayToTestDCTContacts</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                            }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                        }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                    <span class="comment">//actually put them in the queue</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">dct</a>[<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a>] = contact;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                    <span class="comment">//update number of people in queue</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a>++;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                    <span class="comment">//increment state variables</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a849409c10e486b1fd98f9cf60a840d96">cumDCT_adunit</a>[i]++;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[tn].<a class="code" href="struct_pop_var.html#a6354d7f0e2d67eb13ce3159e8a9701d7">cumDCT</a>++;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                    <span class="comment">//now remove this case from the queues</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k] = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1];</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1] = { contact,infector,contact_time };</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i]--;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                    fprintf(stderr_shared, <span class="stringliteral">&quot;No more space in queue! AdUnit: %i, ndct=%i, max queue length: %i\n&quot;</span>, i, <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].ndct, <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].n);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                    fprintf(stderr_shared, <span class="stringliteral">&quot;Error!\n&quot;</span>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                    k++;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                            }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                            <span class="comment">//else if contact is already being contact traced</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].digitalContactTraced == 1)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                            {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad6277e8ebe91728f87d68e5f44e61e8c">DoDCTTest</a>)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                    <span class="comment">//if case has been detected due to being symptomatic, then we will update their testing time if they would be tested earlier based on being an index case as opposed to being a contact of another case</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                    <span class="comment">//If they are already being contact traced and testing is on, they should have been set a test_time</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 1) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time &gt; (dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6a00777e9ffeb03929081d7920431d31">DelayToTestIndexCase</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>))))</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                    {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a> = dct_start_time + (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6a00777e9ffeb03929081d7920431d31">DelayToTestIndexCase</a> * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                        <span class="comment">//update end time (which is always at least equal to, but may be later that the current one)</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = dct_end_time;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                        <span class="comment">//check to see if test will be negative, if so, tag them for early removal and update index_dct_flag</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time &gt;= <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].latent_time) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time &lt; <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].recovery_or_death_time))</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                        {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                            <span class="comment">//if false negative, remove from</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> == 0) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> &lt; 1) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a>)))</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                            {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                <span class="comment">//set index_dct_flag to 2 to indicate that contacts should be removed</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 2;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                            }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                        <span class="comment">//if host is non-infectious</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                        {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                            <span class="comment">//if true negative, remove from list</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> == 1) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a>)))</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                            {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                                <span class="comment">//again mark them to be removed from list at test time rather than end_time, and change index_case_dct flag</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">dct_test_time</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 2;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                            }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                        }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                    {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                        <span class="comment">//we don&#39;t want to remove this contact if they are also linked to another case - their testing time shouldn&#39;t change.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                                        <span class="comment">//but we&#39;ll only extend their end time if they wouldn&#39;t potentially be removed by having a negative contact</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                        <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">RemoveContactsOfNegativeIndexCase</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[infector].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> == 1)))</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                        {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                            <span class="comment">//extend end time</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = dct_end_time;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                        <span class="comment">//otherwise if contact would have been removed if they didn&#39;t have another contact, we keep their original end time</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                    }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                    <span class="comment">//just extend the isolation end time, but we&#39;re not going to update testing time or as we still want the testing time to be dependent on the earlier contact.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = dct_end_time; <span class="comment">//we could choose to not extend the time for cases who are index cases. If they are tested and are negative, they&#39;d be removed earlier anyway. If positive, they will stay isolated for a bit longer</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                <span class="comment">//now remove this case from the queue</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k] = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1] = { contact,infector,contact_time };</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i]--;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                            }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        <span class="comment">//if contact of an asymptomatic host has passed the recovery time of their asymptomatic index, they would no longer be identified by testing of their index case - remove from the queue so they don&#39;t stay here forever</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((dct_start_time == (USHRT_MAX - 1)) &amp;&amp; (dct_end_time == ts))</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                            <span class="comment">//now remove this case from the queue</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][k] = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1];</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">dct_queue</a>[i][<a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i] - 1] = { contact,infector,contact_time };</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[j].<a class="code" href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">ndct_queue</a>[i]--;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            k++;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="preprocessor">        shared(t, P, AdUnits, Hosts, ts)</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = tn; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae5cb537aacce9565a8066f73cef6d69c">NumAdunits</a>; i += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordflow">if</span> (t &gt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].DigitalContactTracingTimeStart)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a>;)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    <span class="keywordtype">int</span> contact = <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">dct</a>[j];</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    <span class="comment">//first do testing of index cases and their contacts</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad6277e8ebe91728f87d68e5f44e61e8c">DoDCTTest</a>)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_test_time == ts) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 0))</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                        {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                            <span class="comment">//if host is positive</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                            <span class="keywordflow">if</span> ((abs(<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf) == 2) || (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf == -1)) <span class="comment">//either asymptomatic infectious, symptomatic infectious or presymptomatic infectious</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                            {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                <span class="comment">//if the test is a false negative</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> == 0) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a> &lt; 1) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">SensitivityDCT</a>)))</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = ts;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                <span class="comment">//else if a true positive</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae0c92fe1c273cbeaa88b6e59f372b081">FindContactsOfDCTContacts</a>)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                    <span class="comment">//set them to be an index case</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 1;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                    <span class="comment">//set trigger time to pick up their contacts in the next time step</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a145e478a074f2af391591629e81d124d">dct_trigger_time</a> = ts + 1; <span class="comment">//added the +1 here so that if there are no delays, the contacts will still get picked up correctly</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                    <span class="comment">//if they are asymptomatic, i.e. specifically if they have inf flag 2, call DoDetectedCase in order to trigger HQ and PC too.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf == 2)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                                    {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                                        <a class="code" href="_update_8cpp.html#a398043938a21921a383d5fa4062605e3">DoDetectedCase</a>(contact, t, ts, tn);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a28e2897a7d04b84b3557944ad637c371">detected</a> = 1; <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aadec0fd0b4b5ff8fe9116364ca5889b5">detected_time</a> = ts;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                            }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                            <span class="comment">//or if host is negative</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                            {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                <span class="comment">//and is a true negative</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> == 1) || ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a> &gt; 0) &amp;&amp; (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">SpecificityDCT</a>)))</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">dct_end_time</a> = ts;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                <span class="comment">//can&#39;t track contacts of false positives as they don&#39;t make any contacts in InfectSweep</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                            }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae0c92fe1c273cbeaa88b6e59f372b081">FindContactsOfDCTContacts</a>)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                        <span class="comment">//check every day to see if contacts become index cases - but they have to be infectious. Otherwise we could set the trigger time and cause their contacts to be traced when they are not being traced themselves.</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct == 0) &amp;&amp; ((abs(<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf) == 2) || (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf == -1)))</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                            <span class="comment">//if ((Hosts[contact].dct_test_time == ts) &amp;&amp; (Hosts[contact].index_case_dct == 0) &amp;&amp; ((abs(Hosts[contact].inf) == 2) || (Hosts[contact].inf == -1)))</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                            <span class="comment">//set them to be an index case</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 1;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                            <span class="comment">//set trigger time to pick up their contacts in the next time step</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a145e478a074f2af391591629e81d124d">dct_trigger_time</a> = ts + 1; <span class="comment">//added the +1 here so that if there are no delays, the contacts will still get picked up correctly</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                            <span class="comment">//if they are asymptomatic, i.e. specifically if they have inf flag 2, call DoDetectedCase in order to trigger HQ and PC too.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].inf == 2)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                            {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                <a class="code" href="_update_8cpp.html#a398043938a21921a383d5fa4062605e3">DoDetectedCase</a>(contact, t, ts, tn);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a28e2897a7d04b84b3557944ad637c371">detected</a> = 1; <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aadec0fd0b4b5ff8fe9116364ca5889b5">detected_time</a> = ts;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                            }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    <span class="comment">//now remove hosts who have reached the end of their isolation time</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].dct_end_time == ts)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                    {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                        <span class="comment">//stop contact tracing this host</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#a44c74477efffa4b84a027e05229db846">digitalContactTraced</a> = 0;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                        <span class="comment">//remove index_case_dct flag to 0;</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].index_case_dct)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                        {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[contact].<a class="code" href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">index_case_dct</a> = 0;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                            <span class="comment">//Hosts[contact].dct_trigger_time = USHRT_MAX - 1;</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                        <span class="comment">//remove from list</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        <span class="comment">//k = contact;</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">dct</a>[j] = <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">dct</a>[<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a> - 1];</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">dct</a>[<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a> - 1] = contact;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[i].<a class="code" href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">ndct</a>--;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        j++;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="_sweep_8h.html#a8020679604db073302610acd6485f166"> 1165</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_sweep_8cpp.html#a8c3ab55d74e7e4b328c3120b87ba4177">TreatSweep</a>(<span class="keywordtype">double</span> t)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;{</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordtype">int</span> f, f1, f2, f3, f4; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">int</span> nckwp;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> ts;      </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tstf;    </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tstb;    </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tsvb;    </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tspf;    </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tsmb;    </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tsmf;    </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tssdf;   </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> tskwpf;  </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordtype">int</span> global_trig;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordtype">double</span> r;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    ts = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * t);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    f = f1 = 0;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            global_trig = (int)floor(((<span class="keywordtype">double</span>)<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#aae8e8b2368902517395051003c7f3738">trigDC</a>) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5ad35770a4723d3ed5fa675e3d891963">GlobalIncThreshPop</a> / ((<span class="keywordtype">double</span>)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0f9acd8c89fe4f36adfcb3711e3dcfd3">PopSize</a>));</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            global_trig = <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#aae8e8b2368902517395051003c7f3738">trigDC</a>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        global_trig = 0;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">DoPlaces</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aac49a1ec7cdf5e28cb9033d94fd66be4">TreatTimeStart</a>) &amp;&amp; (t &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aac49a1ec7cdf5e28cb9033d94fd66be4">TreatTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0ddebf08542f128fec0f9a196e1bac7a">TreatPlaceGeogDuration</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a287d26e2171dfba7fb548c4b76181512">cumT</a> &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a616ffcb2dabdce9d11cb5d8db07cd3f6">TreatMaxCourses</a>))</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        tstf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad4920e3469458a40d16457bb51484d8c">TreatDelayMean</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d52b3c2824d4343244db8583cf47d4a">TreatProphCourseLength</a>));</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">#pragma omp parallel for private(f) reduction(+:f1) schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">            shared(P, StateT, Places, Hosts, ts, tstf)</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; i++)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>; j++)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a81ac0079d7384de0995dd6bc428bcdf1">np_queue</a>[j]; k++)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#ade6e3381844feecb7367ab7d18d9f105">p_queue</a>[j][k];</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2e29c19ad6b269b17068bee55d2bcfe3">DoPlaceGroupTreat</a>)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        f = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a248346723693921070cac74d119f579e">pg_queue</a>[j][k];</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = ((<span class="keywordtype">int</span>)<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].<a class="code" href="struct_place.html#a90795f850fc6824ce4d6c7fee6d6d15d">group_start</a>[f]); m &lt; ((int)(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].group_start[f] + <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].group_size[f])); m++)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                            <span class="comment">/*                          if((Places[j][l].members[m]&lt;0)||(Places[j][l].members[m]&gt;P.PopSize-1))</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">                                                            fprintf(stderr,&quot;\n*** npq=%i gn=%i h=%i m=%i j=%i l=%i f=%i s=%i n=%i ***\n&quot;,</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">                                                                StateT[i].np_queue[j],</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">                                                                Places[j][l].n,</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">                                                                Places[j][l].members[m],</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">                                                                m,j,l,f,</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">                                                                (int) Places[j][l].group_start[f],</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">                                                                (int) Places[j][l].group_size[f]);</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">                                                        else</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">                            */</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                            <span class="keywordflow">if</span> ((!<a class="code" href="_model_macros_8h.html#a021c0d276055369d1583da0064dcc251">HOST_TO_BE_TREATED</a>(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].members[m])) &amp;&amp; ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a70cec34085663abc126c69456b1322b6">TreatPlaceTotalProp</a>[j] == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(i) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a70cec34085663abc126c69456b1322b6">TreatPlaceTotalProp</a>[j])))</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                <a class="code" href="_update_8cpp.html#a4203ecbf10830311175115a8443e454b">DoProph</a>(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].members[m], ts, i);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                        }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                    }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                    {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].treat) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#ae5e3b8fc412a10167255a8928f2e25ef">PLACE_TREATED</a>(j, l)))</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                            f1 = 1;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].<a class="code" href="struct_place.html#a1d215d4c7b8fad842b057dd53cab41ca">treat_end_time</a> = tstf;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].<a class="code" href="struct_place.html#a66141d3948f8fffd6388415e6345729d">n</a>; m++)</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                <span class="keywordflow">if</span> (!<a class="code" href="_model_macros_8h.html#a021c0d276055369d1583da0064dcc251">HOST_TO_BE_TREATED</a>(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].members[m]))</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a70cec34085663abc126c69456b1322b6">TreatPlaceTotalProp</a>[j] == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(i) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a70cec34085663abc126c69456b1322b6">TreatPlaceTotalProp</a>[j]))</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                        <a class="code" href="_update_8cpp.html#a4203ecbf10830311175115a8443e454b">DoProph</a>(<a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].members[m], ts, i);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a>[j][l].<a class="code" href="struct_place.html#a0535d382cc253cff695004e9f845b4d0">treat</a> = 0;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a81ac0079d7384de0995dd6bc428bcdf1">np_queue</a>[j] = 0;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa2a41d48cd984636fbdd53fa5605eb17">DoMassVacc</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2cf95afcb2ee088931b39f0e8e4b7d13">VaccTimeStart</a>))</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordtype">int</span> m = (int)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8ca7c57c4419619e426f8379b89ac550">VaccMaxCourses</a>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            if (m &gt; <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#af10f510f31a2dc02e4d0a3153c72b5f8">n_mvacc</a>) m = <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#af10f510f31a2dc02e4d0a3153c72b5f8">n_mvacc</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="preprocessor">#pragma omp parallel for schedule(static,1000) default(none) \</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor">                shared(State, m, ts)</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#ac19f094e2c6d80c442ba2dee0675d217">mvacc_cum</a>; i &lt; m; i++)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                <a class="code" href="_update_8cpp.html#a84ca4cb21b622f11b7e84e177a02e54b">DoVacc</a>(<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a6be9476583f6d6ed75a6c76e605ad5c9">mvacc_queue</a>[i], ts);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#ac19f094e2c6d80c442ba2dee0675d217">mvacc_cum</a> = m;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">if</span> ((t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aac49a1ec7cdf5e28cb9033d94fd66be4">TreatTimeStart</a>) || (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae2b71620f3ff6825b76eaa1bb0f7daef">VaccTimeStartGeo</a>) || (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2a45360afbfb6e8e7a417e23a9332856">PlaceCloseTimeStart</a>) || (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a>) || (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a92ecd5c72609159927a0b10eeb8a74d1">SocDistTimeStart</a>) || (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5da47f23a0ec1625b5db97741751fe16">KeyWorkerProphTimeStart</a>)) <span class="comment">//changed this to start time geo</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        tstf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d52b3c2824d4343244db8583cf47d4a">TreatProphCourseLength</a>) - 1);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        tstb = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad4920e3469458a40d16457bb51484d8c">TreatDelayMean</a>));</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        tsvb = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a67a7cc9c21b8e5069d14a161ec3d7130">VaccDelayMean</a>));</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        tspf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7c05904b7bb5f9bbb43888affb443a03">PlaceCloseDelayMean</a> + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7f33738393141946bc763dca978d91ec">PlaceCloseDuration</a>));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        tsmf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7328b90f5f8e56ad824ced77b6d62303">MoveRestrDuration</a>));</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        tsmb = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) floor(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#acb82b4c2a97ca9a4a81543ca88061176">MoveDelayMean</a>));</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        tssdf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af4d908cf2d7ee3dce743983a56dcdd9d">SocDistDurationCurrent</a>));</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        tskwpf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1c9861fda43d5b84c2a2d2570806b7ff">KeyWorkerProphRenewalDuration</a>));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        nckwp = (int)ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a22019a278c77c27bbd2f1519a8dd44e1">KeyWorkerProphDuration</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d52b3c2824d4343244db8583cf47d4a">TreatProphCourseLength</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor">#pragma omp parallel for private(f2,f3,f4,r) reduction(+:f) schedule(static,1) default(none) \</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="preprocessor">            shared(t, P, Hosts, Mcells, McellLookup, AdUnits, State, global_trig, ts, tstf, tstb, tsvb, tspf, tsmf, tsmb, tssdf, tskwpf, nckwp)</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tn = 0; tn &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; tn++)</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bs = tn; bs &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0200e35d690636cf5257fc906d9c39c8">NMCP</a>; bs += <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>) </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="keywordtype">int</span> b = (int)(<a class="code" href="_covid_sim_8cpp.html#af6cb3392363bc05dc3ab0e3515466ba9">McellLookup</a>[bs] - <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>); </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <span class="keywordtype">int</span> adi = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1f86136f3922ad5036de974477d5b139">DoAdUnits</a>) ? <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].adunit : -1;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <span class="keywordtype">int</span> ad = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1f86136f3922ad5036de974477d5b139">DoAdUnits</a>) ? <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].<span class="keywordtype">id</span> : 0;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].treat == 2) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a02f7da552a03d5fdc2de771cdbe14458">treat_end_time</a>))</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                    {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">treat</a> = 0;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].treat == 1) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aafd0a675dcda11f38ee47b332bd378fb">treat_start_time</a>))</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                    {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">treat</a> = 2;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> = 0;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a02f7da552a03d5fdc2de771cdbe14458">treat_end_time</a> = tstf;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a99c178515a8b99d24ad28b249ee2b3ca">n</a>; i++)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                            <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a1ba5ca77bb4bbb4b2dacd794e217b1d4">members</a>[i];</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                            <span class="keywordflow">if</span> ((!<a class="code" href="_model_macros_8h.html#a021c0d276055369d1583da0064dcc251">HOST_TO_BE_TREATED</a>(l)) &amp;&amp; ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8cda67618bb03002e125eabf624b1a5e">TreatPropRadial</a> == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8cda67618bb03002e125eabf624b1a5e">TreatPropRadial</a>)))</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                <a class="code" href="_update_8cpp.html#a9d8307b46ce56c14df0d4ef92b0f8e8b">DoProphNoDelay</a>(l, ts, tn, 1);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                        }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                        f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4adadc68277be8199c537f298dca2855">TreatCellIncThresh</a>);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4adadc68277be8199c537f298dca2855">TreatCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : (<span class="keywordtype">int</span>)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4adadc68277be8199c537f298dca2855">TreatCellIncThresh</a>;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt; trig_thresh);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4adadc68277be8199c537f298dca2855">TreatCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : (<span class="keywordtype">int</span>)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4adadc68277be8199c537f298dca2855">TreatCellIncThresh</a>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                    }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                    <span class="keywordflow">if</span> ((t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aac49a1ec7cdf5e28cb9033d94fd66be4">TreatTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">treat</a> == 0) &amp;&amp; (f2) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae9a2cd49e0973aa1d2070a9965a5e27b">TreatRadius2</a> &gt; 0))</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                    {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        <span class="keywordtype">int</span> minx = (b / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                        <span class="keywordtype">int</span> miny = (b % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                        <span class="keywordtype">int</span> k = b;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                        <span class="keywordtype">int</span> maxx = 0;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        <span class="keywordtype">int</span> i, j, m, l;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                        i = j = m = f2 = 0;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                        l = f3 = 1;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                        <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa43fdec6bbe58538d4e1444ffdbabcd2">TreatByAdminUnit</a>) || (ad &gt; 0))</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                        {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                            <span class="keywordtype">int</span> ad2 = ad / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac1f015be2e11510f4261e1847eef6ebc">TreatAdminUnitDivisor</a>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                            <span class="keywordflow">do</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                            {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                <span class="keywordflow">if</span> ((minx &gt;= 0) &amp;&amp; (minx &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) &amp;&amp; (miny &gt;= 0) &amp;&amp; (miny &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>))</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa43fdec6bbe58538d4e1444ffdbabcd2">TreatByAdminUnit</a>)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                        f4 = (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1a1e07bd496a1357073307f0b1ef889d">id</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ac1f015be2e11510f4261e1847eef6ebc">TreatAdminUnitDivisor</a> == ad2);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                        f4 = ((r = <a class="code" href="_dist_8cpp.html#a8b3fef89400dcf81129a35658449918a">dist2_mm</a>(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + b, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + k)) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae9a2cd49e0973aa1d2070a9965a5e27b">TreatRadius2</a>);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                    <span class="keywordflow">if</span> (f4)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                    {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                        f = f2 = 1;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">treat</a> == 0))</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                        {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#aafd0a675dcda11f38ee47b332bd378fb">treat_start_time</a> = tstb;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">treat</a> = 1;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                            maxx += <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a99c178515a8b99d24ad28b249ee2b3ca">n</a>;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                        }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                    }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                <span class="keywordflow">if</span> (j == 0)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                    minx = minx + 1;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 1)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                    miny = miny - 1;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 2)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                    minx = minx - 1;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 3)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                    miny = miny + 1;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                m = (m + 1) % l;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                    j = (j + 1) % 4;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                    i = (i + 1) % 2;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                    <span class="keywordflow">if</span> (i == 0) l++;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                    <span class="keywordflow">if</span> (j == 1) { f3 = f2; f2 = 0; }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                k = ((minx + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a> + (miny + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                            } <span class="keywordflow">while</span> ((f3) &amp;&amp; (maxx &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7a25f38ea866727c44666d6c23586af1">TreatMaxCoursesPerCase</a>));</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].vacc == 1) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ab4be01087bf63f18858bf31fb7818197">vacc_start_time</a>))</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ae32a174baccdeda1ca247253b40a0648">vacc_trig</a> = 0;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        <span class="comment">//if(State.cumVG+P.NumThreads*Mcells[b].n&lt;P.VaccMaxCourses) //changed to VG - commented this out for now, we&#39;ll add everyone to queues and deal with the number of doses available in the vaccination function</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                        {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a99c178515a8b99d24ad28b249ee2b3ca">n</a>; i++)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                            {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                <span class="keywordtype">int</span> l = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a1ba5ca77bb4bbb4b2dacd794e217b1d4">members</a>[i];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                <span class="comment">//#pragma omp critical (state_cumV_daily) //added this</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                <span class="keywordflow">if</span> (((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2f0e5a285e87c4df4914bba98a0dbb79">VaccProp</a> == 1) || (<a class="code" href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a>(tn) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2f0e5a285e87c4df4914bba98a0dbb79">VaccProp</a>)))</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                    <span class="comment">//add to the queue</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                    <a class="code" href="_update_8cpp.html#a1331e2a748745d26884940c9de881aff">DoVaccNoDelay</a>(l,ts);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">vacc</a> = 2;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                        }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">VaccCellIncThresh</a>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">VaccCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : (<span class="keywordtype">int</span>)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">VaccCellIncThresh</a>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt; trig_thresh);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                    }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                    {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">VaccCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : (<span class="keywordtype">int</span>)<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">VaccCellIncThresh</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                    }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                    <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aa2a41d48cd984636fbdd53fa5605eb17">DoMassVacc</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0031fee22c1984883e57ced8e6d33f57">VaccRadius2</a> &gt; 0) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae2b71620f3ff6825b76eaa1bb0f7daef">VaccTimeStartGeo</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">vacc</a> == 0) &amp;&amp; (f2)) <span class="comment">//changed from VaccTimeStart to VaccTimeStarGeo</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                    {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                        <span class="keywordtype">int</span> minx = (b / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        <span class="keywordtype">int</span> miny = (b % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                        <span class="keywordtype">int</span> k = b;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                        <span class="keywordtype">int</span> i, j, l, m;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                        i = j = m = f2 = 0;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                        l = f3 = 1;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                        <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a68fd9a615d061eb086207783831d92c3">VaccByAdminUnit</a>) || (ad &gt; 0))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                        {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            <span class="keywordtype">int</span> ad2 = ad / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a898a04b71d6f28fb6de536342b4503fa">VaccAdminUnitDivisor</a>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            <span class="keywordflow">do</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                                <span class="keywordflow">if</span> ((minx &gt;= 0) &amp;&amp; (minx &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) &amp;&amp; (miny &gt;= 0) &amp;&amp; (miny &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>))</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                                {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a68fd9a615d061eb086207783831d92c3">VaccByAdminUnit</a>)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                                    {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                                        f4 = (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1a1e07bd496a1357073307f0b1ef889d">id</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a898a04b71d6f28fb6de536342b4503fa">VaccAdminUnitDivisor</a> == ad2);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                        r = 1e20;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                                    }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                                        f4 = ((r = <a class="code" href="_dist_8cpp.html#a8b3fef89400dcf81129a35658449918a">dist2_mm</a>(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + b, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + k)) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0031fee22c1984883e57ced8e6d33f57">VaccRadius2</a>);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                    <span class="keywordflow">if</span> (f4)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                                    {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                                        f = f2 = 1;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                                        <span class="keywordflow">if</span> (r &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab6ec0ea65cc2e546d9f19458f6cd7273">VaccMinRadius2</a>)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">vacc</a> = 3;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">vacc</a> == 0))</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                                        {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#ab4be01087bf63f18858bf31fb7818197">vacc_start_time</a> = tsvb;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">vacc</a> = 1;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                        }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                <span class="keywordflow">if</span> (j == 0)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                    minx = minx + 1;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 1)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                    miny = miny - 1;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 2)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                    minx = minx - 1;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 3)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                                    miny = miny + 1;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                m = (m + 1) % l;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                    j = (j + 1) % 4;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                    i = (i + 1) % 2;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                    <span class="keywordflow">if</span> (i == 0) l++;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                                    <span class="keywordflow">if</span> (j == 1) { f3 = f2; f2 = 0; }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                k = ((minx + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a> + (miny + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                            } <span class="keywordflow">while</span> (f3);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                        }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                        f2 = (global_trig &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">PlaceCloseCellIncStopThresh</a>);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                    {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">PlaceCloseCellIncStopThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">PlaceCloseCellIncStopThresh</a>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &lt; trig_thresh);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                    }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">PlaceCloseCellIncStopThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">PlaceCloseCellIncStopThresh</a>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &lt; trig_thresh);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].placeclose == 2) &amp;&amp; ((f2) || (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].place_end_time))) </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a406a99c4386e01acb83cb6d354f7d6b0">placeclose</a> = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a8245c40ebfaa3657eb4ae5a9df846744">DoPlaceCloseOnceOnly</a>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2a7b3f14f0df90ff856109140d5a0d23">place_end_time</a> = ts;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a8753636ae22cdb39e91cdba6bf684e58">place_trig</a> = 0;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        <span class="keywordflow">if</span> (f2)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j2 = 0; j2 &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>; j2++)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                                <span class="keywordflow">if</span> (j2 != <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2 = 0; i2 &lt; <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ac6f9a440b22cf1b1efa734b910b51bd0">np</a>[j2]; i2++)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                        <a class="code" href="_update_8cpp.html#a347a1d99039fadf2ee33ddc0aedfbf63">DoPlaceOpen</a>(j2, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].places[j2][i2], ts, tn);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                        }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">DoPlaces</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2a45360afbfb6e8e7a417e23a9332856">PlaceCloseTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].placeclose == 0))</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                            f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">PlaceCloseCellIncThresh</a>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                        }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                        {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                            <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">PlaceCloseCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">PlaceCloseCellIncThresh</a>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                            f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt; trig_thresh);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                        {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                            <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">PlaceCloseCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">PlaceCloseCellIncThresh</a>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                            f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                        <span class="keywordflow">if</span> (((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4a8d8a2d25046d5d0ed9fb2b36662f43">PlaceCloseByAdminUnit</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a9943b56a8e9cbd84a7fe0018f4c47668">place_close_trig</a> &lt; USHRT_MAX - 1)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                            &amp;&amp; (((<span class="keywordtype">double</span>)<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a9943b56a8e9cbd84a7fe0018f4c47668">place_close_trig</a>) / ((<span class="keywordtype">double</span>)<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a9f2ca854cd8d4c94a239b34bfdc5f2f3">NP</a>) &gt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0dc378d5f0fb7c14fa0d59ebadbe4bf8">PlaceCloseAdunitPropThresh</a>))</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                            || ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4a8d8a2d25046d5d0ed9fb2b36662f43">PlaceCloseByAdminUnit</a>) &amp;&amp; (f2)))</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                        {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                            <span class="comment">//                          if(P.PlaceCloseByAdminUnit) AdUnits[Mcells[b].adunit].place_close_trig=USHRT_MAX-1; // This means schools only close once</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                            <span class="keywordtype">int</span> interventionFlag; <span class="comment">//added this as a way to help filter out when interventions start</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                            interventionFlag = 1;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7591c3b7642f808d7757b4388fc407e5">DoInterventionDelaysByAdUnit</a>)&amp;&amp;((t &lt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#af04df618df78b7d8ff0073e8ac043df2">PlaceCloseTimeStart</a>) || (t &gt;= (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].adunit].PlaceCloseTimeStart + <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].adunit].PlaceCloseDuration))))</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                    interventionFlag = 0;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                            <span class="keywordflow">if</span> ((interventionFlag == 1)&amp;&amp;((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4a8d8a2d25046d5d0ed9fb2b36662f43">PlaceCloseByAdminUnit</a>) || (ad &gt; 0)))</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                            {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                <span class="keywordtype">int</span> ad2 = ad / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a0b21a57d159bf47d1ec56130aaf0d8b4">PlaceCloseAdminUnitDivisor</a>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a406a99c4386e01acb83cb6d354f7d6b0">placeclose</a> == 0))</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                    <span class="comment">//if doing intervention delays and durations by admin unit based on global triggers</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7591c3b7642f808d7757b4388fc407e5">DoInterventionDelaysByAdUnit</a>)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2a7b3f14f0df90ff856109140d5a0d23">place_end_time</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7c05904b7bb5f9bbb43888affb443a03">PlaceCloseDelayMean</a> + <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#ac4d6e60578bc69abb234a20fa855f8d2">PlaceCloseDuration</a>));</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2a7b3f14f0df90ff856109140d5a0d23">place_end_time</a> = tspf;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a8753636ae22cdb39e91cdba6bf684e58">place_trig</a> = 0;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a406a99c4386e01acb83cb6d354f7d6b0">placeclose</a> = 2;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j2 = 0; j2 &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">PlaceTypeNum</a>; j2++)</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                        <span class="keywordflow">if</span> (j2 != <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88b64b26117f1b98a472186153441ccd">HotelPlaceType</a>)</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2 = 0; i2 &lt; <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ac6f9a440b22cf1b1efa734b910b51bd0">np</a>[j2]; i2++)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                                <a class="code" href="_update_8cpp.html#a1470b6ba6aca8284f6b40719d45902b7">DoPlaceClose</a>(j2, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].places[j2][i2], ts, tn, 1);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                            }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                        }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                    }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].moverest == 2) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a26b35b71eaf97771dac9a8cdfdbf0817">move_end_time</a>))</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab6b102e46dd3c644eb6394805f6edfc9">DoMoveRestrOnceOnly</a>;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].moverest == 1) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a8e7b5e36c210cfde24379c6374381ca1">move_start_time</a>))</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> = 2;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ad25223e1fe3582d7ab76159ddfcbcc54">move_trig</a> = 0;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a26b35b71eaf97771dac9a8cdfdbf0817">move_end_time</a> = tsmf;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                        f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">MoveRestrCellIncThresh</a>);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                    {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">MoveRestrCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">MoveRestrCellIncThresh</a>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt; trig_thresh);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">MoveRestrCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">MoveRestrCellIncThresh</a>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                    }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                    <span class="keywordflow">if</span> ((t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">MoveRestrTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 0) &amp;&amp; (f2))</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                        <span class="keywordtype">int</span> minx = (b / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        <span class="keywordtype">int</span> miny = (b % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                        <span class="keywordtype">int</span> k = b;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                        <span class="keywordtype">int</span> i, j, l, m;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                        i = j = m = f2 = 0;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                        l = f3 = 1;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                        <span class="keywordflow">if</span> ((!<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aaf4e64edef6775bb360fc8ef16afad92">MoveRestrByAdminUnit</a>) || (ad &gt; 0))</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                        {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                            <span class="keywordtype">int</span> ad2 = ad / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a65c7c3800b86d77c2157a6bdde047ab3">MoveRestrAdminUnitDivisor</a>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                            <span class="keywordflow">do</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                            {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                <span class="keywordflow">if</span> ((minx &gt;= 0) &amp;&amp; (minx &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) &amp;&amp; (miny &gt;= 0) &amp;&amp; (miny &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>))</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#aaf4e64edef6775bb360fc8ef16afad92">MoveRestrByAdminUnit</a>)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                                        f4 = (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a1a1e07bd496a1357073307f0b1ef889d">id</a> / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a65c7c3800b86d77c2157a6bdde047ab3">MoveRestrAdminUnitDivisor</a> == ad2);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                                        f4 = ((r = <a class="code" href="_dist_8cpp.html#a8b3fef89400dcf81129a35658449918a">dist2_mm</a>(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + b, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + k)) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">MoveRestrRadius2</a>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                    <span class="keywordflow">if</span> (f4)</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                                    {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                        f = f2 = 1;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                                        <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> == 0))</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                                        {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a8e7b5e36c210cfde24379c6374381ca1">move_start_time</a> = tsmb;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                            <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">moverest</a> = 1;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                        }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                    }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                <span class="keywordflow">if</span> (j == 0)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                    minx = minx + 1;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 1)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                    miny = miny - 1;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 2)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                    minx = minx - 1;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 3)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                    miny = miny + 1;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                m = (m + 1) % l;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                                <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                                {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                                    j = (j + 1) % 4;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                    i = (i + 1) % 2;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                                    <span class="keywordflow">if</span> (i == 0) l++;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                    <span class="keywordflow">if</span> (j == 1) { f3 = f2; f2 = 0; }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                k = ((minx + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a> + (miny + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                            } <span class="keywordflow">while</span> (f3);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                        }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                        f2 = (global_trig &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">SocDistCellIncStopThresh</a>);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                    {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">SocDistCellIncStopThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">SocDistCellIncStopThresh</a>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &lt; trig_thresh);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                    {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">SocDistCellIncStopThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">SocDistCellIncStopThresh</a>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &lt; trig_thresh);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                    }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                    <span class="keywordflow">if</span> ((t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a92ecd5c72609159927a0b10eeb8a74d1">SocDistTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">socdist</a> == 2) &amp;&amp; ((f2) || (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a9dfaaa87dbe22f95c50cb06a1d290a14">socdist_end_time</a>)))</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">socdist</a> = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a4789df56e479eb465aec22164cc2143d">DoSocDistOnceOnly</a>; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ac84967895e49bccc3cf8f5719875a23e">socdist_trig</a> = 0; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a9dfaaa87dbe22f95c50cb06a1d290a14">socdist_end_time</a> = ts; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                        f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">SocDistCellIncThresh</a>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                    {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">SocDistCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">SocDistCellIncThresh</a>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt;= trig_thresh);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                    {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">SocDistCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">SocDistCellIncThresh</a>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    <span class="keywordflow">if</span> ((t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a92ecd5c72609159927a0b10eeb8a74d1">SocDistTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">socdist</a> == 0) &amp;&amp; (f2))</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                        <span class="comment">//some code to try and deal with intervention delays and durations by admin unit based on global triggers</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                        <span class="keywordtype">int</span> interventionFlag; <span class="comment">//added this as a way to help filter out when interventions start</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                        interventionFlag = 1;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7591c3b7642f808d7757b4388fc407e5">DoInterventionDelaysByAdUnit</a>)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                            <span class="keywordflow">if</span> ((t &lt;= <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].adunit].SocialDistanceTimeStart) ||</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                (t &gt;= (<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#a2f635320f25c676a95e9786b29912ccd">SocialDistanceTimeStart</a> + <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#ad4754463e1616af20db8ac43521487ec">SocialDistanceDuration</a>))) </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                interventionFlag = 0;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                        <span class="keywordflow">if</span> (interventionFlag == 1)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">socdist</a> == 0)) </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                            {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">socdist</a> = 2; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#ac84967895e49bccc3cf8f5719875a23e">socdist_trig</a> = 0; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7591c3b7642f808d7757b4388fc407e5">DoInterventionDelaysByAdUnit</a>)</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a9dfaaa87dbe22f95c50cb06a1d290a14">socdist_end_time</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int) ceil(<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">TimeStepsPerDay</a> * (t + <a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">adunit</a>].<a class="code" href="struct_admin_unit.html#ad4754463e1616af20db8ac43521487ec">SocialDistanceDuration</a>));</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                    <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a9dfaaa87dbe22f95c50cb06a1d290a14">socdist_end_time</a> = tssdf;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                            }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].keyworkerproph == 2) &amp;&amp; (ts &gt;= <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a148de9e1ba30dd42ff468c67b39190b7">keyworkerproph_end_time</a>))</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                    {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                        f = 1;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a7e5edb04511aaf97388e606e2c12eb89">keyworkerproph</a> = <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a88ac88140703af27c83b293df1b8954e">DoKeyWorkerProphOnceOnly</a>;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">DoGlobalTriggers</a>)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                        f2 = (global_trig &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">KeyWorkerProphCellIncThresh</a>);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">DoAdminTriggers</a>)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                    {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a>[adi].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">KeyWorkerProphCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">KeyWorkerProphCellIncThresh</a>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">trigDC_adunit</a>[adi] &gt; trig_thresh);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                    {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        <span class="keywordtype">int</span> trig_thresh = (<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">DoPerCapitaTriggers</a>) ? ((<span class="keywordtype">int</span>)ceil(((<span class="keywordtype">double</span>)(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].n * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">KeyWorkerProphCellIncThresh</a>)) / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">IncThreshPop</a>)) : <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">KeyWorkerProphCellIncThresh</a>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                        f2 = (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].<a class="code" href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">treat_trig</a> &gt;= trig_thresh);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                    }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">DoPlaces</a>) &amp;&amp; (t &gt;= <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a5da47f23a0ec1625b5db97741751fe16">KeyWorkerProphTimeStart</a>) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[b].keyworkerproph == 0) &amp;&amp; (f2))</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                        <span class="keywordtype">int</span> minx = (b / <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                        <span class="keywordtype">int</span> miny = (b % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                        <span class="keywordtype">int</span> k = b;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                        <span class="keywordtype">int</span> i, j, l, m;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                        i = j = m = f2 = 0;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                        l = f3 = 1;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                        <span class="keywordflow">do</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                        {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                            <span class="keywordflow">if</span> ((minx &gt;= 0) &amp;&amp; (minx &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) &amp;&amp; (miny &gt;= 0) &amp;&amp; (miny &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>))</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="_dist_8cpp.html#a8b3fef89400dcf81129a35658449918a">dist2_mm</a>(<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + b, <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a> + k) &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#a42dd86e207fb2d3ca60e516d36ed1eef">KeyWorkerProphRadius2</a>)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                    f = f2 = 1;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                    <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].n &gt; 0) &amp;&amp; (<a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a7e5edb04511aaf97388e606e2c12eb89">keyworkerproph</a> == 0))</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                    {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a7e5edb04511aaf97388e606e2c12eb89">keyworkerproph</a> = 2;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a4b1ea1bc07671f4492cad5c0b600dad2">keyworkerproph_trig</a> = 0;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                        <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a148de9e1ba30dd42ff468c67b39190b7">keyworkerproph_end_time</a> = tskwpf;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2 = 0; i2 &lt; <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a99c178515a8b99d24ad28b249ee2b3ca">n</a>; i2++)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                        {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                            <span class="keywordtype">int</span> j2 = <a class="code" href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a>[k].<a class="code" href="struct_microcell.html#a1ba5ca77bb4bbb4b2dacd794e217b1d4">members</a>[i2];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                            <span class="keywordflow">if</span> ((<a class="code" href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a>[j2].keyworker) &amp;&amp; (!<a class="code" href="_model_macros_8h.html#a021c0d276055369d1583da0064dcc251">HOST_TO_BE_TREATED</a>(j2)))</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                                <a class="code" href="_update_8cpp.html#a9d8307b46ce56c14df0d4ef92b0f8e8b">DoProphNoDelay</a>(j2, ts, tn, nckwp);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                                        }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                            <span class="keywordflow">if</span> (j == 0)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                                minx = minx + 1;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 1)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                miny = miny - 1;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 2)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                                minx = minx - 1;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == 3)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                miny = miny + 1;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                            m = (m + 1) % l;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                            <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                            {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                j = (j + 1) % 4;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                                i = (i + 1) % 2;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                                <span class="keywordflow">if</span> (i == 0) l++;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                <span class="keywordflow">if</span> (j == 1) { f3 = f2; f2 = 0; }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                            }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                            k = ((minx + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">nmcw</a>) * <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a> + (miny + <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>) % <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">nmch</a>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                        } <span class="keywordflow">while</span> (f3);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                    }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a>.<a class="code" href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">NumThreads</a>; i++)</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a287d26e2171dfba7fb548c4b76181512">cumT</a> += <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a287d26e2171dfba7fb548c4b76181512">cumT</a>;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a1da8d62bb9d92107661145add338d050">cumTP</a> += <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a1da8d62bb9d92107661145add338d050">cumTP</a>;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a>.<a class="code" href="struct_pop_var.html#a5d121b65abf83c4a8b5cac67d44cf985">cumUT</a> += <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a5d121b65abf83c4a8b5cac67d44cf985">cumUT</a>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            <span class="comment">//State.cumV+=StateT[i].cumV;</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a287d26e2171dfba7fb548c4b76181512">cumT</a> = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a5d121b65abf83c4a8b5cac67d44cf985">cumUT</a> = <a class="code" href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a>[i].<a class="code" href="struct_pop_var.html#a1da8d62bb9d92107661145add338d050">cumTP</a> = 0; <span class="comment">//StateT[i].cumV=0;</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    f += f1;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">return</span> (f &gt; 0);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astruct_param_html_a7f52553884bccc1272ac357fe2c02174"><div class="ttname"><a href="struct_param.html#a7f52553884bccc1272ac357fe2c02174">Param::Seasonality</a></div><div class="ttdeci">double Seasonality[DAYS_PER_YEAR]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00095">Param.h:95</a></div></div>
<div class="ttc" id="astruct_infection_html_a456a098a6fbc8de2f6572a7d596e936a"><div class="ttname"><a href="struct_infection.html#a456a098a6fbc8de2f6572a7d596e936a">Infection::infect_type</a></div><div class="ttdeci">short int infect_type</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00075">Model.h:75</a></div></div>
<div class="ttc" id="astruct_microcell_html_a76e7d855b7e7ca6c4df1a0890432bbc2"><div class="ttname"><a href="struct_microcell.html#a76e7d855b7e7ca6c4df1a0890432bbc2">Microcell::vacc</a></div><div class="ttdeci">unsigned short int vacc</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00279">Model.h:279</a></div></div>
<div class="ttc" id="astruct_param_html_a0031fee22c1984883e57ced8e6d33f57"><div class="ttname"><a href="struct_param.html#a0031fee22c1984883e57ced8e6d33f57">Param::VaccRadius2</a></div><div class="ttdeci">double VaccRadius2</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00138">Param.h:138</a></div></div>
<div class="ttc" id="astruct_microcell_html_a3956a2ea7334b2dec1602353a12dcb72"><div class="ttname"><a href="struct_microcell.html#a3956a2ea7334b2dec1602353a12dcb72">Microcell::adunit</a></div><div class="ttdeci">int adunit</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00270">Model.h:270</a></div></div>
<div class="ttc" id="astruct_microcell_html_a02f7da552a03d5fdc2de771cdbe14458"><div class="ttname"><a href="struct_microcell.html#a02f7da552a03d5fdc2de771cdbe14458">Microcell::treat_end_time</a></div><div class="ttdeci">unsigned short int treat_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00280">Model.h:280</a></div></div>
<div class="ttc" id="astruct_cell_html_a0dd64882e5517cf0d96193b6bf73e266"><div class="ttname"><a href="struct_cell.html#a0dd64882e5517cf0d96193b6bf73e266">Cell::tot_prob</a></div><div class="ttdeci">float tot_prob</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00297">Model.h:297</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_a3a714c62adfead7dcf6405954d8dd4da"><div class="ttname"><a href="_sweep_8cpp.html#a3a714c62adfead7dcf6405954d8dd4da">InfectSweep</a></div><div class="ttdeci">void InfectSweep(double t, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l00271">Sweep.cpp:271</a></div></div>
<div class="ttc" id="a_inf_stat_8h_html_ad72234c285de2e11997598044ae01389af18935e7be228c4f9223257c1408b6ec"><div class="ttname"><a href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389af18935e7be228c4f9223257c1408b6ec">InfStat_Case</a></div><div class="ttdeci">@ InfStat_Case</div><div class="ttdef"><b>Definition:</b> <a href="_inf_stat_8h_source.html#l00010">InfStat.h:10</a></div></div>
<div class="ttc" id="a_inf_stat_8h_html_ad72234c285de2e11997598044ae01389a6c452d71d18dec957dca34bcfe2e3b08"><div class="ttname"><a href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6c452d71d18dec957dca34bcfe2e3b08">InfStat_Dead</a></div><div class="ttdeci">@ InfStat_Dead</div><div class="ttdef"><b>Definition:</b> <a href="_inf_stat_8h_source.html#l00018">InfStat.h:17</a></div></div>
<div class="ttc" id="astruct_cell_html_a04465e2d15876175ee2204a3de978173"><div class="ttname"><a href="struct_cell.html#a04465e2d15876175ee2204a3de978173">Cell::I</a></div><div class="ttdeci">int I</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00294">Model.h:294</a></div></div>
<div class="ttc" id="astruct_microcell_html_ae32a174baccdeda1ca247253b40a0648"><div class="ttname"><a href="struct_microcell.html#ae32a174baccdeda1ca247253b40a0648">Microcell::vacc_trig</a></div><div class="ttdeci">unsigned short int vacc_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00279">Model.h:279</a></div></div>
<div class="ttc" id="astruct_param_html_ad2d1297af959f839b39f29ba9661230b"><div class="ttname"><a href="struct_param.html#ad2d1297af959f839b39f29ba9661230b">Param::PlaceCloseCellIncStopThresh</a></div><div class="ttdeci">int PlaceCloseCellIncStopThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00233">Param.h:233</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a84ca4cb21b622f11b7e84e177a02e54b"><div class="ttname"><a href="_update_8cpp.html#a84ca4cb21b622f11b7e84e177a02e54b">DoVacc</a></div><div class="ttdeci">int DoVacc(int ai, unsigned short int ts)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01258">Update.cpp:1258</a></div></div>
<div class="ttc" id="astruct_param_html_ae2b71620f3ff6825b76eaa1bb0f7daef"><div class="ttname"><a href="struct_param.html#ae2b71620f3ff6825b76eaa1bb0f7daef">Param::VaccTimeStartGeo</a></div><div class="ttdeci">double VaccTimeStartGeo</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00137">Param.h:137</a></div></div>
<div class="ttc" id="a_dist_8cpp_html_ac55af114ace27410d66a47b0e252c6a3"><div class="ttname"><a href="_dist_8cpp.html#ac55af114ace27410d66a47b0e252c6a3">dist2</a></div><div class="ttdeci">double dist2(Person *a, Person *b)</div><div class="ttdef"><b>Definition:</b> <a href="_dist_8cpp_source.html#l00040">Dist.cpp:40</a></div></div>
<div class="ttc" id="a_error_8h_html"><div class="ttname"><a href="_error_8h.html">Error.h</a></div></div>
<div class="ttc" id="astruct_person_html_ad18abe0f8aab8c1408d0909057dafcc7"><div class="ttname"><a href="struct_person.html#ad18abe0f8aab8c1408d0909057dafcc7">Person::absent_stop_time</a></div><div class="ttdeci">unsigned short int absent_stop_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00042">Model.h:42</a></div></div>
<div class="ttc" id="astruct_param_html_ab6ec0ea65cc2e546d9f19458f6cd7273"><div class="ttname"><a href="struct_param.html#ab6ec0ea65cc2e546d9f19458f6cd7273">Param::VaccMinRadius2</a></div><div class="ttdeci">double VaccMinRadius2</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00138">Param.h:138</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a1da8d62bb9d92107661145add338d050"><div class="ttname"><a href="struct_pop_var.html#a1da8d62bb9d92107661145add338d050">PopVar::cumTP</a></div><div class="ttdeci">double cumTP</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00114">Model.h:114</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a33acdf9847a2f4264bbfcb872837db31"><div class="ttname"><a href="_update_8cpp.html#a33acdf9847a2f4264bbfcb872837db31">DoRecover</a></div><div class="ttdeci">void DoRecover(int ai, int tn, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00891">Update.cpp:891</a></div></div>
<div class="ttc" id="astruct_param_html_ae4a3942448ad4c1bce842947bf871529"><div class="ttname"><a href="struct_param.html#ae4a3942448ad4c1bce842947bf871529">Param::SocDistCellIncStopThresh</a></div><div class="ttdeci">int SocDistCellIncStopThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00233">Param.h:233</a></div></div>
<div class="ttc" id="astruct_person_html_a2c8401e8d30a8132be645bad3c0b7b8a"><div class="ttname"><a href="struct_person.html#a2c8401e8d30a8132be645bad3c0b7b8a">Person::Critical_time</a></div><div class="ttdeci">unsigned short int Critical_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00046">Model.h:46</a></div></div>
<div class="ttc" id="astruct_param_html_aa43fdec6bbe58538d4e1444ffdbabcd2"><div class="ttname"><a href="struct_param.html#aa43fdec6bbe58538d4e1444ffdbabcd2">Param::TreatByAdminUnit</a></div><div class="ttdeci">int TreatByAdminUnit</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a6b03f98bdaaa1b8e6cc4fd63e65d501c"><div class="ttname"><a href="_update_8cpp.html#a6b03f98bdaaa1b8e6cc4fd63e65d501c">DoInfect</a></div><div class="ttdeci">void DoInfect(int ai, double t, int tn, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00071">Update.cpp:71</a></div></div>
<div class="ttc" id="astruct_microcell_html_a1d66e5c0f9987721138048b8112281ea"><div class="ttname"><a href="struct_microcell.html#a1d66e5c0f9987721138048b8112281ea">Microcell::moverest</a></div><div class="ttdeci">unsigned short int moverest</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a3f7b18b0ec234dd1c7a48f9deb0f461b"><div class="ttname"><a href="struct_pop_var.html#a3f7b18b0ec234dd1c7a48f9deb0f461b">PopVar::ndct_queue</a></div><div class="ttdeci">int ndct_queue[MAX_ADUNITS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00120">Model.h:120</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a92a5b672baf0a5f74e491a1a950bf528"><div class="ttname"><a href="_covid_sim_8cpp.html#a92a5b672baf0a5f74e491a1a950bf528">Places</a></div><div class="ttdeci">Place ** Places</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00074">CovidSim.cpp:74</a></div></div>
<div class="ttc" id="astruct_param_html_a1f86136f3922ad5036de974477d5b139"><div class="ttname"><a href="struct_param.html#a1f86136f3922ad5036de974477d5b139">Param::DoAdUnits</a></div><div class="ttdeci">int DoAdUnits</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00042">Param.h:42</a></div></div>
<div class="ttc" id="astruct_param_html_a30a055a2215f414b0ec45c0e8ec6a0ed"><div class="ttname"><a href="struct_param.html#a30a055a2215f414b0ec45c0e8ec6a0ed">Param::SpecificityDCT</a></div><div class="ttdeci">double SpecificityDCT</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00252">Param.h:252</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a3cffda1cc52ead76b63ff74482c19c60"><div class="ttname"><a href="struct_pop_var.html#a3cffda1cc52ead76b63ff74482c19c60">PopVar::cell_inf</a></div><div class="ttdeci">float * cell_inf</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00113">Model.h:113</a></div></div>
<div class="ttc" id="astruct_param_html_adf1220b1b043d4e6101fb4bde7715a29"><div class="ttname"><a href="struct_param.html#adf1220b1b043d4e6101fb4bde7715a29">Param::PlaceTypePropBetweenGroupLinks</a></div><div class="ttdeci">double PlaceTypePropBetweenGroupLinks[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00119">Param.h:119</a></div></div>
<div class="ttc" id="astruct_microcell_html_a99c178515a8b99d24ad28b249ee2b3ca"><div class="ttname"><a href="struct_microcell.html#a99c178515a8b99d24ad28b249ee2b3ca">Microcell::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00270">Model.h:270</a></div></div>
<div class="ttc" id="astruct_param_html_ab92cd9fefb411b364459839da4c2b193"><div class="ttname"><a href="struct_param.html#ab92cd9fefb411b364459839da4c2b193">Param::nmcw</a></div><div class="ttdeci">int nmcw</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00041">Param.h:41</a></div></div>
<div class="ttc" id="astruct_household_html_aee2f46f2407ae6d241b0e99814f25a57"><div class="ttname"><a href="struct_household.html#aee2f46f2407ae6d241b0e99814f25a57">Household::FirstPerson</a></div><div class="ttdeci">int FirstPerson</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00058">Model.h:58</a></div></div>
<div class="ttc" id="astruct_household_html_ae5b70863f9dee9092d36d8cab6903304"><div class="ttname"><a href="struct_household.html#ae5b70863f9dee9092d36d8cab6903304">Household::loc_x</a></div><div class="ttdeci">float loc_x</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00060">Model.h:60</a></div></div>
<div class="ttc" id="astruct_param_html_a2e29c19ad6b269b17068bee55d2bcfe3"><div class="ttname"><a href="struct_param.html#a2e29c19ad6b269b17068bee55d2bcfe3">Param::DoPlaceGroupTreat</a></div><div class="ttdeci">int DoPlaceGroupTreat</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00052">Param.h:52</a></div></div>
<div class="ttc" id="a_model_macros_8h_html_aa5a6525c77db4abd9464ac6a40adaf52"><div class="ttname"><a href="_model_macros_8h.html#aa5a6525c77db4abd9464ac6a40adaf52">HOST_AGE_GROUP</a></div><div class="ttdeci">#define HOST_AGE_GROUP(x)</div><div class="ttdef"><b>Definition:</b> <a href="_model_macros_8h_source.html#l00024">ModelMacros.h:23</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_aea7b679b747b46a33b3de7ef671ccd10"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#aea7b679b747b46a33b3de7ef671ccd10">CalcSpatialSusc</a></div><div class="ttdeci">double CalcSpatialSusc(int ai, unsigned short int ts, int infector, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00058">CalcInfSusc.cpp:58</a></div></div>
<div class="ttc" id="astruct_microcell_html_a4b1ea1bc07671f4492cad5c0b600dad2"><div class="ttname"><a href="struct_microcell.html#a4b1ea1bc07671f4492cad5c0b600dad2">Microcell::keyworkerproph_trig</a></div><div class="ttdeci">unsigned short int keyworkerproph_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="astruct_param_html_a41683da594b991375fed5e1f47e5fddc"><div class="ttname"><a href="struct_param.html#a41683da594b991375fed5e1f47e5fddc">Param::DoGlobalTriggers</a></div><div class="ttdeci">int DoGlobalTriggers</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00230">Param.h:230</a></div></div>
<div class="ttc" id="astruct_param_html_a1fa4ff61a75ed6441f0e46e57feb25d0"><div class="ttname"><a href="struct_param.html#a1fa4ff61a75ed6441f0e46e57feb25d0">Param::HouseholdTrans</a></div><div class="ttdeci">double HouseholdTrans</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00110">Param.h:110</a></div></div>
<div class="ttc" id="astruct_airport_html_a5ca6fd8bf55eafbd2e07c7abffe7c68d"><div class="ttname"><a href="struct_airport.html#a5ca6fd8bf55eafbd2e07c7abffe7c68d">Airport::num_mcell</a></div><div class="ttdeci">int num_mcell</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00251">Model.h:251</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a3aa028c1b90c4900793024759dbc7bde"><div class="ttname"><a href="_update_8cpp.html#a3aa028c1b90c4900793024759dbc7bde">DoRecoveringFromCritical</a></div><div class="ttdeci">void DoRecoveringFromCritical(int ai, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00306">Update.cpp:306</a></div></div>
<div class="ttc" id="astruct_param_html_a0f9acd8c89fe4f36adfcb3711e3dcfd3"><div class="ttname"><a href="struct_param.html#a0f9acd8c89fe4f36adfcb3711e3dcfd3">Param::PopSize</a></div><div class="ttdeci">int PopSize</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00020">Param.h:20</a></div></div>
<div class="ttc" id="astruct_param_html_a4789df56e479eb465aec22164cc2143d"><div class="ttname"><a href="struct_param.html#a4789df56e479eb465aec22164cc2143d">Param::DoSocDistOnceOnly</a></div><div class="ttdeci">int DoSocDistOnceOnly</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00236">Param.h:236</a></div></div>
<div class="ttc" id="astruct_param_html_ac51894eda72b949bd3223e345d87f7dc"><div class="ttname"><a href="struct_param.html#ac51894eda72b949bd3223e345d87f7dc">Param::DoAirports</a></div><div class="ttdeci">int DoAirports</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00057">Param.h:57</a></div></div>
<div class="ttc" id="astruct_param_html_ae0c92fe1c273cbeaa88b6e59f372b081"><div class="ttname"><a href="struct_param.html#ae0c92fe1c273cbeaa88b6e59f372b081">Param::FindContactsOfDCTContacts</a></div><div class="ttdeci">int FindContactsOfDCTContacts</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00250">Param.h:250</a></div></div>
<div class="ttc" id="astruct_microcell_html_aeab9263f6b0608f3d6168372d132371a"><div class="ttname"><a href="struct_microcell.html#aeab9263f6b0608f3d6168372d132371a">Microcell::socdist</a></div><div class="ttdeci">unsigned short int socdist</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="astruct_param_html_a5ad35770a4723d3ed5fa675e3d891963"><div class="ttname"><a href="struct_param.html#a5ad35770a4723d3ed5fa675e3d891963">Param::GlobalIncThreshPop</a></div><div class="ttdeci">int GlobalIncThreshPop</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00055">Param.h:55</a></div></div>
<div class="ttc" id="astruct_person_html_a2861b921f91d27644c211a8b49d79290"><div class="ttname"><a href="struct_person.html#a2861b921f91d27644c211a8b49d79290">Person::pcell</a></div><div class="ttdeci">int pcell</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00017">Model.h:17</a></div></div>
<div class="ttc" id="astruct_person_html_a8d3b6763f2b3c6697dbd874384dee1bd"><div class="ttname"><a href="struct_person.html#a8d3b6763f2b3c6697dbd874384dee1bd">Person::absent_start_time</a></div><div class="ttdeci">unsigned short int absent_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00042">Model.h:42</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a287d26e2171dfba7fb548c4b76181512"><div class="ttname"><a href="struct_pop_var.html#a287d26e2171dfba7fb548c4b76181512">PopVar::cumT</a></div><div class="ttdeci">double cumT</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00114">Model.h:114</a></div></div>
<div class="ttc" id="astruct_place_html_aa4b9554d949b7b64e0f3c138ed01246d"><div class="ttname"><a href="struct_place.html#aa4b9554d949b7b64e0f3c138ed01246d">Place::mcell</a></div><div class="ttdeci">int mcell</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00313">Model.h:313</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_ab05d32d997e85daf056cb71e256c242a"><div class="ttname"><a href="struct_admin_unit.html#ab05d32d997e85daf056cb71e256c242a">AdminUnit::dct</a></div><div class="ttdeci">int * dct</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00350">Model.h:350</a></div></div>
<div class="ttc" id="a_dist_8cpp_html_a8b3fef89400dcf81129a35658449918a"><div class="ttname"><a href="_dist_8cpp.html#a8b3fef89400dcf81129a35658449918a">dist2_mm</a></div><div class="ttdeci">double dist2_mm(Microcell *a, Microcell *b)</div><div class="ttdef"><b>Definition:</b> <a href="_dist_8cpp_source.html#l00151">Dist.cpp:151</a></div></div>
<div class="ttc" id="astruct_param_html_a8b481f3bb34ae62a4c6540ebde7a1bdb"><div class="ttname"><a href="struct_param.html#a8b481f3bb34ae62a4c6540ebde7a1bdb">Param::AirportCloseEffectiveness</a></div><div class="ttdeci">double AirportCloseEffectiveness</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00144">Param.h:144</a></div></div>
<div class="ttc" id="astruct_person_html_a0abb2d4d920b239d0bc6dbb7ec9c1dbf"><div class="ttname"><a href="struct_person.html#a0abb2d4d920b239d0bc6dbb7ec9c1dbf">Person::dct_test_time</a></div><div class="ttdeci">unsigned short int dct_test_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00051">Model.h:51</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a1331e2a748745d26884940c9de881aff"><div class="ttname"><a href="_update_8cpp.html#a1331e2a748745d26884940c9de881aff">DoVaccNoDelay</a></div><div class="ttdeci">void DoVaccNoDelay(int ai, unsigned short int ts)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01297">Update.cpp:1297</a></div></div>
<div class="ttc" id="a_dist_8h_html"><div class="ttname"><a href="_dist_8h.html">Dist.h</a></div></div>
<div class="ttc" id="astruct_param_html_a68fd9a615d061eb086207783831d92c3"><div class="ttname"><a href="struct_param.html#a68fd9a615d061eb086207783831d92c3">Param::VaccByAdminUnit</a></div><div class="ttdeci">int VaccByAdminUnit</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="a_model_macros_8h_html_a021c0d276055369d1583da0064dcc251"><div class="ttname"><a href="_model_macros_8h.html#a021c0d276055369d1583da0064dcc251">HOST_TO_BE_TREATED</a></div><div class="ttdeci">#define HOST_TO_BE_TREATED(x)</div><div class="ttdef"><b>Definition:</b> <a href="_model_macros_8h_source.html#l00008">ModelMacros.h:7</a></div></div>
<div class="ttc" id="astruct_person_html_a874b8dd1c3b95c17690333ae0354c6de"><div class="ttname"><a href="struct_person.html#a874b8dd1c3b95c17690333ae0354c6de">Person::mcell</a></div><div class="ttdeci">int mcell</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00018">Model.h:18</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a5cabe0ec3092de90e7745dd64c6c554a"><div class="ttname"><a href="_covid_sim_8cpp.html#a5cabe0ec3092de90e7745dd64c6c554a">Cells</a></div><div class="ttdeci">Cell * Cells</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00071">CovidSim.cpp:71</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_a9f2ca854cd8d4c94a239b34bfdc5f2f3"><div class="ttname"><a href="struct_admin_unit.html#a9f2ca854cd8d4c94a239b34bfdc5f2f3">AdminUnit::NP</a></div><div class="ttdeci">int NP</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00344">Model.h:344</a></div></div>
<div class="ttc" id="astruct_param_html_a59f96e149e0cccc67ae29575dff1ff3f"><div class="ttname"><a href="struct_param.html#a59f96e149e0cccc67ae29575dff1ff3f">Param::HolidayDuration</a></div><div class="ttdeci">double HolidayDuration[DAYS_PER_YEAR]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00129">Param.h:129</a></div></div>
<div class="ttc" id="astruct_person_html_aadec0fd0b4b5ff8fe9116364ca5889b5"><div class="ttname"><a href="struct_person.html#aadec0fd0b4b5ff8fe9116364ca5889b5">Person::detected_time</a></div><div class="ttdeci">unsigned short int detected_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00041">Model.h:41</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a76929d058f3fa484389494f189b756cc"><div class="ttname"><a href="struct_pop_var.html#a76929d058f3fa484389494f189b756cc">PopVar::dct_queue</a></div><div class="ttdeci">ContactEvent * dct_queue[MAX_ADUNITS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00119">Model.h:119</a></div></div>
<div class="ttc" id="a_rand_8cpp_html_aa262f1a4a0bf83c91c3614c57fc46521"><div class="ttname"><a href="_rand_8cpp.html#aa262f1a4a0bf83c91c3614c57fc46521">SampleWithoutReplacement</a></div><div class="ttdeci">void SampleWithoutReplacement(int tn, int k, int n)</div><div class="ttdef"><b>Definition:</b> <a href="_rand_8cpp_source.html#l01671">Rand.cpp:1671</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8h_html"><div class="ttname"><a href="_calc_inf_susc_8h.html">CalcInfSusc.h</a></div></div>
<div class="ttc" id="astruct_microcell_html_ac6f9a440b22cf1b1efa734b910b51bd0"><div class="ttname"><a href="struct_microcell.html#ac6f9a440b22cf1b1efa734b910b51bd0">Microcell::np</a></div><div class="ttdeci">unsigned short int np[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00275">Model.h:275</a></div></div>
<div class="ttc" id="astruct_household_html_af81508b2a7848a3f6708c0d26cdcca3c"><div class="ttname"><a href="struct_household.html#af81508b2a7848a3f6708c0d26cdcca3c">Household::nh</a></div><div class="ttdeci">unsigned short int nh</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00059">Model.h:59</a></div></div>
<div class="ttc" id="astruct_param_html_a629f6addd16f0c80a08be59b77e9a0c3"><div class="ttname"><a href="struct_param.html#a629f6addd16f0c80a08be59b77e9a0c3">Param::PreControlClusterIdHolOffset</a></div><div class="ttdeci">double PreControlClusterIdHolOffset</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00228">Param.h:228</a></div></div>
<div class="ttc" id="astruct_param_html_a7c05904b7bb5f9bbb43888affb443a03"><div class="ttname"><a href="struct_param.html#a7c05904b7bb5f9bbb43888affb443a03">Param::PlaceCloseDelayMean</a></div><div class="ttdeci">double PlaceCloseDelayMean</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00125">Param.h:125</a></div></div>
<div class="ttc" id="astruct_person_html_aa147cda0a20086a21f2865233e2d3c99"><div class="ttname"><a href="struct_person.html#aa147cda0a20086a21f2865233e2d3c99">Person::ncontacts</a></div><div class="ttdeci">int ncontacts</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00052">Model.h:52</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a6354d7f0e2d67eb13ce3159e8a9701d7"><div class="ttname"><a href="struct_pop_var.html#a6354d7f0e2d67eb13ce3159e8a9701d7">PopVar::cumDCT</a></div><div class="ttdeci">int cumDCT</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00100">Model.h:100</a></div></div>
<div class="ttc" id="astruct_person_html_aa14ef8eba97259db09b465f86193b2ae"><div class="ttname"><a href="struct_person.html#aa14ef8eba97259db09b465f86193b2ae">Person::dct_start_time</a></div><div class="ttdeci">unsigned short int dct_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00051">Model.h:51</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_a9943b56a8e9cbd84a7fe0018f4c47668"><div class="ttname"><a href="struct_admin_unit.html#a9943b56a8e9cbd84a7fe0018f4c47668">AdminUnit::place_close_trig</a></div><div class="ttdeci">int place_close_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00344">Model.h:344</a></div></div>
<div class="ttc" id="astruct_param_html_af508a7dc1a0e110b927368cfd9c71ec2"><div class="ttname"><a href="struct_param.html#af508a7dc1a0e110b927368cfd9c71ec2">Param::MoveRestrCellIncThresh</a></div><div class="ttdeci">int MoveRestrCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00230">Param.h:230</a></div></div>
<div class="ttc" id="astruct_airport_html_a90a7181b70fc503ee85200940c407395"><div class="ttname"><a href="struct_airport.html#a90a7181b70fc503ee85200940c407395">Airport::DestPlaces</a></div><div class="ttdeci">IndexList * DestPlaces</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00255">Model.h:255</a></div></div>
<div class="ttc" id="astruct_microcell_html_a0878ef2d22c2fd665e42c3ebae2ca92a"><div class="ttname"><a href="struct_microcell.html#a0878ef2d22c2fd665e42c3ebae2ca92a">Microcell::treat</a></div><div class="ttdeci">unsigned short int treat</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00279">Model.h:279</a></div></div>
<div class="ttc" id="astruct_param_html_a7e241b907515360ef68a6ea173a988a4"><div class="ttname"><a href="struct_param.html#a7e241b907515360ef68a6ea173a988a4">Param::KeyWorkerProphCellIncThresh</a></div><div class="ttdeci">int KeyWorkerProphCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00239">Param.h:239</a></div></div>
<div class="ttc" id="astruct_param_html_a46a888930a1549e261168759c3651f4c"><div class="ttname"><a href="struct_param.html#a46a888930a1549e261168759c3651f4c">Param::NCP</a></div><div class="ttdeci">int NCP</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00040">Param.h:40</a></div></div>
<div class="ttc" id="a_constants_8h_html_ac4180c3877e209bb6f803e32cefeafaf"><div class="ttname"><a href="_constants_8h.html#ac4180c3877e209bb6f803e32cefeafaf">DAYS_PER_YEAR</a></div><div class="ttdeci">const int DAYS_PER_YEAR</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8h_source.html#l00075">Constants.h:75</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_a444b3eac8bea247f096788fc6fafbc4e"><div class="ttname"><a href="_sweep_8cpp.html#a444b3eac8bea247f096788fc6fafbc4e">IncubRecoverySweep</a></div><div class="ttdeci">void IncubRecoverySweep(double t, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l00724">Sweep.cpp:724</a></div></div>
<div class="ttc" id="astruct_param_html_a2ca1db01e28e2bbc8e0ff08ca57527ad"><div class="ttname"><a href="struct_param.html#a2ca1db01e28e2bbc8e0ff08ca57527ad">Param::TimeStepsPerDay</a></div><div class="ttdeci">double TimeStepsPerDay</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00066">Param.h:66</a></div></div>
<div class="ttc" id="a_model_macros_8h_html_ae5e3b8fc412a10167255a8928f2e25ef"><div class="ttname"><a href="_model_macros_8h.html#ae5e3b8fc412a10167255a8928f2e25ef">PLACE_TREATED</a></div><div class="ttdeci">#define PLACE_TREATED(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="_model_macros_8h_source.html#l00009">ModelMacros.h:8</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a4203ecbf10830311175115a8443e454b"><div class="ttname"><a href="_update_8cpp.html#a4203ecbf10830311175115a8443e454b">DoProph</a></div><div class="ttdeci">void DoProph(int ai, unsigned short int ts, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01016">Update.cpp:1016</a></div></div>
<div class="ttc" id="a_rand_8cpp_html_a5efb4220d658f7dd6056a98264616d4f"><div class="ttname"><a href="_rand_8cpp.html#a5efb4220d658f7dd6056a98264616d4f">ignbin_mt</a></div><div class="ttdeci">long ignbin_mt(long n, double pp, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_rand_8cpp_source.html#l00905">Rand.cpp:905</a></div></div>
<div class="ttc" id="astruct_person_html_aadb96c4bf6dca9b258f446474b6a68cd"><div class="ttname"><a href="struct_person.html#aadb96c4bf6dca9b258f446474b6a68cd">Person::recovery_or_death_time</a></div><div class="ttdeci">unsigned short int recovery_or_death_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00045">Model.h:45</a></div></div>
<div class="ttc" id="astruct_contact_event_html_a8521433d4a8ecc23ea758a09746b5f04"><div class="ttname"><a href="struct_contact_event.html#a8521433d4a8ecc23ea758a09746b5f04">ContactEvent::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00087">Model.h:87</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a128b6a9891d460553b39adfd284cfa3f"><div class="ttname"><a href="struct_pop_var.html#a128b6a9891d460553b39adfd284cfa3f">PopVar::inf_queue</a></div><div class="ttdeci">Infection * inf_queue[MAX_NUM_THREADS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00109">Model.h:109</a></div></div>
<div class="ttc" id="astruct_param_html_a9a0d052e2d5762a33b1daf84095aa85d"><div class="ttname"><a href="struct_param.html#a9a0d052e2d5762a33b1daf84095aa85d">Param::cheight</a></div><div class="ttdeci">double cheight</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00087">Param.h:87</a></div></div>
<div class="ttc" id="astruct_param_html_abcd949752816ce736253fe37cecd5190"><div class="ttname"><a href="struct_param.html#abcd949752816ce736253fe37cecd5190">Param::Nairports</a></div><div class="ttdeci">int Nairports</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00057">Param.h:57</a></div></div>
<div class="ttc" id="astruct_param_html_af4d908cf2d7ee3dce743983a56dcdd9d"><div class="ttname"><a href="struct_param.html#af4d908cf2d7ee3dce743983a56dcdd9d">Param::SocDistDurationCurrent</a></div><div class="ttdeci">double SocDistDurationCurrent</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00159">Param.h:159</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_ae637ea5a64035961eaf05bf25e845fa8"><div class="ttname"><a href="_sweep_8cpp.html#ae637ea5a64035961eaf05bf25e845fa8">TravelDepartSweep</a></div><div class="ttdeci">void TravelDepartSweep(double t)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l00071">Sweep.cpp:71</a></div></div>
<div class="ttc" id="astruct_param_html_a42dd86e207fb2d3ca60e516d36ed1eef"><div class="ttname"><a href="struct_param.html#a42dd86e207fb2d3ca60e516d36ed1eef">Param::KeyWorkerProphRadius2</a></div><div class="ttdeci">double KeyWorkerProphRadius2</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00223">Param.h:223</a></div></div>
<div class="ttc" id="astruct_pop_var_html_ac19f094e2c6d80c442ba2dee0675d217"><div class="ttname"><a href="struct_pop_var.html#ac19f094e2c6d80c442ba2dee0675d217">PopVar::mvacc_cum</a></div><div class="ttdeci">int mvacc_cum</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00112">Model.h:112</a></div></div>
<div class="ttc" id="astruct_param_html_a7328b90f5f8e56ad824ced77b6d62303"><div class="ttname"><a href="struct_param.html#a7328b90f5f8e56ad824ced77b6d62303">Param::MoveRestrDuration</a></div><div class="ttdeci">double MoveRestrDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00143">Param.h:143</a></div></div>
<div class="ttc" id="astruct_microcell_html"><div class="ttname"><a href="struct_microcell.html">Microcell</a></div><div class="ttdoc">The basic unit of the simulation and is associated to a geographical location.</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00265">Model.h:266</a></div></div>
<div class="ttc" id="astruct_param_html_acb82b4c2a97ca9a4a81543ca88061176"><div class="ttname"><a href="struct_param.html#acb82b4c2a97ca9a4a81543ca88061176">Param::MoveDelayMean</a></div><div class="ttdeci">double MoveDelayMean</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00143">Param.h:143</a></div></div>
<div class="ttc" id="astruct_microcell_html_ad25223e1fe3582d7ab76159ddfcbcc54"><div class="ttname"><a href="struct_microcell.html#ad25223e1fe3582d7ab76159ddfcbcc54">Microcell::move_trig</a></div><div class="ttdeci">unsigned short int move_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="a_dist_8cpp_html_aecee392689ca1b9464ac08f79ac2e0d5"><div class="ttname"><a href="_dist_8cpp.html#aecee392689ca1b9464ac08f79ac2e0d5">dist2_raw</a></div><div class="ttdeci">double dist2_raw(double ax, double ay, double bx, double by)</div><div class="ttdef"><b>Definition:</b> <a href="_dist_8cpp_source.html#l00174">Dist.cpp:174</a></div></div>
<div class="ttc" id="astruct_cell_html_aa5ec9c2b164786826128590d2ed949d6"><div class="ttname"><a href="struct_cell.html#aa5ec9c2b164786826128590d2ed949d6">Cell::max_trans</a></div><div class="ttdeci">float * max_trans</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00297">Model.h:297</a></div></div>
<div class="ttc" id="astruct_param_html_a57be5e7bbc4e64275831d33a29b6d383"><div class="ttname"><a href="struct_param.html#a57be5e7bbc4e64275831d33a29b6d383">Param::AirportCloseTimeStartBase</a></div><div class="ttdeci">double AirportCloseTimeStartBase</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00226">Param.h:226</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a3ccc9da4bcf5265ff87a0f0ccab641ce"><div class="ttname"><a href="_covid_sim_8cpp.html#a3ccc9da4bcf5265ff87a0f0ccab641ce">Airports</a></div><div class="ttdeci">Airport * Airports</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00080">CovidSim.cpp:80</a></div></div>
<div class="ttc" id="a_model_macros_8h_html_a647e3cd1890f495c063a9537cc2c6b72"><div class="ttname"><a href="_model_macros_8h.html#a647e3cd1890f495c063a9537cc2c6b72">HOST_ABSENT</a></div><div class="ttdeci">#define HOST_ABSENT(x)</div><div class="ttdef"><b>Definition:</b> <a href="_model_macros_8h_source.html#l00017">ModelMacros.h:16</a></div></div>
<div class="ttc" id="astruct_person_html_a145e478a074f2af391591629e81d124d"><div class="ttname"><a href="struct_person.html#a145e478a074f2af391591629e81d124d">Person::dct_trigger_time</a></div><div class="ttdeci">unsigned short int dct_trigger_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00051">Model.h:51</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_a3f6cc1fbd5a979642f5538de205bb824"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#a3f6cc1fbd5a979642f5538de205bb824">CalcSpatialInf</a></div><div class="ttdeci">double CalcSpatialInf(int j, unsigned short int ts)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00027">CalcInfSusc.cpp:27</a></div></div>
<div class="ttc" id="astruct_param_html_aa836f6754e4687ee653f1b6c53346785"><div class="ttname"><a href="struct_param.html#aa836f6754e4687ee653f1b6c53346785">Param::DigitalContactTracingPolicyDuration</a></div><div class="ttdeci">double DigitalContactTracingPolicyDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00253">Param.h:253</a></div></div>
<div class="ttc" id="astruct_param_html_a76571a6e8278b1ab58af438a9a534727"><div class="ttname"><a href="struct_param.html#a76571a6e8278b1ab58af438a9a534727">Param::DigitalContactTracingDelay</a></div><div class="ttdeci">double DigitalContactTracingDelay</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00251">Param.h:251</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a614ac1fc9e1a81a00d4b06f27f767d51"><div class="ttname"><a href="_covid_sim_8cpp.html#a614ac1fc9e1a81a00d4b06f27f767d51">Hosts</a></div><div class="ttdeci">Person * Hosts</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00068">CovidSim.cpp:68</a></div></div>
<div class="ttc" id="astruct_param_html_ac1f015be2e11510f4261e1847eef6ebc"><div class="ttname"><a href="struct_param.html#ac1f015be2e11510f4261e1847eef6ebc">Param::TreatAdminUnitDivisor</a></div><div class="ttdeci">int TreatAdminUnitDivisor</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a9d8307b46ce56c14df0d4ef92b0f8e8b"><div class="ttname"><a href="_update_8cpp.html#a9d8307b46ce56c14df0d4ef92b0f8e8b">DoProphNoDelay</a></div><div class="ttdeci">void DoProphNoDelay(int ai, unsigned short int ts, int tn, int nc)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01048">Update.cpp:1048</a></div></div>
<div class="ttc" id="astruct_contact_event_html_a9c1e28b94e6dbf1acfe1b38a256b1191"><div class="ttname"><a href="struct_contact_event.html#a9c1e28b94e6dbf1acfe1b38a256b1191">ContactEvent::contact</a></div><div class="ttdeci">int contact</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00086">Model.h:86</a></div></div>
<div class="ttc" id="astruct_param_html_a88ac88140703af27c83b293df1b8954e"><div class="ttname"><a href="struct_param.html#a88ac88140703af27c83b293df1b8954e">Param::DoKeyWorkerProphOnceOnly</a></div><div class="ttdeci">int DoKeyWorkerProphOnceOnly</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00236">Param.h:236</a></div></div>
<div class="ttc" id="astruct_param_html_a02c2a675eb793244a8fd368667f7d204"><div class="ttname"><a href="struct_param.html#a02c2a675eb793244a8fd368667f7d204">Param::IncThreshPop</a></div><div class="ttdeci">int IncThreshPop</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00055">Param.h:55</a></div></div>
<div class="ttc" id="astruct_microcell_html_a1ba5ca77bb4bbb4b2dacd794e217b1d4"><div class="ttname"><a href="struct_microcell.html#a1ba5ca77bb4bbb4b2dacd794e217b1d4">Microcell::members</a></div><div class="ttdeci">int * members</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00271">Model.h:271</a></div></div>
<div class="ttc" id="astruct_cell_html_aeb5786c142fa8deb29588ccd7dfcfbd1"><div class="ttname"><a href="struct_cell.html#aeb5786c142fa8deb29588ccd7dfcfbd1">Cell::latent</a></div><div class="ttdeci">int * latent</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00295">Model.h:295</a></div></div>
<div class="ttc" id="astruct_cell_html_aee253e4260bedbfbd0a6005fde27d933"><div class="ttname"><a href="struct_cell.html#aee253e4260bedbfbd0a6005fde27d933">Cell::InvCDF</a></div><div class="ttdeci">int * InvCDF</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00296">Model.h:296</a></div></div>
<div class="ttc" id="astruct_param_html_abf9206e8d14c385e5ae11d93ce2a9902"><div class="ttname"><a href="struct_param.html#abf9206e8d14c385e5ae11d93ce2a9902">Param::AirportCloseTimeStart</a></div><div class="ttdeci">double AirportCloseTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00144">Param.h:144</a></div></div>
<div class="ttc" id="astruct_param_html_ad0bd2e59ad8302e20cfac1a1384933c2"><div class="ttname"><a href="struct_param.html#ad0bd2e59ad8302e20cfac1a1384933c2">Param::DoSeverity</a></div><div class="ttdeci">int DoSeverity</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00084">Param.h:84</a></div></div>
<div class="ttc" id="astruct_param_html_a5df51b7e4802b96687736ac720cc76ef"><div class="ttname"><a href="struct_param.html#a5df51b7e4802b96687736ac720cc76ef">Param::TimeStep</a></div><div class="ttdeci">double TimeStep</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00079">Param.h:79</a></div></div>
<div class="ttc" id="astruct_microcell_html_a148de9e1ba30dd42ff468c67b39190b7"><div class="ttname"><a href="struct_microcell.html#a148de9e1ba30dd42ff468c67b39190b7">Microcell::keyworkerproph_end_time</a></div><div class="ttdeci">unsigned short int keyworkerproph_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00278">Model.h:278</a></div></div>
<div class="ttc" id="astruct_microcell_html_a2a7b3f14f0df90ff856109140d5a0d23"><div class="ttname"><a href="struct_microcell.html#a2a7b3f14f0df90ff856109140d5a0d23">Microcell::place_end_time</a></div><div class="ttdeci">unsigned short int place_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00278">Model.h:278</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_adf2255a2d76676b9a9091b666dd1246a"><div class="ttname"><a href="struct_admin_unit.html#adf2255a2d76676b9a9091b666dd1246a">AdminUnit::ndct</a></div><div class="ttdeci">int ndct</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00350">Model.h:350</a></div></div>
<div class="ttc" id="astruct_param_html_a9ff82be8872693076c8ee8ba7f2ed6ac"><div class="ttname"><a href="struct_param.html#a9ff82be8872693076c8ee8ba7f2ed6ac">Param::MaxDigitalContactsToTrace</a></div><div class="ttdeci">int MaxDigitalContactsToTrace</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00254">Param.h:254</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_ac3b39b1c139909a4c2da802e243a75d0"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#ac3b39b1c139909a4c2da802e243a75d0">CalcPlaceInf</a></div><div class="ttdeci">double CalcPlaceInf(int j, int k, unsigned short int ts)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00019">CalcInfSusc.cpp:19</a></div></div>
<div class="ttc" id="astruct_param_html_af9373c2c9a6bddc64739e0d6f9a2fb41"><div class="ttname"><a href="struct_param.html#af9373c2c9a6bddc64739e0d6f9a2fb41">Param::RemoveContactsOfNegativeIndexCase</a></div><div class="ttdeci">int RemoveContactsOfNegativeIndexCase</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00254">Param.h:254</a></div></div>
<div class="ttc" id="astruct_param_html_ab7bf6a161106306e82dcf62ef8a54a33"><div class="ttname"><a href="struct_param.html#ab7bf6a161106306e82dcf62ef8a54a33">Param::LocalBeta</a></div><div class="ttdeci">double LocalBeta</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00091">Param.h:91</a></div></div>
<div class="ttc" id="astruct_param_html_a757b6ff070f6f6e31ad8b9bc0dbb8c0c"><div class="ttname"><a href="struct_param.html#a757b6ff070f6f6e31ad8b9bc0dbb8c0c">Param::ProportionDigitalContactsIsolate</a></div><div class="ttdeci">double ProportionDigitalContactsIsolate</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00251">Param.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_a88b64b26117f1b98a472186153441ccd"><div class="ttname"><a href="struct_param.html#a88b64b26117f1b98a472186153441ccd">Param::HotelPlaceType</a></div><div class="ttdeci">int HotelPlaceType</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00059">Param.h:59</a></div></div>
<div class="ttc" id="astruct_param_html_aac49a1ec7cdf5e28cb9033d94fd66be4"><div class="ttname"><a href="struct_param.html#aac49a1ec7cdf5e28cb9033d94fd66be4">Param::TreatTimeStart</a></div><div class="ttdeci">double TreatTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00131">Param.h:131</a></div></div>
<div class="ttc" id="astruct_param_html_a9b1c8b9c8a0496a08db3ff27c9bc4fa7"><div class="ttname"><a href="struct_param.html#a9b1c8b9c8a0496a08db3ff27c9bc4fa7">Param::OutputDigitalContactDist</a></div><div class="ttdeci">int OutputDigitalContactDist</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00254">Param.h:254</a></div></div>
<div class="ttc" id="astruct_airport_html_afed0dc22ba28b76b24cef5e26bb5dfed"><div class="ttname"><a href="struct_airport.html#afed0dc22ba28b76b24cef5e26bb5dfed">Airport::DestMcells</a></div><div class="ttdeci">IndexList * DestMcells</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00255">Model.h:255</a></div></div>
<div class="ttc" id="a_inf_stat_8h_html"><div class="ttname"><a href="_inf_stat_8h.html">InfStat.h</a></div></div>
<div class="ttc" id="astruct_pop_var_html_ade6e3381844feecb7367ab7d18d9f105"><div class="ttname"><a href="struct_pop_var.html#ade6e3381844feecb7367ab7d18d9f105">PopVar::p_queue</a></div><div class="ttdeci">int * p_queue[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00111">Model.h:111</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a4b017bdfae23da2e4c5f63c9226df590"><div class="ttname"><a href="_covid_sim_8cpp.html#a4b017bdfae23da2e4c5f63c9226df590">StateT</a></div><div class="ttdeci">PopVar StateT[MAX_NUM_THREADS]</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00070">CovidSim.cpp:70</a></div></div>
<div class="ttc" id="astruct_microcell_html_a2d3754527924f19c58ce8a1c8358905f"><div class="ttname"><a href="struct_microcell.html#a2d3754527924f19c58ce8a1c8358905f">Microcell::treat_trig</a></div><div class="ttdeci">unsigned short int treat_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00279">Model.h:279</a></div></div>
<div class="ttc" id="astruct_person_html_a7d9606d6c6d77aa8d1ab6af1cffc0773"><div class="ttname"><a href="struct_person.html#a7d9606d6c6d77aa8d1ab6af1cffc0773">Person::RecoveringFromCritical_time</a></div><div class="ttdeci">unsigned short int RecoveringFromCritical_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00046">Model.h:46</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_abca4d2ea991811c0816ca4ff1884a6bb"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#abca4d2ea991811c0816ca4ff1884a6bb">CalcPlaceSusc</a></div><div class="ttdeci">double CalcPlaceSusc(int ai, int k, unsigned short int ts, int infector, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00052">CalcInfSusc.cpp:52</a></div></div>
<div class="ttc" id="astruct_cell_html_a7da9a586f1fbe511adac3224615a1c60"><div class="ttname"><a href="struct_cell.html#a7da9a586f1fbe511adac3224615a1c60">Cell::susceptible</a></div><div class="ttdeci">int * susceptible</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00295">Model.h:295</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_ac75718f72ab02fcb236cb9c70fd37861"><div class="ttname"><a href="_covid_sim_8cpp.html#ac75718f72ab02fcb236cb9c70fd37861">AdUnits</a></div><div class="ttdeci">AdminUnit AdUnits[MAX_ADUNITS]</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00075">CovidSim.cpp:75</a></div></div>
<div class="ttc" id="astruct_cell_html_ac69ac8699ecb85184a229188fb65ee23"><div class="ttname"><a href="struct_cell.html#ac69ac8699ecb85184a229188fb65ee23">Cell::L</a></div><div class="ttdeci">int L</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00294">Model.h:294</a></div></div>
<div class="ttc" id="astruct_param_html_a5da47f23a0ec1625b5db97741751fe16"><div class="ttname"><a href="struct_param.html#a5da47f23a0ec1625b5db97741751fe16">Param::KeyWorkerProphTimeStart</a></div><div class="ttdeci">double KeyWorkerProphTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00222">Param.h:222</a></div></div>
<div class="ttc" id="a_update_8cpp_html_ada87e9ed97b57f138111412bb5e9f094"><div class="ttname"><a href="_update_8cpp.html#ada87e9ed97b57f138111412bb5e9f094">DoDeath_FromCriticalorSARIorILI</a></div><div class="ttdeci">void DoDeath_FromCriticalorSARIorILI(int ai, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00332">Update.cpp:332</a></div></div>
<div class="ttc" id="astruct_param_html_a97c3b622167f05149bd9c940cb8538be"><div class="ttname"><a href="struct_param.html#a97c3b622167f05149bd9c940cb8538be">Param::SocDistCellIncThresh</a></div><div class="ttdeci">int SocDistCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00232">Param.h:232</a></div></div>
<div class="ttc" id="astruct_place_html_a082d7b50c83b6de43de4e223d725f210"><div class="ttname"><a href="struct_place.html#a082d7b50c83b6de43de4e223d725f210">Place::close_end_time</a></div><div class="ttdeci">unsigned short int close_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00315">Model.h:315</a></div></div>
<div class="ttc" id="astruct_param_html_a2a19e4c1f3a3e56f624419911e7864f4"><div class="ttname"><a href="struct_param.html#a2a19e4c1f3a3e56f624419911e7864f4">Param::DoSymptoms</a></div><div class="ttdeci">int DoSymptoms</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00055">Param.h:55</a></div></div>
<div class="ttc" id="astruct_param_html_a6ae79a6faae5f0ccb13fdc124f53825e"><div class="ttname"><a href="struct_param.html#a6ae79a6faae5f0ccb13fdc124f53825e">Param::MoveRestrEffect</a></div><div class="ttdeci">double MoveRestrEffect</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00143">Param.h:143</a></div></div>
<div class="ttc" id="astruct_param_html_a46e07ecf99a059e5e73be4cbb654c52f"><div class="ttname"><a href="struct_param.html#a46e07ecf99a059e5e73be4cbb654c52f">Param::PlaceCloseSpatialRelContact</a></div><div class="ttdeci">double PlaceCloseSpatialRelContact</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00126">Param.h:126</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a849409c10e486b1fd98f9cf60a840d96"><div class="ttname"><a href="struct_pop_var.html#a849409c10e486b1fd98f9cf60a840d96">PopVar::cumDCT_adunit</a></div><div class="ttdeci">int cumDCT_adunit[MAX_ADUNITS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00107">Model.h:107</a></div></div>
<div class="ttc" id="astruct_place_html_a3a79f4426bdacf4a6aef74bca912ca02"><div class="ttname"><a href="struct_place.html#a3a79f4426bdacf4a6aef74bca912ca02">Place::loc_y</a></div><div class="ttdeci">float loc_y</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00318">Model.h:318</a></div></div>
<div class="ttc" id="astruct_param_html_ae9a2cd49e0973aa1d2070a9965a5e27b"><div class="ttname"><a href="struct_param.html#ae9a2cd49e0973aa1d2070a9965a5e27b">Param::TreatRadius2</a></div><div class="ttdeci">double TreatRadius2</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00132">Param.h:132</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_ab42e825233f629afd92c571f475809f3"><div class="ttname"><a href="_sweep_8cpp.html#ab42e825233f629afd92c571f475809f3">DigitalContactTracingSweep</a></div><div class="ttdeci">void DigitalContactTracingSweep(double t)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l00827">Sweep.cpp:827</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_a1f739b3a5f963b819c6132b39fe2cb7f"><div class="ttname"><a href="struct_admin_unit.html#a1f739b3a5f963b819c6132b39fe2cb7f">AdminUnit::DigitalContactTracingTimeStart</a></div><div class="ttdeci">double DigitalContactTracingTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00345">Model.h:345</a></div></div>
<div class="ttc" id="astruct_person_html_afb0b95d74bdbe441cc68da49f81349d0"><div class="ttname"><a href="struct_person.html#afb0b95d74bdbe441cc68da49f81349d0">Person::Travelling</a></div><div class="ttdeci">unsigned char Travelling</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00031">Model.h:31</a></div></div>
<div class="ttc" id="a_constants_8h_html_afad8323327de65301885f6cf79fe8768"><div class="ttname"><a href="_constants_8h.html#afad8323327de65301885f6cf79fe8768">MAX_TRAVEL_TIME</a></div><div class="ttdeci">const int MAX_TRAVEL_TIME</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8h_source.html#l00080">Constants.h:80</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_ac4d6e60578bc69abb234a20fa855f8d2"><div class="ttname"><a href="struct_admin_unit.html#ac4d6e60578bc69abb234a20fa855f8d2">AdminUnit::PlaceCloseDuration</a></div><div class="ttdeci">double PlaceCloseDuration</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00349">Model.h:349</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_ad4754463e1616af20db8ac43521487ec"><div class="ttname"><a href="struct_admin_unit.html#ad4754463e1616af20db8ac43521487ec">AdminUnit::SocialDistanceDuration</a></div><div class="ttdeci">double SocialDistanceDuration</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00349">Model.h:349</a></div></div>
<div class="ttc" id="a_rand_8cpp_html_a50a53c3fed7a411386c5424c72eeb32a"><div class="ttname"><a href="_rand_8cpp.html#a50a53c3fed7a411386c5424c72eeb32a">ignpoi_mt</a></div><div class="ttdeci">long ignpoi_mt(double mu, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_rand_8cpp_source.html#l00671">Rand.cpp:671</a></div></div>
<div class="ttc" id="astruct_param_html_a6d61e69b60c4c79e6b27f53ff50bd0cb"><div class="ttname"><a href="struct_param.html#a6d61e69b60c4c79e6b27f53ff50bd0cb">Param::MoveRestrRadius2</a></div><div class="ttdeci">double MoveRestrRadius2</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00142">Param.h:142</a></div></div>
<div class="ttc" id="a_update_8cpp_html_ae03c1bfe633a098b2e00e3e1db4e4827"><div class="ttname"><a href="_update_8cpp.html#ae03c1bfe633a098b2e00e3e1db4e4827">DoSARI</a></div><div class="ttdeci">void DoSARI(int ai, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00260">Update.cpp:260</a></div></div>
<div class="ttc" id="astruct_param_html_ad4920e3469458a40d16457bb51484d8c"><div class="ttname"><a href="struct_param.html#ad4920e3469458a40d16457bb51484d8c">Param::TreatDelayMean</a></div><div class="ttdeci">double TreatDelayMean</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00131">Param.h:131</a></div></div>
<div class="ttc" id="astruct_microcell_html_aafd0a675dcda11f38ee47b332bd378fb"><div class="ttname"><a href="struct_microcell.html#aafd0a675dcda11f38ee47b332bd378fb">Microcell::treat_start_time</a></div><div class="ttdeci">unsigned short int treat_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00280">Model.h:280</a></div></div>
<div class="ttc" id="astruct_param_html_ab3cd89ed4c15cf4f137459c2f1ae03ac"><div class="ttname"><a href="struct_param.html#ab3cd89ed4c15cf4f137459c2f1ae03ac">Param::MoveRestrTimeStart</a></div><div class="ttdeci">double MoveRestrTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00143">Param.h:143</a></div></div>
<div class="ttc" id="a_error_8h_html_a3f33eb02fe06645ffc38a943efc45df0"><div class="ttname"><a href="_error_8h.html#a3f33eb02fe06645ffc38a943efc45df0">ERR_CRITICAL_FMT</a></div><div class="ttdeci">#define ERR_CRITICAL_FMT(fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="_error_8h_source.html#l00006">Error.h:5</a></div></div>
<div class="ttc" id="astruct_place_html_a6fdc8ea6b878a05d80a23d862271f633"><div class="ttname"><a href="struct_place.html#a6fdc8ea6b878a05d80a23d862271f633">Place::close_start_time</a></div><div class="ttdeci">unsigned short int close_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00315">Model.h:315</a></div></div>
<div class="ttc" id="astruct_param_html_ab7ec8d8d34ff6dafeaf12958f1dfa833"><div class="ttname"><a href="struct_param.html#ab7ec8d8d34ff6dafeaf12958f1dfa833">Param::DoAdminTriggers</a></div><div class="ttdeci">int DoAdminTriggers</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00230">Param.h:230</a></div></div>
<div class="ttc" id="astruct_param_html_af34088a13b55690f86007099530d4528"><div class="ttname"><a href="struct_param.html#af34088a13b55690f86007099530d4528">Param::DelayToTestDCTContacts</a></div><div class="ttdeci">double DelayToTestDCTContacts</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00252">Param.h:252</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a347a1d99039fadf2ee33ddc0aedfbf63"><div class="ttname"><a href="_update_8cpp.html#a347a1d99039fadf2ee33ddc0aedfbf63">DoPlaceOpen</a></div><div class="ttdeci">void DoPlaceOpen(int i, int j, unsigned short int ts, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01221">Update.cpp:1221</a></div></div>
<div class="ttc" id="astruct_person_html_a018397cefdfea7838f5ce62c70ff15eb"><div class="ttname"><a href="struct_person.html#a018397cefdfea7838f5ce62c70ff15eb">Person::digitalContactTracingUser</a></div><div class="ttdeci">unsigned int digitalContactTracingUser</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00050">Model.h:50</a></div></div>
<div class="ttc" id="astruct_place_html_ab51ce5972ce98ae2c88686144c0af9d2"><div class="ttname"><a href="struct_place.html#ab51ce5972ce98ae2c88686144c0af9d2">Place::group_size</a></div><div class="ttdeci">int * group_size</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00320">Model.h:320</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a81ac0079d7384de0995dd6bc428bcdf1"><div class="ttname"><a href="struct_pop_var.html#a81ac0079d7384de0995dd6bc428bcdf1">PopVar::np_queue</a></div><div class="ttdeci">int np_queue[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00111">Model.h:111</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a1d4cb2d2ad0b1450d182b2875ff3f896"><div class="ttname"><a href="_covid_sim_8cpp.html#a1d4cb2d2ad0b1450d182b2875ff3f896">Mcells</a></div><div class="ttdeci">Microcell * Mcells</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00073">CovidSim.cpp:73</a></div></div>
<div class="ttc" id="astruct_person_html_a28e2897a7d04b84b3557944ad637c371"><div class="ttname"><a href="struct_person.html#a28e2897a7d04b84b3557944ad637c371">Person::detected</a></div><div class="ttdeci">unsigned int detected</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00029">Model.h:29</a></div></div>
<div class="ttc" id="astruct_person_html_a0095c69e609078991b1e6e8a8a25105f"><div class="ttname"><a href="struct_person.html#a0095c69e609078991b1e6e8a8a25105f">Person::hh</a></div><div class="ttdeci">int hh</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00019">Model.h:19</a></div></div>
<div class="ttc" id="astruct_param_html_afbb6d7c264ec54c197823ad6093e6c03"><div class="ttname"><a href="struct_param.html#afbb6d7c264ec54c197823ad6093e6c03">Param::DoPlaces</a></div><div class="ttdeci">int DoPlaces</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00052">Param.h:52</a></div></div>
<div class="ttc" id="astruct_param_html_a6d8467da10891f54ccadad4b80205cc4"><div class="ttname"><a href="struct_param.html#a6d8467da10891f54ccadad4b80205cc4">Param::PlaceCloseCellIncThresh</a></div><div class="ttdeci">int PlaceCloseCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00232">Param.h:232</a></div></div>
<div class="ttc" id="astruct_cell_html"><div class="ttname"><a href="struct_cell.html">Cell</a></div><div class="ttdoc">Holds microcells.</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00292">Model.h:293</a></div></div>
<div class="ttc" id="a_update_8cpp_html_ad19985dbb0979eb71d6ccf74dd3e7c9c"><div class="ttname"><a href="_update_8cpp.html#ad19985dbb0979eb71d6ccf74dd3e7c9c">DoIncub</a></div><div class="ttdeci">void DoIncub(int ai, unsigned short int ts, int tn, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00428">Update.cpp:428</a></div></div>
<div class="ttc" id="astruct_param_html_a7a25f38ea866727c44666d6c23586af1"><div class="ttname"><a href="struct_param.html#a7a25f38ea866727c44666d6c23586af1">Param::TreatMaxCoursesPerCase</a></div><div class="ttdeci">int TreatMaxCoursesPerCase</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00240">Param.h:240</a></div></div>
<div class="ttc" id="a_update_8cpp_html_add3545072579cad99527275129cb5cd1"><div class="ttname"><a href="_update_8cpp.html#add3545072579cad99527275129cb5cd1">DoDeath</a></div><div class="ttdeci">void DoDeath(int ai, int tn, int run)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00936">Update.cpp:936</a></div></div>
<div class="ttc" id="astruct_param_html_a8ca7c57c4419619e426f8379b89ac550"><div class="ttname"><a href="struct_param.html#a8ca7c57c4419619e426f8379b89ac550">Param::VaccMaxCourses</a></div><div class="ttdeci">double VaccMaxCourses</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00139">Param.h:139</a></div></div>
<div class="ttc" id="a_model_8h_html"><div class="ttname"><a href="_model_8h.html">Model.h</a></div></div>
<div class="ttc" id="astruct_param_html_a7f33738393141946bc763dca978d91ec"><div class="ttname"><a href="struct_param.html#a7f33738393141946bc763dca978d91ec">Param::PlaceCloseDuration</a></div><div class="ttdeci">double PlaceCloseDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00125">Param.h:125</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_a2f635320f25c676a95e9786b29912ccd"><div class="ttname"><a href="struct_admin_unit.html#a2f635320f25c676a95e9786b29912ccd">AdminUnit::SocialDistanceTimeStart</a></div><div class="ttdeci">double SocialDistanceTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00346">Model.h:346</a></div></div>
<div class="ttc" id="astruct_pop_var_html_aae8e8b2368902517395051003c7f3738"><div class="ttname"><a href="struct_pop_var.html#aae8e8b2368902517395051003c7f3738">PopVar::trigDC</a></div><div class="ttdeci">int trigDC</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00098">Model.h:98</a></div></div>
<div class="ttc" id="astruct_param_html_a63656dae85d858248d9c61e74db215ad"><div class="ttname"><a href="struct_param.html#a63656dae85d858248d9c61e74db215ad">Param::PlaceTypeMeanSize</a></div><div class="ttdeci">double PlaceTypeMeanSize[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00119">Param.h:119</a></div></div>
<div class="ttc" id="astruct_param_html_a02d421d75cfdd99e74d5f63704c742de"><div class="ttname"><a href="struct_param.html#a02d421d75cfdd99e74d5f63704c742de">Param::HotelPropLocal</a></div><div class="ttdeci">double HotelPropLocal</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00107">Param.h:107</a></div></div>
<div class="ttc" id="astruct_param_html_aebeab7826d04b2868e535b721c9cc607"><div class="ttname"><a href="struct_param.html#aebeab7826d04b2868e535b721c9cc607">Param::LatentToSymptDelay</a></div><div class="ttdeci">double LatentToSymptDelay</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00097">Param.h:97</a></div></div>
<div class="ttc" id="astruct_param_html_a32a2831e2e5d15417c8f4981325b626a"><div class="ttname"><a href="struct_param.html#a32a2831e2e5d15417c8f4981325b626a">Param::SensitivityDCT</a></div><div class="ttdeci">double SensitivityDCT</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00252">Param.h:252</a></div></div>
<div class="ttc" id="astruct_place_html_a1d215d4c7b8fad842b057dd53cab41ca"><div class="ttname"><a href="struct_place.html#a1d215d4c7b8fad842b057dd53cab41ca">Place::treat_end_time</a></div><div class="ttdeci">unsigned short int treat_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00315">Model.h:315</a></div></div>
<div class="ttc" id="astruct_index_list_html_af997963b72d978bebf097d856dbbc56a"><div class="ttname"><a href="struct_index_list.html#af997963b72d978bebf097d856dbbc56a">IndexList::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00239">Model.h:239</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_a1a1e07bd496a1357073307f0b1ef889d"><div class="ttname"><a href="struct_admin_unit.html#a1a1e07bd496a1357073307f0b1ef889d">AdminUnit::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00341">Model.h:341</a></div></div>
<div class="ttc" id="astruct_microcell_html_a8753636ae22cdb39e91cdba6bf684e58"><div class="ttname"><a href="struct_microcell.html#a8753636ae22cdb39e91cdba6bf684e58">Microcell::place_trig</a></div><div class="ttdeci">unsigned short int place_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="a_constants_8h_html_adedcd3e6196a0b2b3f68ddd96c0f0153"><div class="ttname"><a href="_constants_8h.html#adedcd3e6196a0b2b3f68ddd96c0f0153">INFECT_TYPE_MASK</a></div><div class="ttdeci">const int INFECT_TYPE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8h_source.html#l00076">Constants.h:76</a></div></div>
<div class="ttc" id="astruct_param_html_a24a95128a168e4265260353d5d636456"><div class="ttname"><a href="struct_param.html#a24a95128a168e4265260353d5d636456">Param::cwidth</a></div><div class="ttdeci">double cwidth</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00087">Param.h:87</a></div></div>
<div class="ttc" id="astruct_cell_html_aa24cfa33fce9c27d441610090a5d883c"><div class="ttname"><a href="struct_cell.html#aa24cfa33fce9c27d441610090a5d883c">Cell::S0</a></div><div class="ttdeci">int S0</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00294">Model.h:294</a></div></div>
<div class="ttc" id="astruct_cell_html_af684ed0e536a5f35315bbcd100f6e3f2"><div class="ttname"><a href="struct_cell.html#af684ed0e536a5f35315bbcd100f6e3f2">Cell::S</a></div><div class="ttdeci">int S</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00294">Model.h:294</a></div></div>
<div class="ttc" id="astruct_person_html_aea27b1ea6454e2003362c036e76edb94"><div class="ttname"><a href="struct_person.html#aea27b1ea6454e2003362c036e76edb94">Person::index_case_dct</a></div><div class="ttdeci">unsigned int index_case_dct</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00049">Model.h:49</a></div></div>
<div class="ttc" id="astruct_param_html_a22019a278c77c27bbd2f1519a8dd44e1"><div class="ttname"><a href="struct_param.html#a22019a278c77c27bbd2f1519a8dd44e1">Param::KeyWorkerProphDuration</a></div><div class="ttdeci">double KeyWorkerProphDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00222">Param.h:222</a></div></div>
<div class="ttc" id="astruct_person_html_a37f4c0642b38606959f0f2f0fc843f24"><div class="ttname"><a href="struct_person.html#a37f4c0642b38606959f0f2f0fc843f24">Person::infect_type</a></div><div class="ttdeci">short int infect_type</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00038">Model.h:38</a></div></div>
<div class="ttc" id="astruct_microcell_html_a8e7b5e36c210cfde24379c6374381ca1"><div class="ttname"><a href="struct_microcell.html#a8e7b5e36c210cfde24379c6374381ca1">Microcell::move_start_time</a></div><div class="ttdeci">unsigned short int move_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00277">Model.h:277</a></div></div>
<div class="ttc" id="a_model_macros_8h_html"><div class="ttname"><a href="_model_macros_8h.html">ModelMacros.h</a></div></div>
<div class="ttc" id="astruct_param_html_a09b7fc098c7a531858b1f1600ba2dd77"><div class="ttname"><a href="struct_param.html#a09b7fc098c7a531858b1f1600ba2dd77">Param::FalsePositiveRate</a></div><div class="ttdeci">double FalsePositiveRate</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00067">Param.h:67</a></div></div>
<div class="ttc" id="a_rand_8h_html"><div class="ttname"><a href="_rand_8h.html">Rand.h</a></div></div>
<div class="ttc" id="astruct_person_html_af4c2ecb563b83f7978ae65d13625c1e7"><div class="ttname"><a href="struct_person.html#af4c2ecb563b83f7978ae65d13625c1e7">Person::SARI_time</a></div><div class="ttdeci">unsigned short int SARI_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00046">Model.h:46</a></div></div>
<div class="ttc" id="astruct_param_html_a26c7b2864436284e2fb0d29bad5aec77"><div class="ttname"><a href="struct_param.html#a26c7b2864436284e2fb0d29bad5aec77">Param::HolidayEffect</a></div><div class="ttdeci">double HolidayEffect[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00129">Param.h:129</a></div></div>
<div class="ttc" id="astruct_param_html_aaf4e64edef6775bb360fc8ef16afad92"><div class="ttname"><a href="struct_param.html#aaf4e64edef6775bb360fc8ef16afad92">Param::MoveRestrByAdminUnit</a></div><div class="ttdeci">int MoveRestrByAdminUnit</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a1470b6ba6aca8284f6b40719d45902b7"><div class="ttname"><a href="_update_8cpp.html#a1470b6ba6aca8284f6b40719d45902b7">DoPlaceClose</a></div><div class="ttdeci">void DoPlaceClose(int i, int j, unsigned short int ts, int tn, int DoAnyway)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l01079">Update.cpp:1079</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_a9ad39ba21b1e8c0e8530ad97300c157f"><div class="ttname"><a href="_covid_sim_8cpp.html#a9ad39ba21b1e8c0e8530ad97300c157f">P</a></div><div class="ttdeci">Param P</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00067">CovidSim.cpp:67</a></div></div>
<div class="ttc" id="astruct_param_html_a6a00777e9ffeb03929081d7920431d31"><div class="ttname"><a href="struct_param.html#a6a00777e9ffeb03929081d7920431d31">Param::DelayToTestIndexCase</a></div><div class="ttdeci">double DelayToTestIndexCase</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00252">Param.h:252</a></div></div>
<div class="ttc" id="astruct_param_html_ae5cb537aacce9565a8066f73cef6d69c"><div class="ttname"><a href="struct_param.html#ae5cb537aacce9565a8066f73cef6d69c">Param::NumAdunits</a></div><div class="ttdeci">int NumAdunits</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00042">Param.h:42</a></div></div>
<div class="ttc" id="astruct_microcell_html_a9dfaaa87dbe22f95c50cb06a1d290a14"><div class="ttname"><a href="struct_microcell.html#a9dfaaa87dbe22f95c50cb06a1d290a14">Microcell::socdist_end_time</a></div><div class="ttdeci">unsigned short int socdist_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00278">Model.h:278</a></div></div>
<div class="ttc" id="astruct_param_html_acd900e8640668798a3c99196f664f27d"><div class="ttname"><a href="struct_param.html#acd900e8640668798a3c99196f664f27d">Param::Nplace</a></div><div class="ttdeci">int Nplace[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00052">Param.h:52</a></div></div>
<div class="ttc" id="astruct_person_html"><div class="ttname"><a href="struct_person.html">Person</a></div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00015">Model.h:16</a></div></div>
<div class="ttc" id="astruct_airport_html_ad4293e2695d54d18d345a17a50fe57b4"><div class="ttname"><a href="struct_airport.html#ad4293e2695d54d18d345a17a50fe57b4">Airport::conn_airports</a></div><div class="ttdeci">unsigned short int * conn_airports</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00252">Model.h:252</a></div></div>
<div class="ttc" id="astruct_param_html_a4efe0e20456caea4e3640f435d117dc9"><div class="ttname"><a href="struct_param.html#a4efe0e20456caea4e3640f435d117dc9">Param::ScalingFactorPlaceDigitalContacts</a></div><div class="ttdeci">double ScalingFactorPlaceDigitalContacts</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00251">Param.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_a7591c3b7642f808d7757b4388fc407e5"><div class="ttname"><a href="struct_param.html#a7591c3b7642f808d7757b4388fc407e5">Param::DoInterventionDelaysByAdUnit</a></div><div class="ttdeci">int DoInterventionDelaysByAdUnit</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00257">Param.h:257</a></div></div>
<div class="ttc" id="astruct_param_html_a8245c40ebfaa3657eb4ae5a9df846744"><div class="ttname"><a href="struct_param.html#a8245c40ebfaa3657eb4ae5a9df846744">Param::DoPlaceCloseOnceOnly</a></div><div class="ttdeci">int DoPlaceCloseOnceOnly</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00236">Param.h:236</a></div></div>
<div class="ttc" id="astruct_person_html_ae7380f03f7afebcf9bfb27ee89026d6f"><div class="ttname"><a href="struct_person.html#ae7380f03f7afebcf9bfb27ee89026d6f">Person::latent_time</a></div><div class="ttdeci">unsigned short int latent_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00044">Model.h:44</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a6be9476583f6d6ed75a6c76e605ad5c9"><div class="ttname"><a href="struct_pop_var.html#a6be9476583f6d6ed75a6c76e605ad5c9">PopVar::mvacc_queue</a></div><div class="ttdeci">int * mvacc_queue</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00117">Model.h:117</a></div></div>
<div class="ttc" id="astruct_param_html_a2f0e5a285e87c4df4914bba98a0dbb79"><div class="ttname"><a href="struct_param.html#a2f0e5a285e87c4df4914bba98a0dbb79">Param::VaccProp</a></div><div class="ttdeci">double VaccProp</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00138">Param.h:138</a></div></div>
<div class="ttc" id="astruct_contact_event_html_aeb699ca100a975580da4e67e8c8660b7"><div class="ttname"><a href="struct_contact_event.html#aeb699ca100a975580da4e67e8c8660b7">ContactEvent::contact_time</a></div><div class="ttdeci">unsigned short int contact_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00088">Model.h:88</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_af0b960c3c171aae2ef6a9b1a2c5e8caa"><div class="ttname"><a href="_covid_sim_8cpp.html#af0b960c3c171aae2ef6a9b1a2c5e8caa">Households</a></div><div class="ttdeci">Household * Households</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00069">CovidSim.cpp:69</a></div></div>
<div class="ttc" id="astruct_param_html_a4a8d8a2d25046d5d0ed9fb2b36662f43"><div class="ttname"><a href="struct_param.html#a4a8d8a2d25046d5d0ed9fb2b36662f43">Param::PlaceCloseByAdminUnit</a></div><div class="ttdeci">int PlaceCloseByAdminUnit</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="astruct_airport_html_aaa63e0e69a2a075fbd380ac1a3c19baf"><div class="ttname"><a href="struct_airport.html#aaa63e0e69a2a075fbd380ac1a3c19baf">Airport::Inv_prop_traffic</a></div><div class="ttdeci">int Inv_prop_traffic[129]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00251">Model.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_afefa058b931e136b92b407bca7e31494"><div class="ttname"><a href="struct_param.html#afefa058b931e136b92b407bca7e31494">Param::RelativeTravelRate</a></div><div class="ttdeci">double RelativeTravelRate[NUM_AGE_GROUPS]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00104">Param.h:104</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_aeb93e3179ab4ea093fcf62df82ede73f"><div class="ttname"><a href="_covid_sim_8cpp.html#aeb93e3179ab4ea093fcf62df82ede73f">State</a></div><div class="ttdeci">PopVar State</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00070">CovidSim.cpp:70</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_aa8eff74bc82cbd3ccae0701f1cc40cd6"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#aa8eff74bc82cbd3ccae0701f1cc40cd6">CalcPersonSusc</a></div><div class="ttdeci">double CalcPersonSusc(int ai, unsigned short int ts, int infector, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00064">CalcInfSusc.cpp:64</a></div></div>
<div class="ttc" id="astruct_person_html_ace56ed8e9e8bcc936ea4839f8943401c"><div class="ttname"><a href="struct_person.html#ace56ed8e9e8bcc936ea4839f8943401c">Person::PlaceLinks</a></div><div class="ttdeci">int PlaceLinks[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00023">Model.h:23</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a174fed5c564ae9226a6aae057274ae3a"><div class="ttname"><a href="struct_pop_var.html#a174fed5c564ae9226a6aae057274ae3a">PopVar::contact_dist</a></div><div class="ttdeci">int contact_dist[MAX_CONTACTS+1]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00121">Model.h:121</a></div></div>
<div class="ttc" id="a_kernels_8cpp_html_a4554988cce0ded4c9a7717faf9baa2f0"><div class="ttname"><a href="_kernels_8cpp.html#a4554988cce0ded4c9a7717faf9baa2f0">numKernel</a></div><div class="ttdeci">double numKernel(double r2)</div><div class="ttdef"><b>Definition:</b> <a href="_kernels_8cpp_source.html#l00113">Kernels.cpp:113</a></div></div>
<div class="ttc" id="a_inf_stat_8h_html_ad72234c285de2e11997598044ae01389af2db792c1a49637629bca88c8e14dae6"><div class="ttname"><a href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389af2db792c1a49637629bca88c8e14dae6">InfStat_InfectiousAsymptomaticNotCase</a></div><div class="ttdeci">@ InfStat_InfectiousAsymptomaticNotCase</div><div class="ttdef"><b>Definition:</b> <a href="_inf_stat_8h_source.html#l00009">InfStat.h:9</a></div></div>
<div class="ttc" id="astruct_param_html_adb50ad25ca7a391511383a2cf412d165"><div class="ttname"><a href="struct_param.html#adb50ad25ca7a391511383a2cf412d165">Param::PlaceTypeGroupSizeParam1</a></div><div class="ttdeci">double PlaceTypeGroupSizeParam1[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00121">Param.h:121</a></div></div>
<div class="ttc" id="astruct_param_html_ac64b9cdf190d1cb94357cd20340aff0a"><div class="ttname"><a href="struct_param.html#ac64b9cdf190d1cb94357cd20340aff0a">Param::InvLocalJourneyDurationDistrib</a></div><div class="ttdeci">int InvLocalJourneyDurationDistrib[1025]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00109">Param.h:109</a></div></div>
<div class="ttc" id="astruct_person_html_a44c74477efffa4b84a027e05229db846"><div class="ttname"><a href="struct_person.html#a44c74477efffa4b84a027e05229db846">Person::digitalContactTraced</a></div><div class="ttdeci">unsigned int digitalContactTraced</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00048">Model.h:48</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_a18851ef497a36857e3e469fc819974e6"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#a18851ef497a36857e3e469fc819974e6">CalcHouseSusc</a></div><div class="ttdeci">double CalcHouseSusc(int ai, unsigned short int ts, int infector, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00046">CalcInfSusc.cpp:46</a></div></div>
<div class="ttc" id="astruct_param_html_afe76c35ecdf1140bd2d95b47de29b778"><div class="ttname"><a href="struct_param.html#afe76c35ecdf1140bd2d95b47de29b778">Param::PlaceCloseHouseholdRelContact</a></div><div class="ttdeci">double PlaceCloseHouseholdRelContact</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00126">Param.h:126</a></div></div>
<div class="ttc" id="astruct_param_html_aa56f5859b115309dd02525b3ff404ede"><div class="ttname"><a href="struct_param.html#aa56f5859b115309dd02525b3ff404ede">Param::LengthDigitalContactIsolation</a></div><div class="ttdeci">double LengthDigitalContactIsolation</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00251">Param.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_a0b21a57d159bf47d1ec56130aaf0d8b4"><div class="ttname"><a href="struct_param.html#a0b21a57d159bf47d1ec56130aaf0d8b4">Param::PlaceCloseAdminUnitDivisor</a></div><div class="ttdeci">int PlaceCloseAdminUnitDivisor</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="astruct_param_html_a2cf95afcb2ee088931b39f0e8e4b7d13"><div class="ttname"><a href="struct_param.html#a2cf95afcb2ee088931b39f0e8e4b7d13">Param::VaccTimeStart</a></div><div class="ttdeci">double VaccTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00137">Param.h:137</a></div></div>
<div class="ttc" id="astruct_admin_unit_html_af04df618df78b7d8ff0073e8ac043df2"><div class="ttname"><a href="struct_admin_unit.html#af04df618df78b7d8ff0073e8ac043df2">AdminUnit::PlaceCloseTimeStart</a></div><div class="ttdeci">double PlaceCloseTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00346">Model.h:346</a></div></div>
<div class="ttc" id="a_inf_stat_8h_html_ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd"><div class="ttname"><a href="_inf_stat_8h.html#ad72234c285de2e11997598044ae01389a6cb0d5d26a8a4981c0e2625e4bc119fd">InfStat_Susceptible</a></div><div class="ttdeci">@ InfStat_Susceptible</div><div class="ttdef"><b>Definition:</b> <a href="_inf_stat_8h_source.html#l00006">InfStat.h:6</a></div></div>
<div class="ttc" id="astruct_place_html_aec007e8790a70d7f9cf9ced53f889c4e"><div class="ttname"><a href="struct_place.html#aec007e8790a70d7f9cf9ced53f889c4e">Place::members</a></div><div class="ttdeci">int * members</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00320">Model.h:320</a></div></div>
<div class="ttc" id="astruct_param_html_a65c7c3800b86d77c2157a6bdde047ab3"><div class="ttname"><a href="struct_param.html#a65c7c3800b86d77c2157a6bdde047ab3">Param::MoveRestrAdminUnitDivisor</a></div><div class="ttdeci">int MoveRestrAdminUnitDivisor</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="astruct_place_html_a7a78485a87e1516d6b86e0f4fae2131a"><div class="ttname"><a href="struct_place.html#a7a78485a87e1516d6b86e0f4fae2131a">Place::loc_x</a></div><div class="ttdeci">float loc_x</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00318">Model.h:318</a></div></div>
<div class="ttc" id="a_update_8h_html"><div class="ttname"><a href="_update_8h.html">Update.h</a></div></div>
<div class="ttc" id="astruct_param_html_a6d52b3c2824d4343244db8583cf47d4a"><div class="ttname"><a href="struct_param.html#a6d52b3c2824d4343244db8583cf47d4a">Param::TreatProphCourseLength</a></div><div class="ttdeci">double TreatProphCourseLength</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00132">Param.h:132</a></div></div>
<div class="ttc" id="astruct_airport_html_ab370f3801948fc7e4f69598c5639761a"><div class="ttname"><a href="struct_airport.html#ab370f3801948fc7e4f69598c5639761a">Airport::Inv_DestPlaces</a></div><div class="ttdeci">int Inv_DestPlaces[1025]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00251">Model.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_a1c9861fda43d5b84c2a2d2570806b7ff"><div class="ttname"><a href="struct_param.html#a1c9861fda43d5b84c2a2d2570806b7ff">Param::KeyWorkerProphRenewalDuration</a></div><div class="ttdeci">double KeyWorkerProphRenewalDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00223">Param.h:223</a></div></div>
<div class="ttc" id="astruct_microcell_html_a7e5edb04511aaf97388e606e2c12eb89"><div class="ttname"><a href="struct_microcell.html#a7e5edb04511aaf97388e606e2c12eb89">Microcell::keyworkerproph</a></div><div class="ttdeci">unsigned short int keyworkerproph</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="a_update_8cpp_html_ad856954ddc4f853a5689b47fb9c4d0ae"><div class="ttname"><a href="_update_8cpp.html#ad856954ddc4f853a5689b47fb9c4d0ae">DoFalseCase</a></div><div class="ttdeci">void DoFalseCase(int ai, double t, unsigned short int ts, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00880">Update.cpp:880</a></div></div>
<div class="ttc" id="a_model_macros_8h_html_ae66746e1f11d41f53bed6d04cddeac6f"><div class="ttname"><a href="_model_macros_8h.html#ae66746e1f11d41f53bed6d04cddeac6f">HOST_TREATED</a></div><div class="ttdeci">#define HOST_TREATED(x)</div><div class="ttdef"><b>Definition:</b> <a href="_model_macros_8h_source.html#l00007">ModelMacros.h:6</a></div></div>
<div class="ttc" id="a_calc_inf_susc_8cpp_html_ae4d700a29a73d804c5cb8cb3721eaad8"><div class="ttname"><a href="_calc_inf_susc_8cpp.html#ae4d700a29a73d804c5cb8cb3721eaad8">CalcHouseInf</a></div><div class="ttdeci">double CalcHouseInf(int j, unsigned short int ts)</div><div class="ttdef"><b>Definition:</b> <a href="_calc_inf_susc_8cpp_source.html#l00012">CalcInfSusc.cpp:12</a></div></div>
<div class="ttc" id="a_update_8cpp_html_af35e7b4931a854fecd1ac807d7b6d289"><div class="ttname"><a href="_update_8cpp.html#af35e7b4931a854fecd1ac807d7b6d289">DoCritical</a></div><div class="ttdeci">void DoCritical(int ai, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00283">Update.cpp:283</a></div></div>
<div class="ttc" id="astruct_person_html_a47c4cd3b065fbc5b140a216587b2e358"><div class="ttname"><a href="struct_person.html#a47c4cd3b065fbc5b140a216587b2e358">Person::dct_end_time</a></div><div class="ttdeci">unsigned short int dct_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00051">Model.h:51</a></div></div>
<div class="ttc" id="astruct_place_html_a90795f850fc6824ce4d6c7fee6d6d15d"><div class="ttname"><a href="struct_place.html#a90795f850fc6824ce4d6c7fee6d6d15d">Place::group_start</a></div><div class="ttdeci">int * group_start</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00320">Model.h:320</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_acf339fc9cfee006b65c7bbac4edc9525"><div class="ttname"><a href="_covid_sim_8cpp.html#acf339fc9cfee006b65c7bbac4edc9525">CellLookup</a></div><div class="ttdeci">Cell ** CellLookup</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00072">CovidSim.cpp:72</a></div></div>
<div class="ttc" id="astruct_household_html_a5b984c04b3e1f1b19f101a097ace1b43"><div class="ttname"><a href="struct_household.html#a5b984c04b3e1f1b19f101a097ace1b43">Household::loc_y</a></div><div class="ttdeci">float loc_y</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00060">Model.h:60</a></div></div>
<div class="ttc" id="astruct_param_html_a2a45360afbfb6e8e7a417e23a9332856"><div class="ttname"><a href="struct_param.html#a2a45360afbfb6e8e7a417e23a9332856">Param::PlaceCloseTimeStart</a></div><div class="ttdeci">double PlaceCloseTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00125">Param.h:125</a></div></div>
<div class="ttc" id="astruct_param_html_ad081e0f7470191292399781c2327e420"><div class="ttname"><a href="struct_param.html#ad081e0f7470191292399781c2327e420">Param::ScalingFactorSpatialDigitalContacts</a></div><div class="ttdeci">double ScalingFactorSpatialDigitalContacts</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00251">Param.h:251</a></div></div>
<div class="ttc" id="astruct_param_html_a915602640091b4b417a2b17edff6b654"><div class="ttname"><a href="struct_param.html#a915602640091b4b417a2b17edff6b654">Param::DoSeasonality</a></div><div class="ttdeci">int DoSeasonality</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00041">Param.h:41</a></div></div>
<div class="ttc" id="a_country_8h_html_a5d3313b56154604f08b68fdc748047d0"><div class="ttname"><a href="_country_8h.html#a5d3313b56154604f08b68fdc748047d0">NUM_PLACE_TYPES</a></div><div class="ttdeci">const int NUM_PLACE_TYPES</div><div class="ttdef"><b>Definition:</b> <a href="_country_8h_source.html#l00011">Country.h:11</a></div></div>
<div class="ttc" id="a_covid_sim_8cpp_html_af6cb3392363bc05dc3ab0e3515466ba9"><div class="ttname"><a href="_covid_sim_8cpp.html#af6cb3392363bc05dc3ab0e3515466ba9">McellLookup</a></div><div class="ttdeci">Microcell ** McellLookup</div><div class="ttdef"><b>Definition:</b> <a href="_covid_sim_8cpp_source.html#l00073">CovidSim.cpp:73</a></div></div>
<div class="ttc" id="astruct_param_html_a616ffcb2dabdce9d11cb5d8db07cd3f6"><div class="ttname"><a href="struct_param.html#a616ffcb2dabdce9d11cb5d8db07cd3f6">Param::TreatMaxCourses</a></div><div class="ttdeci">double TreatMaxCourses</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00136">Param.h:136</a></div></div>
<div class="ttc" id="astruct_pop_var_html_af10f510f31a2dc02e4d0a3153c72b5f8"><div class="ttname"><a href="struct_pop_var.html#af10f510f31a2dc02e4d0a3153c72b5f8">PopVar::n_mvacc</a></div><div class="ttdeci">int n_mvacc</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00112">Model.h:112</a></div></div>
<div class="ttc" id="astruct_param_html_a7206e6fc21efe4ed871863e212de77f8"><div class="ttname"><a href="struct_param.html#a7206e6fc21efe4ed871863e212de77f8">Param::NumHolidays</a></div><div class="ttdeci">int NumHolidays</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00128">Param.h:128</a></div></div>
<div class="ttc" id="astruct_infection_html_a9282c3919ca496bf4198ffccf2c75c7e"><div class="ttname"><a href="struct_infection.html#a9282c3919ca496bf4198ffccf2c75c7e">Infection::infector</a></div><div class="ttdeci">int infector</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00073">Model.h:73</a></div></div>
<div class="ttc" id="astruct_param_html_aa2a41d48cd984636fbdd53fa5605eb17"><div class="ttname"><a href="struct_param.html#aa2a41d48cd984636fbdd53fa5605eb17">Param::DoMassVacc</a></div><div class="ttdeci">int DoMassVacc</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00240">Param.h:240</a></div></div>
<div class="ttc" id="astruct_microcell_html_ab4be01087bf63f18858bf31fb7818197"><div class="ttname"><a href="struct_microcell.html#ab4be01087bf63f18858bf31fb7818197">Microcell::vacc_start_time</a></div><div class="ttdeci">unsigned short int vacc_start_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00281">Model.h:281</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a248346723693921070cac74d119f579e"><div class="ttname"><a href="struct_pop_var.html#a248346723693921070cac74d119f579e">PopVar::pg_queue</a></div><div class="ttdeci">int * pg_queue[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00111">Model.h:111</a></div></div>
<div class="ttc" id="astruct_microcell_html_a406a99c4386e01acb83cb6d354f7d6b0"><div class="ttname"><a href="struct_microcell.html#a406a99c4386e01acb83cb6d354f7d6b0">Microcell::placeclose</a></div><div class="ttdeci">unsigned short int placeclose</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a5d121b65abf83c4a8b5cac67d44cf985"><div class="ttname"><a href="struct_pop_var.html#a5d121b65abf83c4a8b5cac67d44cf985">PopVar::cumUT</a></div><div class="ttdeci">double cumUT</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00114">Model.h:114</a></div></div>
<div class="ttc" id="astruct_param_html_a72e8023b6171653589ae83c26d7af1aa"><div class="ttname"><a href="struct_param.html#a72e8023b6171653589ae83c26d7af1aa">Param::PlaceTypeNum</a></div><div class="ttdeci">int PlaceTypeNum</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00052">Param.h:52</a></div></div>
<div class="ttc" id="astruct_param_html_ab6b102e46dd3c644eb6394805f6edfc9"><div class="ttname"><a href="struct_param.html#ab6b102e46dd3c644eb6394805f6edfc9">Param::DoMoveRestrOnceOnly</a></div><div class="ttdeci">int DoMoveRestrOnceOnly</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00236">Param.h:236</a></div></div>
<div class="ttc" id="astruct_person_html_a163b932f9bcb7abe3d15e0961ea22bbe"><div class="ttname"><a href="struct_person.html#a163b932f9bcb7abe3d15e0961ea22bbe">Person::infector</a></div><div class="ttdeci">int infector</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00020">Model.h:20</a></div></div>
<div class="ttc" id="astruct_airport_html_a8e9e7e916faec5f0ef1911f86c58e3bf"><div class="ttname"><a href="struct_airport.html#a8e9e7e916faec5f0ef1911f86c58e3bf">Airport::Inv_DestMcells</a></div><div class="ttdeci">int Inv_DestMcells[1025]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00251">Model.h:251</a></div></div>
<div class="ttc" id="a_update_8cpp_html_ad4dc1d4a2ae4624f05d51bde13883b7e"><div class="ttname"><a href="_update_8cpp.html#ad4dc1d4a2ae4624f05d51bde13883b7e">DoRecover_FromSeverity</a></div><div class="ttdeci">void DoRecover_FromSeverity(int ai, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00381">Update.cpp:381</a></div></div>
<div class="ttc" id="astruct_person_html_a8348a80bfb53fa5e6c1c9ce47dbfecba"><div class="ttname"><a href="struct_person.html#a8348a80bfb53fa5e6c1c9ce47dbfecba">Person::PlaceGroupLinks</a></div><div class="ttdeci">unsigned short int PlaceGroupLinks[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00037">Model.h:37</a></div></div>
<div class="ttc" id="astruct_param_html_aacb32b0865c35da2adedfcdb0a34896f"><div class="ttname"><a href="struct_param.html#aacb32b0865c35da2adedfcdb0a34896f">Param::InvJourneyDurationDistrib</a></div><div class="ttdeci">int InvJourneyDurationDistrib[1025]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00109">Param.h:109</a></div></div>
<div class="ttc" id="astruct_cell_html_ab0a07dbeae2fe63c8d2ab90ed7ea6f2f"><div class="ttname"><a href="struct_cell.html#ab0a07dbeae2fe63c8d2ab90ed7ea6f2f">Cell::infected</a></div><div class="ttdeci">int * infected</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00295">Model.h:295</a></div></div>
<div class="ttc" id="astruct_pop_var_html_a2c88e1d856818fb831d400b3eeee2051"><div class="ttname"><a href="struct_pop_var.html#a2c88e1d856818fb831d400b3eeee2051">PopVar::trigDC_adunit</a></div><div class="ttdeci">int trigDC_adunit[MAX_ADUNITS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00106">Model.h:106</a></div></div>
<div class="ttc" id="astruct_param_html_a898a04b71d6f28fb6de536342b4503fa"><div class="ttname"><a href="struct_param.html#a898a04b71d6f28fb6de536342b4503fa">Param::VaccAdminUnitDivisor</a></div><div class="ttdeci">int VaccAdminUnitDivisor</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00238">Param.h:238</a></div></div>
<div class="ttc" id="astruct_person_html_ade12e47418f02d7771af87ca18245013"><div class="ttname"><a href="struct_person.html#ade12e47418f02d7771af87ca18245013">Person::to_die</a></div><div class="ttdeci">unsigned int to_die</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00028">Model.h:28</a></div></div>
<div class="ttc" id="astruct_param_html_a70cec34085663abc126c69456b1322b6"><div class="ttname"><a href="struct_param.html#a70cec34085663abc126c69456b1322b6">Param::TreatPlaceTotalProp</a></div><div class="ttdeci">double TreatPlaceTotalProp[NUM_PLACE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00135">Param.h:135</a></div></div>
<div class="ttc" id="astruct_param_html_a4adadc68277be8199c537f298dca2855"><div class="ttname"><a href="struct_param.html#a4adadc68277be8199c537f298dca2855">Param::TreatCellIncThresh</a></div><div class="ttdeci">double TreatCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00132">Param.h:132</a></div></div>
<div class="ttc" id="a_rand_8cpp_html_a9d6753048d256a545575a035578a85bf"><div class="ttname"><a href="_rand_8cpp.html#a9d6753048d256a545575a035578a85bf">ranf_mt</a></div><div class="ttdeci">double ranf_mt(int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_rand_8cpp_source.html#l00044">Rand.cpp:44</a></div></div>
<div class="ttc" id="a_error_8h_html_ad74df05c36c5f7e949c2c75b19712260"><div class="ttname"><a href="_error_8h.html#ad74df05c36c5f7e949c2c75b19712260">ERR_CRITICAL</a></div><div class="ttdeci">#define ERR_CRITICAL(msg)</div><div class="ttdef"><b>Definition:</b> <a href="_error_8h_source.html#l00005">Error.h:4</a></div></div>
<div class="ttc" id="a_param_8h_html"><div class="ttname"><a href="_param_8h.html">Param.h</a></div></div>
<div class="ttc" id="astruct_param_html_a0ddebf08542f128fec0f9a196e1bac7a"><div class="ttname"><a href="struct_param.html#a0ddebf08542f128fec0f9a196e1bac7a">Param::TreatPlaceGeogDuration</a></div><div class="ttdeci">double TreatPlaceGeogDuration</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00131">Param.h:131</a></div></div>
<div class="ttc" id="astruct_cell_html_a6f9f7d71211d8b16bb166158bd98ba42"><div class="ttname"><a href="struct_cell.html#a6f9f7d71211d8b16bb166158bd98ba42">Cell::cum_trans</a></div><div class="ttdeci">float * cum_trans</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00297">Model.h:297</a></div></div>
<div class="ttc" id="astruct_param_html_aaec2514a789cbc9b2cc9a38232b0a7dc"><div class="ttname"><a href="struct_param.html#aaec2514a789cbc9b2cc9a38232b0a7dc">Param::nch</a></div><div class="ttdeci">int nch</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00041">Param.h:41</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_a461f3a48ec546a649b02b46dfb63ce1e"><div class="ttname"><a href="_sweep_8cpp.html#a461f3a48ec546a649b02b46dfb63ce1e">TravelReturnSweep</a></div><div class="ttdeci">void TravelReturnSweep(double t)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l00019">Sweep.cpp:19</a></div></div>
<div class="ttc" id="astruct_param_html_a8864023fe5b3773ad0f1abbb73b08e11"><div class="ttname"><a href="struct_param.html#a8864023fe5b3773ad0f1abbb73b08e11">Param::DoDigitalContactTracing</a></div><div class="ttdeci">int DoDigitalContactTracing</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00250">Param.h:250</a></div></div>
<div class="ttc" id="astruct_param_html_abc7f99ff6ed26242dc71033f62060106"><div class="ttname"><a href="struct_param.html#abc7f99ff6ed26242dc71033f62060106">Param::DoPerCapitaTriggers</a></div><div class="ttdeci">int DoPerCapitaTriggers</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00230">Param.h:230</a></div></div>
<div class="ttc" id="a_rand_8cpp_html_a27488915fe3fa82c70d9166c321fd510"><div class="ttname"><a href="_rand_8cpp.html#a27488915fe3fa82c70d9166c321fd510">SamplingQueue</a></div><div class="ttdeci">int ** SamplingQueue</div><div class="ttdef"><b>Definition:</b> <a href="_rand_8cpp_source.html#l00014">Rand.cpp:14</a></div></div>
<div class="ttc" id="astruct_param_html_ab434bcdf1f0c57c9b412084b57644069"><div class="ttname"><a href="struct_param.html#ab434bcdf1f0c57c9b412084b57644069">Param::InfQueuePeakLength</a></div><div class="ttdeci">int InfQueuePeakLength</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00045">Param.h:45</a></div></div>
<div class="ttc" id="a_kernels_8h_html"><div class="ttname"><a href="_kernels_8h.html">Kernels.h</a></div></div>
<div class="ttc" id="astruct_param_html_ac5bfacdf8312c5f59646b1cbfea2bac7"><div class="ttname"><a href="struct_param.html#ac5bfacdf8312c5f59646b1cbfea2bac7">Param::DoBlanketMoveRestr</a></div><div class="ttdeci">int DoBlanketMoveRestr</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00240">Param.h:240</a></div></div>
<div class="ttc" id="astruct_param_html_ad6277e8ebe91728f87d68e5f44e61e8c"><div class="ttname"><a href="struct_param.html#ad6277e8ebe91728f87d68e5f44e61e8c">Param::DoDCTTest</a></div><div class="ttdeci">int DoDCTTest</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00250">Param.h:250</a></div></div>
<div class="ttc" id="astruct_param_html_afb5f0e640d85f6eb0b4d58fd43bafdd6"><div class="ttname"><a href="struct_param.html#afb5f0e640d85f6eb0b4d58fd43bafdd6">Param::nmch</a></div><div class="ttdeci">int nmch</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00041">Param.h:41</a></div></div>
<div class="ttc" id="astruct_param_html_a0200e35d690636cf5257fc906d9c39c8"><div class="ttname"><a href="struct_param.html#a0200e35d690636cf5257fc906d9c39c8">Param::NMCP</a></div><div class="ttdeci">int NMCP</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00041">Param.h:41</a></div></div>
<div class="ttc" id="astruct_param_html_a3dfd381deb20db5aff1d77dc93b7cd77"><div class="ttname"><a href="struct_param.html#a3dfd381deb20db5aff1d77dc93b7cd77">Param::DoHouseholds</a></div><div class="ttdeci">int DoHouseholds</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00052">Param.h:52</a></div></div>
<div class="ttc" id="astruct_param_html_a8de0393ac46908ec0634ace1e7827d13"><div class="ttname"><a href="struct_param.html#a8de0393ac46908ec0634ace1e7827d13">Param::MeanLocalJourneyTime</a></div><div class="ttdeci">double MeanLocalJourneyTime</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00108">Param.h:108</a></div></div>
<div class="ttc" id="astruct_microcell_html_a26b35b71eaf97771dac9a8cdfdbf0817"><div class="ttname"><a href="struct_microcell.html#a26b35b71eaf97771dac9a8cdfdbf0817">Microcell::move_end_time</a></div><div class="ttdeci">unsigned short int move_end_time</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00277">Model.h:277</a></div></div>
<div class="ttc" id="astruct_param_html_a8cda67618bb03002e125eabf624b1a5e"><div class="ttname"><a href="struct_param.html#a8cda67618bb03002e125eabf624b1a5e">Param::TreatPropRadial</a></div><div class="ttdeci">double TreatPropRadial</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00132">Param.h:132</a></div></div>
<div class="ttc" id="a_constants_8h_html_a3c41b481bdf730b73815be288d5cd5a4"><div class="ttname"><a href="_constants_8h.html#a3c41b481bdf730b73815be288d5cd5a4">MAX_CONTACTS</a></div><div class="ttdeci">const int MAX_CONTACTS</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8h_source.html#l00085">Constants.h:85</a></div></div>
<div class="ttc" id="astruct_place_html_a66141d3948f8fffd6388415e6345729d"><div class="ttname"><a href="struct_place.html#a66141d3948f8fffd6388415e6345729d">Place::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00313">Model.h:313</a></div></div>
<div class="ttc" id="astruct_place_html_a0535d382cc253cff695004e9f845b4d0"><div class="ttname"><a href="struct_place.html#a0535d382cc253cff695004e9f845b4d0">Place::treat</a></div><div class="ttdeci">unsigned short int treat</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00314">Model.h:314</a></div></div>
<div class="ttc" id="astruct_infection_html_a35fb8d6e90b844483aabea6108228ec2"><div class="ttname"><a href="struct_infection.html#a35fb8d6e90b844483aabea6108228ec2">Infection::infectee</a></div><div class="ttdeci">int infectee</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00074">Model.h:74</a></div></div>
<div class="ttc" id="a_sweep_8cpp_html_a8c3ab55d74e7e4b328c3120b87ba4177"><div class="ttname"><a href="_sweep_8cpp.html#a8c3ab55d74e7e4b328c3120b87ba4177">TreatSweep</a></div><div class="ttdeci">int TreatSweep(double t)</div><div class="ttdef"><b>Definition:</b> <a href="_sweep_8cpp_source.html#l01165">Sweep.cpp:1165</a></div></div>
<div class="ttc" id="astruct_pop_var_html_acb9bdb9d9007e065f05ec30ce17b61ad"><div class="ttname"><a href="struct_pop_var.html#acb9bdb9d9007e065f05ec30ce17b61ad">PopVar::n_queue</a></div><div class="ttdeci">int n_queue[MAX_NUM_THREADS]</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00110">Model.h:110</a></div></div>
<div class="ttc" id="astruct_airport_html_a8b6418011a9243e1302fa862cc235ef7"><div class="ttname"><a href="struct_airport.html#a8b6418011a9243e1302fa862cc235ef7">Airport::total_traffic</a></div><div class="ttdeci">float total_traffic</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00253">Model.h:253</a></div></div>
<div class="ttc" id="astruct_param_html_a92ecd5c72609159927a0b10eeb8a74d1"><div class="ttname"><a href="struct_param.html#a92ecd5c72609159927a0b10eeb8a74d1">Param::SocDistTimeStart</a></div><div class="ttdeci">double SocDistTimeStart</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00153">Param.h:153</a></div></div>
<div class="ttc" id="astruct_param_html_a0772caf9f4f684a708f14c4e51cb223f"><div class="ttname"><a href="struct_param.html#a0772caf9f4f684a708f14c4e51cb223f">Param::HolidayStartTime</a></div><div class="ttdeci">double HolidayStartTime[DAYS_PER_YEAR]</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00129">Param.h:129</a></div></div>
<div class="ttc" id="astruct_param_html_a1e8fcf32cb32172940ea1afa8cba985f"><div class="ttname"><a href="struct_param.html#a1e8fcf32cb32172940ea1afa8cba985f">Param::VaccCellIncThresh</a></div><div class="ttdeci">double VaccCellIncThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00139">Param.h:139</a></div></div>
<div class="ttc" id="astruct_microcell_html_ac84967895e49bccc3cf8f5719875a23e"><div class="ttname"><a href="struct_microcell.html#ac84967895e49bccc3cf8f5719875a23e">Microcell::socdist_trig</a></div><div class="ttdeci">unsigned short int socdist_trig</div><div class="ttdef"><b>Definition:</b> <a href="_model_8h_source.html#l00276">Model.h:276</a></div></div>
<div class="ttc" id="astruct_param_html_ad37fb2a6cb27ee21219221ae265829f0"><div class="ttname"><a href="struct_param.html#ad37fb2a6cb27ee21219221ae265829f0">Param::NumThreads</a></div><div class="ttdeci">int NumThreads</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00045">Param.h:45</a></div></div>
<div class="ttc" id="a_sweep_8h_html"><div class="ttname"><a href="_sweep_8h.html">Sweep.h</a></div></div>
<div class="ttc" id="astruct_param_html_a0dc378d5f0fb7c14fa0d59ebadbe4bf8"><div class="ttname"><a href="struct_param.html#a0dc378d5f0fb7c14fa0d59ebadbe4bf8">Param::PlaceCloseAdunitPropThresh</a></div><div class="ttdeci">double PlaceCloseAdunitPropThresh</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00127">Param.h:127</a></div></div>
<div class="ttc" id="astruct_param_html_a67a7cc9c21b8e5069d14a161ec3d7130"><div class="ttname"><a href="struct_param.html#a67a7cc9c21b8e5069d14a161ec3d7130">Param::VaccDelayMean</a></div><div class="ttdeci">double VaccDelayMean</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00137">Param.h:137</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a4555d52d0bbb474123aefba2e498fab3"><div class="ttname"><a href="_update_8cpp.html#a4555d52d0bbb474123aefba2e498fab3">DoCase</a></div><div class="ttdeci">void DoCase(int ai, double t, unsigned short int ts, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00792">Update.cpp:792</a></div></div>
<div class="ttc" id="a_update_8cpp_html_a398043938a21921a383d5fa4062605e3"><div class="ttname"><a href="_update_8cpp.html#a398043938a21921a383d5fa4062605e3">DoDetectedCase</a></div><div class="ttdeci">void DoDetectedCase(int ai, double t, unsigned short int ts, int tn)</div><div class="ttdef"><b>Definition:</b> <a href="_update_8cpp_source.html#l00534">Update.cpp:534</a></div></div>
<div class="ttc" id="astruct_param_html_a05a087ba170bfe490c8eaf7b996d527c"><div class="ttname"><a href="struct_param.html#a05a087ba170bfe490c8eaf7b996d527c">Param::TreatDeathDrop</a></div><div class="ttdeci">double TreatDeathDrop</div><div class="ttdef"><b>Definition:</b> <a href="_param_8h_source.html#l00131">Param.h:131</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
